{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport CanvasJSObject from './canvasjs';\nimport Animator from './animator';\nimport DataSeries from './data_series';\nimport TextBlock from './text_block';\nimport RenderHelper from '../helpers/render';\nimport LayoutManager from './layout_manager';\nimport EventManager from './event_manager';\nimport ToolTip from './tooltip';\nimport CultureInfo from '../core/culture_info';\nimport Axis from '../core/axis';\nimport Title from '../core/title';\nimport Legend from '../core/legend';\nimport AnimationHelper from '../helpers/animator';\nimport { colorSets } from '../constants/themes';\nimport { isDebugMode, defaultOptions } from '../constants/options';\n// import {inherits} from 'util';\n\nimport { addEvent, setCanvasSize, addArrayIndexOf, hide, show, getMouseCoordinates, getProperty, isCanvasSupported, extend, createCanvas, extendCtx, getObjectId, getDevicePixelBackingStoreRatio, trimString, numberFormat, getLineDashArray, intToHexColorString, compareDataPointX } from '../helpers/utils';\nimport { SplineChart, ColumnChart, StackedColumnChart, StackedColumn100Chart, BarChart, StackedBarChart, StackedBar100Chart, AreaChart, SplineAreaChart, StepAreaChart, StackedAreaChart, StackedArea100Chart, BubbleChart, ScatterChart, CandlestickChart, RangeColumnChart, RangeBarChart, RangeAreaChart, RangeSplineAreaChart, PieChart } from '../charts/index';\nvar devicePixelBackingStoreRatio = getDevicePixelBackingStoreRatio();\nfunction Chart(containerId, options, publicChartReference) {\n  this._publicChartReference = publicChartReference;\n  options = options || {};\n  Chart.base.constructor.call(this, \"Chart\", options, options.theme ? options.theme : \"theme1\");\n  var _this = this;\n  this._containerId = containerId;\n  this._objectsInitialized = false;\n  this.ctx = null;\n  this.overlaidCanvasCtx = null;\n  this._indexLabels = [];\n  this._panTimerId = 0;\n  this._lastTouchEventType = \"\";\n  this._lastTouchData = null;\n  this.isAnimating = false;\n  this.renderCount = 0;\n  this.animatedRender = false;\n  this.disableToolTip = false;\n  this.panEnabled = false;\n  this._defaultCursor = \"default\";\n  this.plotArea = {\n    canvas: null,\n    ctx: null,\n    x1: 0,\n    y1: 0,\n    x2: 0,\n    y2: 0,\n    width: 0,\n    height: 0\n  };\n  this._dataInRenderedOrder = [];\n  this._container = typeof this._containerId === \"string\" ? document.getElementById(this._containerId) : this._containerId;\n  if (!this._container) {\n    if (window.console) window.console.log(\"CanvasJS Error: Chart Container with id \\\"\" + this._containerId + \"\\\" was not found\");\n    return;\n  }\n  this._container.innerHTML = \"\";\n  var width = 0;\n  var height = 0;\n  if (this._options.width) width = this.width;else width = this._container.clientWidth > 0 ? this._container.clientWidth : this.width;\n  if (this._options.height) height = this.height;else height = this._container.clientHeight > 0 ? this._container.clientHeight : this.height;\n  this.width = width;\n  this.height = height;\n  this.x1 = this.y1 = 0;\n  this.x2 = this.width;\n  this.y2 = this.height;\n  this._selectedColorSet = typeof colorSets[this.colorSet] !== \"undefined\" ? colorSets[this.colorSet] : colorSets[\"colorSet1\"];\n  this._canvasJSContainer = document.createElement(\"div\");\n  this._canvasJSContainer.setAttribute(\"class\", \"canvasjs-chart-container\");\n  this._canvasJSContainer.style.position = \"relative\";\n  this._canvasJSContainer.style.textAlign = \"left\";\n  this._canvasJSContainer.style.cursor = \"auto\";\n  if (!isCanvasSupported) {\n    this._canvasJSContainer.style.height = \"0px\"; //In IE6 toolTip doesn't show at proper position if not set.\n  }\n  this._container.appendChild(this._canvasJSContainer);\n  this.canvas = createCanvas(width, height);\n  this.canvas.style.position = \"absolute\";\n  if (this.canvas.getContext) {\n    //try {\n    //\tthis.canvas.style.background = this.backgroundColor;\n    //} catch (e) { }\n    this._canvasJSContainer.appendChild(this.canvas);\n    this.ctx = this.canvas.getContext(\"2d\");\n    this.ctx.textBaseline = \"top\";\n    extendCtx(this.ctx);\n  } else return;\n\n  //this.canvas.style.cursor = \"pointer\";\n\n  if (!isCanvasSupported) {\n    this.plotArea.canvas = createCanvas(width, height);\n    this.plotArea.canvas.style.position = \"absolute\";\n    this.plotArea.canvas.setAttribute(\"class\", \"plotAreaCanvas\");\n    this._canvasJSContainer.appendChild(this.plotArea.canvas);\n    this.plotArea.ctx = this.plotArea.canvas.getContext(\"2d\");\n  } else {\n    this.plotArea.ctx = this.ctx;\n  }\n  this.overlaidCanvas = createCanvas(width, height);\n  this.overlaidCanvas.style.position = \"absolute\";\n  this._canvasJSContainer.appendChild(this.overlaidCanvas);\n  this.overlaidCanvasCtx = this.overlaidCanvas.getContext(\"2d\");\n  this.overlaidCanvasCtx.textBaseline = \"top\";\n  this._eventManager = new EventManager(this);\n  addEvent(window, \"resize\", function () {\n    //this._container.addEventListener(\"DOMSubtreeModified\", function () {\n\n    if (_this._updateSize()) _this.render();\n  });\n  this._toolBar = document.createElement(\"div\");\n  this._toolBar.setAttribute(\"class\", \"canvasjs-chart-toolbar\");\n  this._toolBar.style.cssText = \"position: absolute; right: 1px; top: 1px;\";\n  this._canvasJSContainer.appendChild(this._toolBar);\n  this.bounds = {\n    x1: 0,\n    y1: 0,\n    x2: this.width,\n    y2: this.height\n  };\n  addEvent(this.overlaidCanvas, 'click', function (e) {\n    _this._mouseEventHandler(e);\n  });\n  addEvent(this.overlaidCanvas, 'mousemove', function (e) {\n    _this._mouseEventHandler(e);\n  });\n  addEvent(this.overlaidCanvas, 'mouseup', function (e) {\n    _this._mouseEventHandler(e);\n  });\n  addEvent(this.overlaidCanvas, 'mousedown', function (e) {\n    _this._mouseEventHandler(e);\n    hide(_this._dropdownMenu);\n  });\n  addEvent(this.overlaidCanvas, 'mouseout', function (e) {\n    _this._mouseEventHandler(e);\n  });\n  addEvent(this.overlaidCanvas, window.navigator.msPointerEnabled ? \"MSPointerDown\" : \"touchstart\", function (e) {\n    _this._touchEventHandler(e);\n  });\n  addEvent(this.overlaidCanvas, window.navigator.msPointerEnabled ? \"MSPointerMove\" : 'touchmove', function (e) {\n    _this._touchEventHandler(e);\n  });\n  addEvent(this.overlaidCanvas, window.navigator.msPointerEnabled ? \"MSPointerUp\" : 'touchend', function (e) {\n    _this._touchEventHandler(e);\n  });\n  addEvent(this.overlaidCanvas, window.navigator.msPointerEnabled ? \"MSPointerCancel\" : 'touchcancel', function (e) {\n    _this._touchEventHandler(e);\n  });\n  if (!this._creditLink) {\n    this._creditLink = document.createElement(\"a\");\n    this._creditLink.setAttribute(\"class\", \"canvasjs-chart-credit\");\n    this._creditLink.setAttribute(\"style\", \"outline:none;margin:0px;position:absolute;right:3px;top:\" + (this.height - 14) + \"px;color:dimgrey;text-decoration:none;font-size:10px;font-family:Lucida Grande, Lucida Sans Unicode, Arial, sans-serif\");\n    this._creditLink.setAttribute(\"tabIndex\", -1);\n    this._creditLink.setAttribute(\"target\", \"_blank\");\n  }\n  this._toolTip = new ToolTip(this, this._options.toolTip, this.theme);\n  this.data = null;\n  this.axisX = null;\n  this.axisY = null;\n  this.axisY2 = null;\n  this.sessionVariables = {\n    axisX: {},\n    axisY: {},\n    axisY2: {}\n  };\n}\nextend(Chart, CanvasJSObject);\n\n//Update Chart Properties\nChart.prototype._updateOptions = function () {\n  var _this = this;\n  this.updateOption(\"width\");\n  this.updateOption(\"height\");\n  this.updateOption(\"dataPointMaxWidth\");\n  this.updateOption(\"interactivityEnabled\");\n  this.updateOption(\"theme\");\n  if (this.updateOption(\"colorSet\")) this._selectedColorSet = typeof colorSets[this.colorSet] !== \"undefined\" ? colorSets[this.colorSet] : colorSets[\"colorSet1\"];\n  this.updateOption(\"backgroundColor\");\n  if (!this.backgroundColor) this.backgroundColor = \"rgba(0,0,0,0)\";\n  this.updateOption(\"culture\");\n  this._cultureInfo = new CultureInfo(this._options.culture);\n  this.updateOption(\"animationEnabled\");\n  this.animationEnabled = this.animationEnabled && isCanvasSupported;\n  this.updateOption(\"animationDuration\");\n  this.updateOption(\"rangeChanging\");\n  this.updateOption(\"rangeChanged\");\n\n  //Need to check this._options.zoomEnabled because this.zoomEnabled is used internally to keep track of state - and hence changes.\n  if (this._options.zoomEnabled) {\n    if (!this._zoomButton) {\n      hide(this._zoomButton = document.createElement(\"button\"));\n      setButtonState(this, this._zoomButton, \"pan\");\n      this._toolBar.appendChild(this._zoomButton);\n      addEvent(this._zoomButton, \"click\", function () {\n        if (_this.zoomEnabled) {\n          _this.zoomEnabled = false;\n          _this.panEnabled = true;\n          setButtonState(_this, _this._zoomButton, \"zoom\");\n        } else {\n          _this.zoomEnabled = true;\n          _this.panEnabled = false;\n          setButtonState(_this, _this._zoomButton, \"pan\");\n        }\n        _this.render();\n      });\n    }\n    if (!this._resetButton) {\n      hide(this._resetButton = document.createElement(\"button\"));\n      setButtonState(this, this._resetButton, \"reset\");\n      this._toolBar.appendChild(this._resetButton);\n      addEvent(this._resetButton, \"click\", function () {\n        _this._toolTip.hide();\n        if (_this.zoomEnabled || _this.panEnabled) {\n          _this.zoomEnabled = true;\n          _this.panEnabled = false;\n          setButtonState(_this, _this._zoomButton, \"pan\");\n          _this._defaultCursor = \"default\";\n          _this.overlaidCanvas.style.cursor = _this._defaultCursor;\n        } else {\n          _this.zoomEnabled = false;\n          _this.panEnabled = false;\n        }\n        //Reset axisX\n        if (_this.sessionVariables.axisX) {\n          _this.sessionVariables.axisX.newViewportMinimum = null;\n          _this.sessionVariables.axisX.newViewportMaximum = null;\n        }\n\n        //Reset axisY\n        if (_this.sessionVariables.axisY) {\n          _this.sessionVariables.axisY.newViewportMinimum = null;\n          _this.sessionVariables.axisY.newViewportMaximum = null;\n        }\n\n        //Reset axisY2\n        if (_this.sessionVariables.axisY2) {\n          _this.sessionVariables.axisY2.newViewportMinimum = null;\n          _this.sessionVariables.axisY2.newViewportMaximum = null;\n        }\n        _this.resetOverlayedCanvas();\n        hide(_this._zoomButton, _this._resetButton);\n        _this._dispatchRangeEvent(\"rangeChanging\", \"reset\");\n        _this.render();\n        _this._dispatchRangeEvent(\"rangeChanged\", \"reset\");\n      });\n      this.overlaidCanvas.style.cursor = _this._defaultCursor;\n    }\n    if (!this.zoomEnabled && !this.panEnabled) {\n      if (!this._zoomButton) {\n        this.zoomEnabled = true;\n        this.panEnabled = false;\n      } else {\n        if (_this._zoomButton.getAttribute(\"state\") === _this._cultureInfo.zoomText) {\n          this.panEnabled = true;\n          this.zoomEnabled = false;\n        } else {\n          this.zoomEnabled = true;\n          this.panEnabled = false;\n        }\n        show(_this._zoomButton, _this._resetButton);\n      }\n    }\n  } else {\n    this.zoomEnabled = false;\n    this.panEnabled = false;\n  }\n  if (this._menuButton) {\n    if (this.exportEnabled) show(this._menuButton);else hide(this._menuButton);\n  } else if (this.exportEnabled && isCanvasSupported) {\n    this._menuButton = document.createElement(\"button\");\n    setButtonState(this, this._menuButton, \"menu\");\n    this._toolBar.appendChild(this._menuButton);\n    addEvent(this._menuButton, \"click\", function () {\n      if (_this._dropdownMenu.style.display === \"none\") {\n        if (_this._dropDownCloseTime && new Date().getTime() - _this._dropDownCloseTime.getTime() <= 500) return;\n        _this._dropdownMenu.style.display = \"block\";\n        _this._menuButton.blur();\n        _this._dropdownMenu.focus();\n      }\n    }, true);\n  }\n  if (!this._dropdownMenu && this.exportEnabled && isCanvasSupported) {\n    this._dropdownMenu = document.createElement(\"div\");\n    this._dropdownMenu.setAttribute(\"tabindex\", -1);\n    this._dropdownMenu.style.cssText = \"position: absolute; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; cursor: pointer;right: 1px;top: 25px;min-width: 120px;outline: 0;border: 1px solid silver;font-size: 14px;font-family: Calibri, Verdana, sans-serif;padding: 5px 0px 5px 0px;text-align: left;background-color: #fff;line-height: 20px;box-shadow: 2px 2px 10px #888888;\";\n    _this._dropdownMenu.style.display = \"none\";\n    this._toolBar.appendChild(this._dropdownMenu);\n    addEvent(this._dropdownMenu, \"blur\", function () {\n      hide(_this._dropdownMenu);\n      _this._dropDownCloseTime = new Date();\n    }, true);\n    var exportOption = document.createElement(\"div\");\n    exportOption.style.cssText = \"padding: 2px 15px 2px 10px\";\n    exportOption.innerHTML = this._cultureInfo.saveJPGText;\n    this._dropdownMenu.appendChild(exportOption);\n    addEvent(exportOption, \"mouseover\", function () {\n      this.style.backgroundColor = \"#EEEEEE\";\n    }, true);\n    addEvent(exportOption, \"mouseout\", function () {\n      this.style.backgroundColor = \"transparent\";\n    }, true);\n    addEvent(exportOption, \"click\", function () {\n      exportCanvas(_this.canvas, \"jpg\", _this.exportFileName);\n      hide(_this._dropdownMenu);\n    }, true);\n    var exportOption = document.createElement(\"div\");\n    exportOption.style.cssText = \"padding: 2px 15px 2px 10px\";\n    exportOption.innerHTML = this._cultureInfo.savePNGText;\n    this._dropdownMenu.appendChild(exportOption);\n    addEvent(exportOption, \"mouseover\", function () {\n      this.style.backgroundColor = \"#EEEEEE\";\n    }, true);\n    addEvent(exportOption, \"mouseout\", function () {\n      this.style.backgroundColor = \"transparent\";\n    }, true);\n    addEvent(exportOption, \"click\", function () {\n      exportCanvas(_this.canvas, \"png\", _this.exportFileName);\n      hide(_this._dropdownMenu);\n    }, true);\n  }\n  if (this._toolBar.style.display !== \"none\" && this._zoomButton) {\n    this.panEnabled ? setButtonState(_this, _this._zoomButton, \"zoom\") : setButtonState(_this, _this._zoomButton, \"pan\");\n    if (_this._resetButton.getAttribute(\"state\") !== _this._cultureInfo.resetText) setButtonState(_this, _this._resetButton, \"reset\");\n  }\n  if (typeof defaultOptions.Chart.creditHref === \"undefined\") {\n    this.creditHref = \"http://canvasjs.com/\";\n    this.creditText = \"CanvasJS.com\";\n  } else {\n    var creditTextChanged = this.updateOption(\"creditText\");\n    var creditHrefChanged = this.updateOption(\"creditHref\");\n  }\n  if (this.renderCount === 0 || creditTextChanged || creditHrefChanged) {\n    this._creditLink.setAttribute(\"href\", this.creditHref);\n    this._creditLink.innerHTML = this.creditText;\n  }\n  if (this.creditHref && this.creditText) {\n    if (!this._creditLink.parentElement) this._canvasJSContainer.appendChild(this._creditLink);\n  } else if (this._creditLink.parentElement) this._canvasJSContainer.removeChild(this._creditLink);\n  if (this._options.toolTip && this._toolTip._options !== this._options.toolTip) this._toolTip._options = this._options.toolTip;\n  for (var prop in this._toolTip._options) {\n    if (this._toolTip._options.hasOwnProperty(prop)) {\n      this._toolTip.updateOption(prop);\n    }\n  }\n};\nChart.prototype._updateSize = function () {\n  var width = 0;\n  var height = 0;\n  if (this._options.width) width = this.width;else this.width = width = this._container.clientWidth > 0 ? this._container.clientWidth : this.width;\n  if (this._options.height) height = this.height;else this.height = height = this._container.clientHeight > 0 ? this._container.clientHeight : this.height;\n  if (this.canvas.width !== width * devicePixelBackingStoreRatio || this.canvas.height !== height * devicePixelBackingStoreRatio) {\n    setCanvasSize(this.canvas, width, height);\n    setCanvasSize(this.overlaidCanvas, width, height);\n    setCanvasSize(this._eventManager.ghostCanvas, width, height);\n    return true;\n  }\n  return false;\n};\n\n// initialize chart objects\nChart.prototype._initialize = function () {\n  ///<signature>\n  ///<summary>Initializes Chart objects/state. Creates DataSeries class instance for each DataSeries provided by ther user. Sets the Axis Type based on the user data</summary>\n  ///</signature>\n  //this.width = this.width;\n\n  if (!this._animator) this._animator = new Animator(this);else {\n    this._animator.cancelAllAnimations();\n  }\n  this.removeAllEventListeners();\n  this.disableToolTip = false;\n  this._axes = [];\n  this.pieDoughnutClickHandler = null;\n  //this._touchCurrentCoordinates = null;\n\n  if (this.animationRequestId) this.cancelRequestAnimFrame.call(window, this.animationRequestId);\n  this._updateOptions();\n  this.animatedRender = isCanvasSupported && this.animationEnabled && this.renderCount === 0;\n  this._updateSize();\n\n  //this._selectedColorSet = colorSets[\"colorSet2\"];\n\n  //this.ctx.clearRect(0, 0, this.width, this.height);\n  this.clearCanvas();\n  this.ctx.beginPath();\n  this.axisX = null;\n  this.axisY = null;\n  this.axisY2 = null;\n  this._indexLabels = [];\n  this._dataInRenderedOrder = [];\n  this._events = [];\n  if (this._eventManager) this._eventManager.reset();\n  this.plotInfo = {\n    axisPlacement: null,\n    axisXValueType: null,\n    plotTypes: [] //array of plotType: {type:\"\", axisYType: \"primary\", dataSeriesIndexes:[]}\n  };\n  this.layoutManager = new LayoutManager(0, 0, this.width, this.height, 2);\n  if (this.plotArea.layoutManager) this.plotArea.layoutManager.reset();\n  this.data = [];\n  var dataSeriesIndex = 0;\n  for (var series = 0; series < this._options.data.length; series++) {\n    //for (series in this._options.data) {\n\n    dataSeriesIndex++;\n    if (!(!this._options.data[series].type || Chart._supportedChartTypes.indexOf(this._options.data[series].type) >= 0)) continue;\n    var dataSeries = new DataSeries(this, this._options.data[series], this.theme, dataSeriesIndex - 1, ++this._eventManager.lastObjectId);\n    if (dataSeries.name === null) dataSeries.name = \"DataSeries \" + dataSeriesIndex;\n    if (dataSeries.color === null) {\n      if (this._options.data.length > 1) {\n        dataSeries._colorSet = [this._selectedColorSet[dataSeries.index % this._selectedColorSet.length]];\n        dataSeries.color = this._selectedColorSet[dataSeries.index % this._selectedColorSet.length];\n      } else {\n        if (dataSeries.type === \"line\" || dataSeries.type === \"stepLine\" || dataSeries.type === \"spline\" || dataSeries.type === \"area\" || dataSeries.type === \"stepArea\" || dataSeries.type === \"splineArea\" || dataSeries.type === \"stackedArea\" || dataSeries.type === \"stackedArea100\" || dataSeries.type === \"rangeArea\" || dataSeries.type === \"rangeSplineArea\" || dataSeries.type === \"candlestick\" || dataSeries.type === \"ohlc\") {\n          dataSeries._colorSet = [this._selectedColorSet[0]];\n        } else dataSeries._colorSet = this._selectedColorSet;\n      }\n    } else {\n      dataSeries._colorSet = [dataSeries.color];\n    }\n    if (dataSeries.markerSize === null) {\n      if ((dataSeries.type === \"line\" || dataSeries.type === \"stepLine\" || dataSeries.type === \"spline\") && dataSeries.dataPoints && dataSeries.dataPoints.length < this.width / 16 || dataSeries.type === \"scatter\") {\n        //if (dataSeries.type === \"line\") {\n        dataSeries.markerSize = 8;\n      }\n    }\n    if ((dataSeries.type === \"bubble\" || dataSeries.type === \"scatter\") && dataSeries.dataPoints) {\n      dataSeries.dataPoints.sort(compareDataPointX);\n    }\n\n    //if (dataSeries.markerBorderThickness === null && dataSeries.type === \"scatter\") {\n    //    dataSeries.markerBorderThickness = 2;\n    //}\n\n    //if (dataSeries.markerType === null) {\n    //    if (dataSeries.type === \"line\" & dataSeries.dataPoints.length < 500) {\n    //        dataSeries.markerType = \"circle\";\n    //    }\n    //}\n\n    this.data.push(dataSeries);\n    var seriesAxisPlacement = dataSeries.axisPlacement;\n\n    //if (isDebugMode && window.console)\n    //    window.console.log(dataSeries.type);\n\n    var errorMessage;\n    if (seriesAxisPlacement === \"normal\") {\n      if (this.plotInfo.axisPlacement === \"xySwapped\") {\n        errorMessage = \"You cannot combine \\\"\" + dataSeries.type + \"\\\" with bar chart\";\n      } else if (this.plotInfo.axisPlacement === \"none\") {\n        errorMessage = \"You cannot combine \\\"\" + dataSeries.type + \"\\\" with pie chart\";\n      } else if (this.plotInfo.axisPlacement === null) this.plotInfo.axisPlacement = \"normal\";\n    } else if (seriesAxisPlacement === \"xySwapped\") {\n      if (this.plotInfo.axisPlacement === \"normal\") {\n        errorMessage = \"You cannot combine \\\"\" + dataSeries.type + \"\\\" with line, area, column or pie chart\";\n      } else if (this.plotInfo.axisPlacement === \"none\") {\n        errorMessage = \"You cannot combine \\\"\" + dataSeries.type + \"\\\" with pie chart\";\n      } else if (this.plotInfo.axisPlacement === null) this.plotInfo.axisPlacement = \"xySwapped\";\n    } else if (seriesAxisPlacement == \"none\") {\n      if (this.plotInfo.axisPlacement === \"normal\") {\n        errorMessage = \"You cannot combine \\\"\" + dataSeries.type + \"\\\" with line, area, column or bar chart\";\n      } else if (this.plotInfo.axisPlacement === \"xySwapped\") {\n        errorMessage = \"You cannot combine \\\"\" + dataSeries.type + \"\\\" with bar chart\";\n      } else if (this.plotInfo.axisPlacement === null) this.plotInfo.axisPlacement = \"none\";\n    }\n    if (errorMessage && window.console) {\n      window.console.log(errorMessage);\n      return;\n    }\n  }\n\n  //if (isDebugMode && window.console) {\n  //    window.console.log(\"xMin: \" + this.plotInfo.viewPortXMin + \"; xMax: \" + this.plotInfo.viewPortXMax + \"; yMin: \" + this.plotInfo.yMin + \"; yMax: \" + this.plotInfo.yMax);\n  //}\n\n  this._objectsInitialized = true;\n};\n\n//indexOf is not supported in IE8-\nChart._supportedChartTypes = addArrayIndexOf([\"line\", \"stepLine\", \"spline\", \"column\", \"area\", \"stepArea\", \"splineArea\", \"bar\", \"bubble\", \"scatter\", \"stackedColumn\", \"stackedColumn100\", \"stackedBar\", \"stackedBar100\", \"stackedArea\", \"stackedArea100\", \"candlestick\", \"ohlc\", \"rangeColumn\", \"rangeBar\", \"rangeArea\", \"rangeSplineArea\", \"pie\", \"doughnut\", \"funnel\"]);\nChart.prototype.render = function (options) {\n  if (options) this._options = options;\n  this._initialize();\n  var plotAreaElements = []; //Elements to be rendered inside the plotArea\n\n  //Create Primary and Secondary axis and assign them to the series\n  for (var i = 0; i < this.data.length; i++) {\n    if (this.plotInfo.axisPlacement === \"normal\" || this.plotInfo.axisPlacement === \"xySwapped\") {\n      if (!this.data[i].axisYType || this.data[i].axisYType === \"primary\") {\n        if (!this.axisY) {\n          if (this.plotInfo.axisPlacement === \"normal\") {\n            this._axes.push(this.axisY = new Axis(this, this._options.axisY, \"axisY\", \"left\"));\n          } else if (this.plotInfo.axisPlacement === \"xySwapped\") {\n            this._axes.push(this.axisY = new Axis(this, this._options.axisY, \"axisY\", \"bottom\"));\n          }\n        }\n        this.data[i].axisY = this.axisY;\n      } else if (this.data[i].axisYType === \"secondary\") {\n        if (!this.axisY2) {\n          if (this.plotInfo.axisPlacement === \"normal\") {\n            this._axes.push(this.axisY2 = new Axis(this, this._options.axisY2, \"axisY\", \"right\"));\n          } else if (this.plotInfo.axisPlacement === \"xySwapped\") {\n            this._axes.push(this.axisY2 = new Axis(this, this._options.axisY2, \"axisY\", \"top\"));\n          }\n        }\n        this.data[i].axisY = this.axisY2;\n      }\n      if (!this.axisX) {\n        if (this.plotInfo.axisPlacement === \"normal\") {\n          this._axes.push(this.axisX = new Axis(this, this._options.axisX, \"axisX\", \"bottom\"));\n        } else if (this.plotInfo.axisPlacement === \"xySwapped\") {\n          this._axes.push(this.axisX = new Axis(this, this._options.axisX, \"axisX\", \"left\"));\n        }\n      }\n      this.data[i].axisX = this.axisX;\n    }\n  }\n\n  //If Both Primary and Secondary axis are present, disable gridlines for one of them unless the user has set value for both\n  if (this.axisY && this.axisY2) {\n    if (this.axisY.gridThickness > 0 && typeof this.axisY2._options.gridThickness === \"undefined\") this.axisY2.gridThickness = 0;else if (this.axisY2.gridThickness > 0 && typeof this.axisY._options.gridThickness === \"undefined\") this.axisY.gridThickness = 0;\n  }\n\n  //Show toolBar when viewportMinimum/viewportMaximum are set\n  var showToolBar = false;\n  if (this._axes.length > 0 && (this.zoomEnabled || this.panEnabled)) {\n    for (var i = 0; i < this._axes.length; i++) {\n      if (this._axes[i].viewportMinimum !== null || this._axes[i].viewportMaximum !== null) {\n        showToolBar = true;\n        break;\n      }\n    }\n  }\n  if (showToolBar) {\n    show(this._zoomButton, this._resetButton);\n  } else {\n    hide(this._zoomButton, this._resetButton);\n  }\n  this._processData(); // Categorises the dataSeries and calculates min, max and other values\n\n  if (this._options.title) {\n    this._title = new Title(this, this._options.title);\n    if (!this._title.dockInsidePlotArea) this._title.render();else plotAreaElements.push(this._title);\n  }\n  if (this._options.subtitles) {\n    for (var i = 0; i < this._options.subtitles.length; i++) {\n      this.subtitles = [];\n      var subtitle = new Subtitle(this, this._options.subtitles[i]);\n      this.subtitles.push(subtitle);\n      if (!subtitle.dockInsidePlotArea) subtitle.render();else plotAreaElements.push(subtitle);\n    }\n  }\n  this.legend = new Legend(this, this._options.legend, this.theme);\n  for (var i = 0; i < this.data.length; i++) {\n    if (this.data[i].showInLegend || this.data[i].type === \"pie\" || this.data[i].type === \"doughnut\") {\n      this.legend.dataSeries.push(this.data[i]);\n    }\n  }\n  if (!this.legend.dockInsidePlotArea) this.legend.render();else plotAreaElements.push(this.legend);\n\n  //TBI: Revisit and check if the functionality is enough.\n  if (this.plotInfo.axisPlacement === \"normal\" || this.plotInfo.axisPlacement === \"xySwapped\") {\n    //var freeSpace = this.layoutManager.getFreeSpace();\n\n    Axis.setLayoutAndRender(this.axisX, this.axisY, this.axisY2, this.plotInfo.axisPlacement, this.layoutManager.getFreeSpace());\n  } else if (this.plotInfo.axisPlacement === \"none\") {\n    //In case of charts with axis this method is called inside setLayoutAndRender\n    this.preparePlotArea();\n  } else {\n    return;\n  }\n  var index = 0;\n  for (index in plotAreaElements) {\n    if (plotAreaElements.hasOwnProperty(index)) plotAreaElements[index].render();\n  }\n  var animations = [];\n  if (this.animatedRender) {\n    var initialState = createCanvas(this.width, this.height);\n    var initialStateCtx = initialState.getContext(\"2d\");\n    initialStateCtx.drawImage(this.canvas, 0, 0, this.width, this.height);\n  }\n  for (var i = 0; i < this.plotInfo.plotTypes.length; i++) {\n    var plotType = this.plotInfo.plotTypes[i];\n    for (var j = 0; j < plotType.plotUnits.length; j++) {\n      var plotUnit = plotType.plotUnits[j];\n      var animationInfo = null;\n      plotUnit.targetCanvas = null; //In case chart updates before the animation is complete, previous canvases need to be removed\n\n      if (this.animatedRender) {\n        plotUnit.targetCanvas = createCanvas(this.width, this.height);\n        plotUnit.targetCanvasCtx = plotUnit.targetCanvas.getContext(\"2d\");\n      }\n      if (plotUnit.type === \"line\") animationInfo = this.renderLine(plotUnit);else if (plotUnit.type === \"stepLine\") animationInfo = this.renderStepLine(plotUnit);else if (plotUnit.type === \"spline\") animationInfo = this.renderSpline(plotUnit);else if (plotUnit.type === \"column\") animationInfo = this.renderColumn(plotUnit);else if (plotUnit.type === \"bar\") animationInfo = this.renderBar(plotUnit);else if (plotUnit.type === \"area\") animationInfo = this.renderArea(plotUnit);else if (plotUnit.type === \"stepArea\") animationInfo = this.renderStepArea(plotUnit);else if (plotUnit.type === \"splineArea\") animationInfo = this.renderSplineArea(plotUnit);else if (plotUnit.type === \"stackedColumn\") animationInfo = this.renderStackedColumn(plotUnit);else if (plotUnit.type === \"stackedColumn100\") animationInfo = this.renderStackedColumn100(plotUnit);else if (plotUnit.type === \"stackedBar\") animationInfo = this.renderStackedBar(plotUnit);else if (plotUnit.type === \"stackedBar100\") animationInfo = this.renderStackedBar100(plotUnit);else if (plotUnit.type === \"stackedArea\") animationInfo = this.renderStackedArea(plotUnit);else if (plotUnit.type === \"stackedArea100\") animationInfo = this.renderStackedArea100(plotUnit);else if (plotUnit.type === \"bubble\") animationInfo = animationInfo = this.renderBubble(plotUnit);else if (plotUnit.type === \"scatter\") animationInfo = this.renderScatter(plotUnit);else if (plotUnit.type === \"pie\") this.renderPie(plotUnit);else if (plotUnit.type === \"doughnut\") this.renderPie(plotUnit);else if (plotUnit.type === \"candlestick\") animationInfo = this.renderCandlestick(plotUnit);else if (plotUnit.type === \"ohlc\") animationInfo = this.renderCandlestick(plotUnit);else if (plotUnit.type === \"rangeColumn\") animationInfo = this.renderRangeColumn(plotUnit);else if (plotUnit.type === \"rangeBar\") animationInfo = this.renderRangeBar(plotUnit);else if (plotUnit.type === \"rangeArea\") animationInfo = this.renderRangeArea(plotUnit);else if (plotUnit.type === \"rangeSplineArea\") animationInfo = this.renderRangeSplineArea(plotUnit);\n      for (var k = 0; k < plotUnit.dataSeriesIndexes.length; k++) {\n        this._dataInRenderedOrder.push(this.data[plotUnit.dataSeriesIndexes[k]]);\n      }\n      if (this.animatedRender && animationInfo) animations.push(animationInfo);\n    }\n  }\n  if (this.animatedRender && this._indexLabels.length > 0) {\n    var indexLabelCanvas = createCanvas(this.width, this.height);\n    var indexLabelCanvasCtx = indexLabelCanvas.getContext(\"2d\");\n    animations.push(this.renderIndexLabels(indexLabelCanvasCtx));\n  }\n  var _this = this;\n  if (animations.length > 0) {\n    //var animationCount = 0;\n    _this.disableToolTip = true;\n    _this._animator.animate(200, _this.animationDuration, function (fractionComplete) {\n      //console.log(fractionComplete);\n      //animationCount++;\n\n      _this.ctx.clearRect(0, 0, _this.width, _this.height);\n\n      //  _this.ctx.drawImage(initialState, 0, 0, _this.width * devicePixelBackingStoreRatio, _this.height * devicePixelBackingStoreRatio, 0, 0, _this.width, _this.height);\n      _this.ctx.drawImage(initialState, 0, 0, Math.floor(_this.width * devicePixelBackingStoreRatio), Math.floor(_this.height * devicePixelBackingStoreRatio), 0, 0, _this.width, _this.height);\n      for (var l = 0; l < animations.length; l++) {\n        animationInfo = animations[l];\n        if (fractionComplete < 1 && typeof animationInfo.startTimePercent !== \"undefined\") {\n          if (fractionComplete >= animationInfo.startTimePercent) {\n            //animationInfo.animationCallback(AnimationHelper.easing.linear(fractionComplete - animationInfo.startTimePercent, 0, 1, 1 - animationInfo.startTimePercent), animationInfo);\n\n            animationInfo.animationCallback(animationInfo.easingFunction(fractionComplete - animationInfo.startTimePercent, 0, 1, 1 - animationInfo.startTimePercent), animationInfo);\n          }\n        } else {\n          animationInfo.animationCallback(animationInfo.easingFunction(fractionComplete, 0, 1, 1), animationInfo);\n        }\n      }\n      _this.dispatchEvent(\"dataAnimationIterationEnd\", {\n        chart: _this\n      });\n    }, function () {\n      animations = [];\n      var count = 0;\n\n      //Delete all render target canvases used for animation.\n      for (var i = 0; i < _this.plotInfo.plotTypes.length; i++) {\n        var plotType = _this.plotInfo.plotTypes[i];\n        for (var j = 0; j < plotType.plotUnits.length; j++) {\n          var plotUnit = plotType.plotUnits[j];\n          plotUnit.targetCanvas = null;\n        }\n      }\n      initialState = null;\n      _this.disableToolTip = false;\n      //console.log(\"*********** Animation Complete - \" + animationCount + \" ***********\");\n    });\n  } else {\n    if (_this._indexLabels.length > 0) _this.renderIndexLabels();\n    _this.dispatchEvent(\"dataAnimationIterationEnd\", {\n      chart: _this\n    });\n  }\n  this.attachPlotAreaEventHandlers();\n  if (!this.zoomEnabled && !this.panEnabled && this._zoomButton && this._zoomButton.style.display !== \"none\") {\n    hide(this._zoomButton, this._resetButton);\n  }\n  this._toolTip._updateToolTip();\n  this.renderCount++;\n\n  //if (window.console) {\n  //    window.console.log(new Date().getTime() - dt);\n  //}\n\n  if (isDebugMode) {\n    var _this = this;\n    setTimeout(function () {\n      var ghostCanvasCopy = document.getElementById(\"ghostCanvasCopy\");\n      if (ghostCanvasCopy) {\n        //console.log(ghostCanvasCopy.clientWidth);\n        setCanvasSize(ghostCanvasCopy, _this.width, _this.height);\n        var ghostCanvasCopyCtx = ghostCanvasCopy.getContext(\"2d\");\n\n        //ghostCanvasCopyCtx.scale(1, 1);\n        //var imageData = this._eventManager.ghostCtx.getImageData(0, 0, this._container.clientWidth, this._container.clientHeight);\n        //this._eventManager.ghostCtx.drawImage(this._eventManager.ghostCanvas, 0, 0);\n        //this.ctx.drawImage(this._eventManager.ghostCanvas, 0, 0);\n\n        ghostCanvasCopyCtx.drawImage(_this._eventManager.ghostCanvas, 0, 0);\n        //_this._canvasJSContainer.appendChild(_this._eventManager.ghostCanvas);\n        //_this.overlaidCanvasCtx.drawImage(_this._eventManager.ghostCanvas, 0, 0);\n      }\n    }, 2000);\n  }\n};\nChart.prototype.attachPlotAreaEventHandlers = function () {\n  //this._toolBar.style.display = \"inline\";\n\n  this.attachEvent({\n    context: this,\n    chart: this,\n    mousedown: this._plotAreaMouseDown,\n    mouseup: this._plotAreaMouseUp,\n    mousemove: this._plotAreaMouseMove,\n    cursor: this.zoomEnabled ? \"col-resize\" : \"move\",\n    cursor: this.panEnabled ? \"move\" : \"default\",\n    capture: true,\n    bounds: this.plotArea\n  });\n};\nChart.prototype.categoriseDataSeries = function () {\n  var dataSeries = \"\";\n  for (var i = 0; i < this.data.length; i++) {\n    dataSeries = this.data[i];\n    if (!dataSeries.dataPoints || dataSeries.dataPoints.length === 0 || !dataSeries.visible) continue;\n    if (Chart._supportedChartTypes.indexOf(dataSeries.type) >= 0) {\n      var plotType = null;\n      var plotTypeExists = false;\n      var plotUnit = null;\n      var plotUnitExists = false;\n      for (var j = 0; j < this.plotInfo.plotTypes.length; j++) {\n        if (this.plotInfo.plotTypes[j].type === dataSeries.type) {\n          plotTypeExists = true;\n          var plotType = this.plotInfo.plotTypes[j];\n          break;\n        }\n      }\n      if (!plotTypeExists) {\n        plotType = {\n          type: dataSeries.type,\n          totalDataSeries: 0,\n          plotUnits: []\n        };\n        this.plotInfo.plotTypes.push(plotType);\n      }\n      for (var j = 0; j < plotType.plotUnits.length; j++) {\n        if (plotType.plotUnits[j].axisYType === dataSeries.axisYType) {\n          plotUnitExists = true;\n          var plotUnit = plotType.plotUnits[j];\n          break;\n        }\n      }\n      if (!plotUnitExists) {\n        plotUnit = {\n          type: dataSeries.type,\n          previousDataSeriesCount: 0,\n          //to be set next\n          index: plotType.plotUnits.length,\n          plotType: plotType,\n          axisYType: dataSeries.axisYType,\n          axisY: dataSeries.axisYType === \"primary\" ? this.axisY : this.axisY2,\n          axisX: this.axisX,\n          dataSeriesIndexes: [],\n          //index of dataSeries\n          yTotals: []\n        };\n        plotType.plotUnits.push(plotUnit);\n      }\n      plotType.totalDataSeries++;\n      plotUnit.dataSeriesIndexes.push(i);\n      dataSeries.plotUnit = plotUnit;\n    }\n  }\n  for (var i = 0; i < this.plotInfo.plotTypes.length; i++) {\n    var plotType = this.plotInfo.plotTypes[i];\n    var previousDataSeriesCount = 0;\n    for (var j = 0; j < plotType.plotUnits.length; j++) {\n      plotType.plotUnits[j].previousDataSeriesCount = previousDataSeriesCount;\n      previousDataSeriesCount += plotType.plotUnits[j].dataSeriesIndexes.length;\n    }\n  }\n};\nChart.prototype.assignIdToDataPoints = function () {\n  for (var i = 0; i < this.data.length; i++) {\n    var dataSeries = this.data[i];\n    if (!dataSeries.dataPoints) continue;\n    var length = dataSeries.dataPoints.length;\n    for (var j = 0; j < length; j++) {\n      dataSeries.dataPointIds[j] = ++this._eventManager.lastObjectId;\n    }\n  }\n};\nChart.prototype._processData = function () {\n  this.assignIdToDataPoints();\n  this.categoriseDataSeries();\n  for (var i = 0; i < this.plotInfo.plotTypes.length; i++) {\n    var plotType = this.plotInfo.plotTypes[i];\n    for (var j = 0; j < plotType.plotUnits.length; j++) {\n      var plotUnit = plotType.plotUnits[j];\n      if (plotUnit.type === \"line\" || plotUnit.type === \"stepLine\" || plotUnit.type === \"spline\" || plotUnit.type === \"column\" || plotUnit.type === \"area\" || plotUnit.type === \"stepArea\" || plotUnit.type === \"splineArea\" || plotUnit.type === \"bar\" || plotUnit.type === \"bubble\" || plotUnit.type === \"scatter\") this._processMultiseriesPlotUnit(plotUnit);else if (plotUnit.type === \"stackedColumn\" || plotUnit.type === \"stackedBar\" || plotUnit.type === \"stackedArea\") this._processStackedPlotUnit(plotUnit);else if (plotUnit.type === \"stackedColumn100\" || plotUnit.type === \"stackedBar100\" || plotUnit.type === \"stackedArea100\") this._processStacked100PlotUnit(plotUnit);else if (plotUnit.type === \"candlestick\" || plotUnit.type === \"ohlc\" || plotUnit.type === \"rangeColumn\" || plotUnit.type === \"rangeBar\" || plotUnit.type === \"rangeArea\" || plotUnit.type === \"rangeSplineArea\") this._processMultiYPlotUnit(plotUnit);\n    }\n  }\n};\nChart.prototype._processMultiseriesPlotUnit = function (plotUnit) {\n  if (!plotUnit.dataSeriesIndexes || plotUnit.dataSeriesIndexes.length < 1) return;\n  var axisYDataInfo = plotUnit.axisY.dataInfo;\n  var axisXDataInfo = plotUnit.axisX.dataInfo;\n  var dataPointX, dataPointY;\n  var isDateTime = false;\n  for (var j = 0; j < plotUnit.dataSeriesIndexes.length; j++) {\n    var dataSeries = this.data[plotUnit.dataSeriesIndexes[j]];\n    var i = 0;\n    var isFirstDPInViewPort = false;\n    var isLastDPInViewPort = false;\n    if (dataSeries.axisPlacement === \"normal\" || dataSeries.axisPlacement === \"xySwapped\") {\n      var plotAreaXMin = this.sessionVariables.axisX.newViewportMinimum ? this.sessionVariables.axisX.newViewportMinimum : this._options.axisX && this._options.axisX.viewportMinimum ? this._options.axisX.viewportMinimum : this._options.axisX && this._options.axisX.minimum ? this._options.axisX.minimum : -Infinity;\n      var plotAreaXMax = this.sessionVariables.axisX.newViewportMaximum ? this.sessionVariables.axisX.newViewportMaximum : this._options.axisX && this._options.axisX.viewportMaximum ? this._options.axisX.viewportMaximum : this._options.axisX && this._options.axisX.maximum ? this._options.axisX.maximum : Infinity;\n    }\n    if (dataSeries.dataPoints[i].x && dataSeries.dataPoints[i].x.getTime || dataSeries.xValueType === \"dateTime\") {\n      isDateTime = true;\n    }\n    for (i = 0; i < dataSeries.dataPoints.length; i++) {\n      if (typeof dataSeries.dataPoints[i].x === \"undefined\") {\n        dataSeries.dataPoints[i].x = i;\n      }\n      if (dataSeries.dataPoints[i].x.getTime) {\n        isDateTime = true;\n        dataPointX = dataSeries.dataPoints[i].x.getTime(); //dataPointX is used so that getTime is called only once in case of dateTime values\n      } else dataPointX = dataSeries.dataPoints[i].x;\n      dataPointY = dataSeries.dataPoints[i].y;\n      if (dataPointX < axisXDataInfo.min) axisXDataInfo.min = dataPointX;\n      if (dataPointX > axisXDataInfo.max) axisXDataInfo.max = dataPointX;\n      if (dataPointY < axisYDataInfo.min) axisYDataInfo.min = dataPointY;\n      if (dataPointY > axisYDataInfo.max) axisYDataInfo.max = dataPointY;\n      if (i > 0) {\n        var xDiff = dataPointX - dataSeries.dataPoints[i - 1].x;\n        xDiff < 0 && (xDiff = xDiff * -1); //If Condition shortcut\n\n        if (axisXDataInfo.minDiff > xDiff && xDiff !== 0) {\n          axisXDataInfo.minDiff = xDiff;\n        }\n        if (dataPointY !== null && dataSeries.dataPoints[i - 1].y !== null) {\n          var yDiff = dataPointY - dataSeries.dataPoints[i - 1].y;\n          yDiff < 0 && (yDiff = yDiff * -1); //If Condition shortcut\n\n          if (axisYDataInfo.minDiff > yDiff && yDiff !== 0) {\n            axisYDataInfo.minDiff = yDiff;\n          }\n        }\n      }\n\n      // This section makes sure that partially visible dataPoints are included in the begining\n      if (dataPointX < plotAreaXMin && !isFirstDPInViewPort) {\n        continue;\n      } else if (!isFirstDPInViewPort) {\n        isFirstDPInViewPort = true;\n        if (i > 0) {\n          i -= 2;\n          continue;\n        }\n      }\n\n      // This section makes sure that partially visible dataPoints are included at the end\n      if (dataPointX > plotAreaXMax && !isLastDPInViewPort) {\n        isLastDPInViewPort = true;\n      } else if (dataPointX > plotAreaXMax && isLastDPInViewPort) {\n        continue;\n      }\n      if (dataSeries.dataPoints[i].label) plotUnit.axisX.labels[dataPointX] = dataSeries.dataPoints[i].label;\n      if (dataPointX < axisXDataInfo.viewPortMin) axisXDataInfo.viewPortMin = dataPointX;\n      if (dataPointX > axisXDataInfo.viewPortMax) axisXDataInfo.viewPortMax = dataPointX;\n      if (dataPointY === null) continue;\n      if (dataPointY < axisYDataInfo.viewPortMin) axisYDataInfo.viewPortMin = dataPointY;\n      if (dataPointY > axisYDataInfo.viewPortMax) axisYDataInfo.viewPortMax = dataPointY;\n    }\n    this.plotInfo.axisXValueType = dataSeries.xValueType = isDateTime ? \"dateTime\" : \"number\";\n  }\n\n  //this.dataPoints.sort(compareDataPointX);\n  //this.dataPoints.sort(function (dataPoint1, dataPoint2) { return dataPoint1.x - dataPoint2.x; });\n};\nChart.prototype._processStackedPlotUnit = function (plotUnit) {\n  if (!plotUnit.dataSeriesIndexes || plotUnit.dataSeriesIndexes.length < 1) return;\n  var axisYDataInfo = plotUnit.axisY.dataInfo;\n  var axisXDataInfo = plotUnit.axisX.dataInfo;\n  var dataPointX, dataPointY;\n  var isDateTime = false;\n  var dataPointYPositiveSums = [];\n  var dataPointYNegativeSums = [];\n  for (var j = 0; j < plotUnit.dataSeriesIndexes.length; j++) {\n    var dataSeries = this.data[plotUnit.dataSeriesIndexes[j]];\n    var i = 0;\n    var isFirstDPInViewPort = false;\n    var isLastDPInViewPort = false;\n    if (dataSeries.axisPlacement === \"normal\" || dataSeries.axisPlacement === \"xySwapped\") {\n      var plotAreaXMin = this.sessionVariables.axisX.newViewportMinimum ? this.sessionVariables.axisX.newViewportMinimum : this._options.axisX && this._options.axisX.viewportMinimum ? this._options.axisX.viewportMinimum : this._options.axisX && this._options.axisX.minimum ? this._options.axisX.minimum : -Infinity;\n      var plotAreaXMax = this.sessionVariables.axisX.newViewportMaximum ? this.sessionVariables.axisX.newViewportMaximum : this._options.axisX && this._options.axisX.viewportMaximum ? this._options.axisX.viewportMaximum : this._options.axisX && this._options.axisX.maximum ? this._options.axisX.maximum : Infinity;\n    }\n    if (dataSeries.dataPoints[i].x && dataSeries.dataPoints[i].x.getTime || dataSeries.xValueType === \"dateTime\") {\n      isDateTime = true;\n    }\n    for (i = 0; i < dataSeries.dataPoints.length; i++) {\n      // Requird when no x values are provided\n      if (typeof dataSeries.dataPoints[i].x === \"undefined\") {\n        dataSeries.dataPoints[i].x = i;\n      }\n      if (dataSeries.dataPoints[i].x.getTime) {\n        isDateTime = true;\n        dataPointX = dataSeries.dataPoints[i].x.getTime(); //dataPointX is used so that getTime is called only once in case of dateTime values\n      } else dataPointX = dataSeries.dataPoints[i].x;\n      dataPointY = dataSeries.dataPoints[i].y;\n      if (dataPointX < axisXDataInfo.min) axisXDataInfo.min = dataPointX;\n      if (dataPointX > axisXDataInfo.max) axisXDataInfo.max = dataPointX;\n      if (i > 0) {\n        var xDiff = dataPointX - dataSeries.dataPoints[i - 1].x;\n        xDiff < 0 && (xDiff = xDiff * -1); //If Condition shortcut\n\n        if (axisXDataInfo.minDiff > xDiff && xDiff !== 0) {\n          axisXDataInfo.minDiff = xDiff;\n        }\n        if (dataPointY !== null && dataSeries.dataPoints[i - 1].y !== null) {\n          var yDiff = dataPointY - dataSeries.dataPoints[i - 1].y;\n          yDiff < 0 && (yDiff = yDiff * -1); //If Condition shortcut\n\n          if (axisYDataInfo.minDiff > yDiff && yDiff !== 0) {\n            axisYDataInfo.minDiff = yDiff;\n          }\n        }\n      }\n\n      // This section makes sure that partially visible dataPoints are included in the begining\n      if (dataPointX < plotAreaXMin && !isFirstDPInViewPort) {\n        continue;\n      } else if (!isFirstDPInViewPort) {\n        isFirstDPInViewPort = true;\n        if (i > 0) {\n          i -= 2;\n          continue;\n        }\n      }\n\n      // This section makes sure that partially visible dataPoints are included at the end\n      if (dataPointX > plotAreaXMax && !isLastDPInViewPort) {\n        isLastDPInViewPort = true;\n      } else if (dataPointX > plotAreaXMax && isLastDPInViewPort) {\n        continue;\n      }\n      if (dataSeries.dataPoints[i].label) plotUnit.axisX.labels[dataPointX] = dataSeries.dataPoints[i].label;\n      if (dataPointX < axisXDataInfo.viewPortMin) axisXDataInfo.viewPortMin = dataPointX;\n      if (dataPointX > axisXDataInfo.viewPortMax) axisXDataInfo.viewPortMax = dataPointX;\n      if (dataPointY === null) continue;\n      plotUnit.yTotals[dataPointX] = (!plotUnit.yTotals[dataPointX] ? 0 : plotUnit.yTotals[dataPointX]) + Math.abs(dataPointY);\n      if (dataPointY >= 0) {\n        if (dataPointYPositiveSums[dataPointX]) dataPointYPositiveSums[dataPointX] += dataPointY;else dataPointYPositiveSums[dataPointX] = dataPointY;\n      } else {\n        if (dataPointYNegativeSums[dataPointX]) dataPointYNegativeSums[dataPointX] += dataPointY;else dataPointYNegativeSums[dataPointX] = dataPointY;\n      }\n    }\n    this.plotInfo.axisXValueType = dataSeries.xValueType = isDateTime ? \"dateTime\" : \"number\";\n  }\n  for (i in dataPointYPositiveSums) {\n    if (dataPointYPositiveSums.hasOwnProperty(i)) {\n      if (isNaN(i)) {\n        continue;\n      }\n      var ySum = dataPointYPositiveSums[i];\n      if (ySum < axisYDataInfo.min) axisYDataInfo.min = ySum;\n      if (ySum > axisYDataInfo.max) axisYDataInfo.max = ySum;\n      if (i < axisXDataInfo.viewPortMin || i > axisXDataInfo.viewPortMax) continue;\n      if (ySum < axisYDataInfo.viewPortMin) axisYDataInfo.viewPortMin = ySum;\n      if (ySum > axisYDataInfo.viewPortMax) axisYDataInfo.viewPortMax = ySum;\n    }\n  }\n  for (i in dataPointYNegativeSums) {\n    if (dataPointYNegativeSums.hasOwnProperty(i)) {\n      if (isNaN(i)) {\n        continue;\n      }\n      var ySum = dataPointYNegativeSums[i];\n      if (ySum < axisYDataInfo.min) axisYDataInfo.min = ySum;\n      if (ySum > axisYDataInfo.max) axisYDataInfo.max = ySum;\n      if (i < axisXDataInfo.viewPortMin || i > axisXDataInfo.viewPortMax) continue;\n      if (ySum < axisYDataInfo.viewPortMin) axisYDataInfo.viewPortMin = ySum;\n      if (ySum > axisYDataInfo.viewPortMax) axisYDataInfo.viewPortMax = ySum;\n    }\n  }\n\n  //this.dataPoints.sort(compareDataPointX);\n  //this.dataPoints.sort(function (dataPoint1, dataPoint2) { return dataPoint1.x - dataPoint2.x; });\n\n  //window.console.log(\"viewPortYMin: \" + plotInfo.viewPortYMin + \"; viewPortYMax: \" + plotInfo.viewPortYMax);\n};\nChart.prototype._processStacked100PlotUnit = function (plotUnit) {\n  if (!plotUnit.dataSeriesIndexes || plotUnit.dataSeriesIndexes.length < 1) return;\n  var axisYDataInfo = plotUnit.axisY.dataInfo;\n  var axisXDataInfo = plotUnit.axisX.dataInfo;\n  var dataPointX, dataPointY;\n  var isDateTime = false;\n  var containsPositiveY = false;\n  var containsNegativeY = false;\n  var dataPointYSums = [];\n  for (var j = 0; j < plotUnit.dataSeriesIndexes.length; j++) {\n    var dataSeries = this.data[plotUnit.dataSeriesIndexes[j]];\n    var i = 0;\n    var isFirstDPInViewPort = false;\n    var isLastDPInViewPort = false;\n    if (dataSeries.axisPlacement === \"normal\" || dataSeries.axisPlacement === \"xySwapped\") {\n      var plotAreaXMin = this.sessionVariables.axisX.newViewportMinimum ? this.sessionVariables.axisX.newViewportMinimum : this._options.axisX && this._options.axisX.viewportMinimum ? this._options.axisX.viewportMinimum : this._options.axisX && this._options.axisX.minimum ? this._options.axisX.minimum : -Infinity;\n      var plotAreaXMax = this.sessionVariables.axisX.newViewportMaximum ? this.sessionVariables.axisX.newViewportMaximum : this._options.axisX && this._options.axisX.viewportMaximum ? this._options.axisX.viewportMaximum : this._options.axisX && this._options.axisX.maximum ? this._options.axisX.maximum : Infinity;\n    }\n    if (dataSeries.dataPoints[i].x && dataSeries.dataPoints[i].x.getTime || dataSeries.xValueType === \"dateTime\") {\n      isDateTime = true;\n    }\n    for (i = 0; i < dataSeries.dataPoints.length; i++) {\n      // Requird when no x values are provided\n      if (typeof dataSeries.dataPoints[i].x === \"undefined\") {\n        dataSeries.dataPoints[i].x = i;\n      }\n      if (dataSeries.dataPoints[i].x.getTime) {\n        isDateTime = true;\n        dataPointX = dataSeries.dataPoints[i].x.getTime(); //dataPointX is used so that getTime is called only once in case of dateTime values\n      } else dataPointX = dataSeries.dataPoints[i].x;\n      dataPointY = dataSeries.dataPoints[i].y;\n      if (dataPointX < axisXDataInfo.min) axisXDataInfo.min = dataPointX;\n      if (dataPointX > axisXDataInfo.max) axisXDataInfo.max = dataPointX;\n      if (i > 0) {\n        var xDiff = dataPointX - dataSeries.dataPoints[i - 1].x;\n        xDiff < 0 && (xDiff = xDiff * -1); //If Condition shortcut\n\n        if (axisXDataInfo.minDiff > xDiff && xDiff !== 0) {\n          axisXDataInfo.minDiff = xDiff;\n        }\n        if (dataPointY !== null && dataSeries.dataPoints[i - 1].y !== null) {\n          var yDiff = dataPointY - dataSeries.dataPoints[i - 1].y;\n          yDiff < 0 && (yDiff = yDiff * -1); //If Condition shortcut\n\n          if (axisYDataInfo.minDiff > yDiff && yDiff !== 0) {\n            axisYDataInfo.minDiff = yDiff;\n          }\n        }\n      }\n\n      // This section makes sure that partially visible dataPoints are included in the begining\n      if (dataPointX < plotAreaXMin && !isFirstDPInViewPort) {\n        continue;\n      } else if (!isFirstDPInViewPort) {\n        isFirstDPInViewPort = true;\n        if (i > 0) {\n          i -= 2;\n          continue;\n        }\n      }\n\n      // This section makes sure that partially visible dataPoints are included at the end\n      if (dataPointX > plotAreaXMax && !isLastDPInViewPort) {\n        isLastDPInViewPort = true;\n      } else if (dataPointX > plotAreaXMax && isLastDPInViewPort) {\n        continue;\n      }\n      if (dataSeries.dataPoints[i].label) plotUnit.axisX.labels[dataPointX] = dataSeries.dataPoints[i].label;\n      if (dataPointX < axisXDataInfo.viewPortMin) axisXDataInfo.viewPortMin = dataPointX;\n      if (dataPointX > axisXDataInfo.viewPortMax) axisXDataInfo.viewPortMax = dataPointX;\n      if (dataPointY === null) continue;\n      plotUnit.yTotals[dataPointX] = (!plotUnit.yTotals[dataPointX] ? 0 : plotUnit.yTotals[dataPointX]) + Math.abs(dataPointY);\n      if (dataPointY >= 0) {\n        containsPositiveY = true;\n      } else {\n        containsNegativeY = true;\n      }\n      if (dataPointYSums[dataPointX]) dataPointYSums[dataPointX] += Math.abs(dataPointY);else dataPointYSums[dataPointX] = Math.abs(dataPointY);\n    }\n    this.plotInfo.axisXValueType = dataSeries.xValueType = isDateTime ? \"dateTime\" : \"number\";\n  }\n  if (containsPositiveY && !containsNegativeY) {\n    axisYDataInfo.max = 99;\n    axisYDataInfo.min = 1;\n  } else if (containsPositiveY && containsNegativeY) {\n    axisYDataInfo.max = 99;\n    axisYDataInfo.min = -99;\n  } else if (!containsPositiveY && containsNegativeY) {\n    axisYDataInfo.max = -1;\n    axisYDataInfo.min = -99;\n  }\n  axisYDataInfo.viewPortMin = axisYDataInfo.min;\n  axisYDataInfo.viewPortMax = axisYDataInfo.max;\n  plotUnit.dataPointYSums = dataPointYSums;\n\n  //this.dataPoints.sort(compareDataPointX);\n  //this.dataPoints.sort(function (dataPoint1, dataPoint2) { return dataPoint1.x - dataPoint2.x; });\n\n  //window.console.log(\"viewPortYMin: \" + plotInfo.viewPortYMin + \"; viewPortYMax: \" + plotInfo.viewPortYMax);\n};\nChart.prototype._processMultiYPlotUnit = function (plotUnit) {\n  if (!plotUnit.dataSeriesIndexes || plotUnit.dataSeriesIndexes.length < 1) return;\n  var axisYDataInfo = plotUnit.axisY.dataInfo;\n  var axisXDataInfo = plotUnit.axisX.dataInfo;\n  var dataPointX, dataPointY, dataPointYMin, dataPointYMax;\n  var isDateTime = false;\n  for (var j = 0; j < plotUnit.dataSeriesIndexes.length; j++) {\n    var dataSeries = this.data[plotUnit.dataSeriesIndexes[j]];\n    var i = 0;\n    var isFirstDPInViewPort = false;\n    var isLastDPInViewPort = false;\n    if (dataSeries.axisPlacement === \"normal\" || dataSeries.axisPlacement === \"xySwapped\") {\n      var plotAreaXMin = this.sessionVariables.axisX.newViewportMinimum ? this.sessionVariables.axisX.newViewportMinimum : this._options.axisX && this._options.axisX.viewportMinimum ? this._options.axisX.viewportMinimum : this._options.axisX && this._options.axisX.minimum ? this._options.axisX.minimum : -Infinity;\n      var plotAreaXMax = this.sessionVariables.axisX.newViewportMaximum ? this.sessionVariables.axisX.newViewportMaximum : this._options.axisX && this._options.axisX.viewportMaximum ? this._options.axisX.viewportMaximum : this._options.axisX && this._options.axisX.maximum ? this._options.axisX.maximum : Infinity;\n    }\n    if (dataSeries.dataPoints[i].x && dataSeries.dataPoints[i].x.getTime || dataSeries.xValueType === \"dateTime\") {\n      isDateTime = true;\n    }\n    for (i = 0; i < dataSeries.dataPoints.length; i++) {\n      if (typeof dataSeries.dataPoints[i].x === \"undefined\") {\n        dataSeries.dataPoints[i].x = i;\n      }\n      if (dataSeries.dataPoints[i].x.getTime) {\n        isDateTime = true;\n        dataPointX = dataSeries.dataPoints[i].x.getTime(); //dataPointX is used so that getTime is called only once in case of dateTime values\n      } else dataPointX = dataSeries.dataPoints[i].x;\n      dataPointY = dataSeries.dataPoints[i].y;\n      if (dataPointY && dataPointY.length) {\n        dataPointYMin = Math.min.apply(null, dataPointY);\n        dataPointYMax = Math.max.apply(null, dataPointY);\n      }\n      if (dataPointX < axisXDataInfo.min) axisXDataInfo.min = dataPointX;\n      if (dataPointX > axisXDataInfo.max) axisXDataInfo.max = dataPointX;\n      if (dataPointYMin < axisYDataInfo.min) axisYDataInfo.min = dataPointYMin;\n      if (dataPointYMax > axisYDataInfo.max) axisYDataInfo.max = dataPointYMax;\n      if (i > 0) {\n        var xDiff = dataPointX - dataSeries.dataPoints[i - 1].x;\n        xDiff < 0 && (xDiff = xDiff * -1); //If Condition shortcut\n\n        if (axisXDataInfo.minDiff > xDiff && xDiff !== 0) {\n          axisXDataInfo.minDiff = xDiff;\n        }\n        if (dataPointY[0] !== null && dataSeries.dataPoints[i - 1].y[0] !== null) {\n          var yDiff = dataPointY[0] - dataSeries.dataPoints[i - 1].y[0];\n          yDiff < 0 && (yDiff = yDiff * -1); //If Condition shortcut\n\n          if (axisYDataInfo.minDiff > yDiff && yDiff !== 0) {\n            axisYDataInfo.minDiff = yDiff;\n          }\n        }\n      }\n\n      // This section makes sure that partially visible dataPoints are included in the begining\n      if (dataPointX < plotAreaXMin && !isFirstDPInViewPort) {\n        continue;\n      } else if (!isFirstDPInViewPort) {\n        isFirstDPInViewPort = true;\n        if (i > 0) {\n          i -= 2;\n          continue;\n        }\n      }\n\n      // This section makes sure that partially visible dataPoints are included at the end\n      if (dataPointX > plotAreaXMax && !isLastDPInViewPort) {\n        isLastDPInViewPort = true;\n      } else if (dataPointX > plotAreaXMax && isLastDPInViewPort) {\n        continue;\n      }\n      if (dataSeries.dataPoints[i].label) plotUnit.axisX.labels[dataPointX] = dataSeries.dataPoints[i].label;\n      if (dataPointX < axisXDataInfo.viewPortMin) axisXDataInfo.viewPortMin = dataPointX;\n      if (dataPointX > axisXDataInfo.viewPortMax) axisXDataInfo.viewPortMax = dataPointX;\n      if (dataPointY === null) continue;\n      if (dataPointYMin < axisYDataInfo.viewPortMin) axisYDataInfo.viewPortMin = dataPointYMin;\n      if (dataPointYMax > axisYDataInfo.viewPortMax) axisYDataInfo.viewPortMax = dataPointYMax;\n    }\n    this.plotInfo.axisXValueType = dataSeries.xValueType = isDateTime ? \"dateTime\" : \"number\";\n  }\n\n  //this.dataPoints.sort(compareDataPointX);\n  //this.dataPoints.sort(function (dataPoint1, dataPoint2) { return dataPoint1.x - dataPoint2.x; });\n};\n\n//getClosest returns objects nearby and hence shouldn't be used for events like click, mouseover, mousemove, etc which require object that is exactly under the mouse.\nChart.prototype.getDataPointAtXY = function (mouseX, mouseY, getClosest) {\n  getClosest = getClosest || false;\n  var results = [];\n  for (var i = this._dataInRenderedOrder.length - 1; i >= 0; i--) {\n    var dataSeries = this._dataInRenderedOrder[i];\n    var result = null;\n    result = dataSeries.getDataPointAtXY(mouseX, mouseY, getClosest);\n    if (result) results.push(result);\n  }\n  var closestResult = null;\n  var onlyLineAreaTypes = false;\n  for (var m = 0; m < results.length; m++) {\n    if (results[m].dataSeries.type === \"line\" || results[m].dataSeries.type === \"stepLine\" || results[m].dataSeries.type === \"area\" || results[m].dataSeries.type === \"stepArea\") {\n      var markerSize = getProperty(\"markerSize\", results[m].dataPoint, results[m].dataSeries) || 8;\n      if (results[m].distance <= markerSize / 2) {\n        onlyLineAreaTypes = true;\n        break;\n      }\n    }\n  }\n  for (m = 0; m < results.length; m++) {\n    if (onlyLineAreaTypes && results[m].dataSeries.type !== \"line\" && results[m].dataSeries.type !== \"stepLine\" && results[m].dataSeries.type !== \"area\" && results[m].dataSeries.type !== \"stepArea\") continue;\n    if (!closestResult) {\n      closestResult = results[m];\n    } else if (results[m].distance <= closestResult.distance) {\n      closestResult = results[m];\n    }\n  }\n  return closestResult;\n};\nChart.prototype.getObjectAtXY = function (mouseX, mouseY, getClosest) {\n  getClosest = getClosest || false;\n  var id = null;\n  var dataPointInfo = this.getDataPointAtXY(mouseX, mouseY, getClosest);\n  if (dataPointInfo) {\n    id = dataPointInfo.dataSeries.dataPointIds[dataPointInfo.dataPointIndex];\n  } else if (isCanvasSupported) {\n    //IE9+\n    id = getObjectId(mouseX, mouseY, this._eventManager.ghostCtx);\n  } else {\n    for (var i = 0; i < this.legend.items.length; i++) {\n      var item = this.legend.items[i];\n      if (mouseX >= item.x1 && mouseX <= item.x2 && mouseY >= item.y1 && mouseY <= item.y2) {\n        id = item.id;\n      }\n    }\n  }\n  return id;\n};\n\n/// <summary>Calculates Font Size based on standardSize and Chart Size</summary>\n/// <param name=\"standardSize\" type=\"Number\">Standard font size for a Chart with min(width,height) = 400px</param>\n/// <returns type=\"Number\">The area.</returns>\nChart.prototype.getAutoFontSize = function (standardSize, width, height) {\n  width = width || this.width;\n  height = height || this.height;\n  var fontSizeScaleFactor = standardSize / 400;\n  return Math.round(Math.min(this.width, this.height) * fontSizeScaleFactor);\n};\n\n//#region Events\n\nChart.prototype.resetOverlayedCanvas = function () {\n  //var width = this.overlaidCanvas.width;\n  //this.overlaidCanvas.width = 0;\n  //this.overlaidCanvas.width = width;\n  this.overlaidCanvasCtx.clearRect(0, 0, this.width, this.height);\n};\nChart.prototype.clearCanvas = function () {\n  this.ctx.clearRect(0, 0, this.width, this.height);\n  if (this.backgroundColor) {\n    this.ctx.fillStyle = this.backgroundColor;\n    this.ctx.fillRect(0, 0, this.width, this.height);\n  }\n};\nChart.prototype.attachEvent = function (param) {\n  this._events.push(param);\n};\nChart.prototype._touchEventHandler = function (ev) {\n  if (!ev.changedTouches || !this.interactivityEnabled) return;\n  var mouseEvents = [];\n  var touches = ev.changedTouches;\n  var first = touches ? touches[0] : ev;\n  var touchCurrentCoordinates = null;\n\n  //window.console.log(touches.length);\n\n  switch (ev.type) {\n    case \"touchstart\":\n    case \"MSPointerDown\":\n      mouseEvents = [\"mousemove\", \"mousedown\"];\n      this._lastTouchData = getMouseCoordinates(first);\n      this._lastTouchData.time = new Date();\n      break;\n    case \"touchmove\":\n    case \"MSPointerMove\":\n      mouseEvents = [\"mousemove\"];\n      break;\n    case \"touchend\":\n    case \"MSPointerUp\":\n      mouseEvents = this._lastTouchEventType === \"touchstart\" || this._lastTouchEventType === \"MSPointerDown\" ? [\"mouseup\", \"click\"] : [\"mouseup\"];\n      break;\n    default:\n      return;\n  }\n  if (touches && touches.length > 1) return;\n  touchCurrentCoordinates = getMouseCoordinates(first);\n  touchCurrentCoordinates.time = new Date();\n  try {\n    var dy = touchCurrentCoordinates.y - this._lastTouchData.y;\n    var dx = touchCurrentCoordinates.x - this._lastTouchData.x;\n    var dt = touchCurrentCoordinates.time - this._lastTouchData.time;\n    if (Math.abs(dy) > 15 && (!!this._lastTouchData.scroll || dt < 200)) {\n      //this._lastTouchData.y = touchCurrentCoordinates.y;\n      this._lastTouchData.scroll = true;\n      var win = window.parent || window;\n      if (win && win.scrollBy) win.scrollBy(0, -dy);\n    }\n  } catch (e) {}\n  ;\n  this._lastTouchEventType = ev.type;\n  if (!!this._lastTouchData.scroll && this.zoomEnabled) {\n    if (this.isDrag) this.resetOverlayedCanvas();\n    this.isDrag = false;\n    return;\n  }\n  for (var i = 0; i < mouseEvents.length; i++) {\n    var type = mouseEvents[i];\n    var simulatedEvent = document.createEvent(\"MouseEvent\");\n    simulatedEvent.initMouseEvent(type, true, true, window, 1, first.screenX, first.screenY, first.clientX, first.clientY, false, false, false, false, 0, null);\n    first.target.dispatchEvent(simulatedEvent);\n    if (ev.preventManipulation) {\n      //alert(\"preventManipulation\");\n      ev.preventManipulation();\n    }\n    if (ev.preventDefault) {\n      //alert(\"preventDefault\");\n      ev.preventDefault();\n    }\n  }\n};\nChart.prototype._dispatchRangeEvent = function (eventName, triggerSource) {\n  var eventParameter = {};\n  eventParameter.chart = this._publicChartReference;\n  eventParameter.type = eventName;\n  eventParameter.trigger = triggerSource;\n  var axes = [];\n  if (this.axisX) axes.push(\"axisX\");\n  if (this.axisY) axes.push(\"axisY\");\n  if (this.axisY2) axes.push(\"axisY2\");\n  for (var i = 0; i < axes.length; i++) {\n    eventParameter[axes[i]] = {\n      viewportMinimum: this[axes[i]].sessionVariables.newViewportMinimum,\n      viewportMaximum: this[axes[i]].sessionVariables.newViewportMaximum\n    };\n  }\n  this.dispatchEvent(eventName, eventParameter, this._publicChartReference);\n};\nChart.prototype._mouseEventHandler = function (ev) {\n  if (!this.interactivityEnabled) return;\n  if (this._ignoreNextEvent) {\n    this._ignoreNextEvent = false;\n    return;\n  }\n\n  // stop panning and zooming so we can draw\n  if (ev.preventManipulation) {\n    //alert(\"preventManipulation\");\n    ev.preventManipulation();\n  }\n\n  // we are handling this event\n  if (ev.preventDefault) {\n    //alert(\"preventDefault\");\n    ev.preventDefault();\n  }\n\n  //IE8- uses srcElement instead of target. So instead of checking this condition everytime, its better to create a reference called target.\n  if (typeof ev.target === \"undefined\" && ev.srcElement) ev.target = ev.srcElement;\n\n  //console.log(ev.type);\n\n  var xy = getMouseCoordinates(ev);\n  var type = ev.type;\n  var eventParam;\n  var rightclick;\n  if (!ev) var e = window.event;\n  if (ev.which) rightclick = ev.which == 3;else if (ev.button) rightclick = ev.button == 2;\n\n  //window.console.log(type + \" --> x: \" + xy.x + \"; y:\" + xy.y);\n\n  //if (type === \"mouseout\") {\n  //    this._toolTip.hide();\n  //}\n\n  if (isDebugMode && window.console) {\n    window.console.log(type + \" --> x: \" + xy.x + \"; y:\" + xy.y);\n    if (rightclick) window.console.log(ev.which);\n    if (type === \"mouseup\") window.console.log(\"mouseup\");\n  }\n  if (rightclick) return;\n\n  //if (this.plotInfo.axisPlacement === \"xySwapped\") {\n  //    //var temp = xy.x;\n  //    //xy.x = xy.y;\n  //    //xy.y = temp;\n  //    xy = {x: xy.y, y: xy.x};\n  //}\n\n  if (Chart.capturedEventParam) {\n    eventParam = Chart.capturedEventParam;\n    if (type === \"mouseup\") {\n      Chart.capturedEventParam = null;\n      if (eventParam.chart.overlaidCanvas.releaseCapture) eventParam.chart.overlaidCanvas.releaseCapture();else document.body.removeEventListener(\"mouseup\", eventParam.chart._mouseEventHandler, false);\n    }\n    if (eventParam.hasOwnProperty(type)) eventParam[type].call(eventParam.context, xy.x, xy.y);\n  } else if (this._events) {\n    for (var i = 0; i < this._events.length; i++) {\n      if (!this._events[i].hasOwnProperty(type)) continue;\n      eventParam = this._events[i];\n      var bounds = eventParam.bounds;\n      if (xy.x >= bounds.x1 && xy.x <= bounds.x2 && xy.y >= bounds.y1 && xy.y <= bounds.y2) {\n        eventParam[type].call(eventParam.context, xy.x, xy.y);\n        if (type === \"mousedown\" && eventParam.capture === true) {\n          Chart.capturedEventParam = eventParam;\n          if (this.overlaidCanvas.setCapture) this.overlaidCanvas.setCapture();else {\n            document.body.addEventListener(\"mouseup\", this._mouseEventHandler, false);\n            //addEvent(document.body, \"mouseup\", this._mouseEventHandler);\n          }\n        } else if (type === \"mouseup\") {\n          if (eventParam.chart.overlaidCanvas.releaseCapture) eventParam.chart.overlaidCanvas.releaseCapture();else document.body.removeEventListener(\"mouseup\", this._mouseEventHandler, false);\n        }\n        break;\n      } else eventParam = null;\n    }\n    if (eventParam && eventParam.cursor) {\n      ev.target.style.cursor = eventParam.cursor;\n    } else ev.target.style.cursor = this._defaultCursor;\n\n    //eventParam =\n  }\n  if (this._toolTip && this._toolTip.enabled) {\n    var plotArea = this.plotArea;\n    if (xy.x < plotArea.x1 || xy.x > plotArea.x2 || xy.y < plotArea.y1 || xy.y > plotArea.y2) this._toolTip.hide();\n  }\n  if ((!this.isDrag || !this.zoomEnabled) && this._eventManager) {\n    this._eventManager.mouseEventHandler(ev);\n    //this._updateToolTip(ev.x, ev.y);\n  }\n\n  //if (this._toolTip.enabled)\n  //    this._toolTip.mouseMoveHandler(ev.x, ev.y);\n};\nChart.prototype._plotAreaMouseDown = function (x, y) {\n  this.isDrag = true;\n  if (this.plotInfo.axisPlacement !== \"none\") {\n    this.dragStartPoint = {\n      x: x,\n      y: y\n    };\n  } else {\n    this.dragStartPoint = {\n      x: x,\n      y: y\n    };\n  }\n};\nChart.prototype._plotAreaMouseUp = function (x, y) {\n  if (this.plotInfo.axisPlacement === \"normal\" || this.plotInfo.axisPlacement === \"xySwapped\") {\n    if (this.isDrag) {\n      var dragDelta = 0,\n        dragDeltaPY = y - this.dragStartPoint.y,\n        dragDeltaPX = x - this.dragStartPoint.x,\n        zoomPX = this.zoomType.indexOf(\"x\") >= 0,\n        //Whether to zoom horizontally\n        zoomPY = this.zoomType.indexOf(\"y\") >= 0,\n        //Whether to zoom vertically\n        reRender = false;\n      this.resetOverlayedCanvas();\n      if (this.plotInfo.axisPlacement === \"xySwapped\") {\n        var temp = zoomPY;\n        zoomPY = zoomPX;\n        zoomPX = temp;\n      }\n      if (this.panEnabled || this.zoomEnabled) {\n        if (this.panEnabled) {\n          var overflow = 0;\n          for (var i = 0; i < this._axes.length; i++) {\n            var axis = this._axes[i];\n            if (axis.viewportMinimum < axis.minimum) {\n              overflow = axis.minimum - axis.viewportMinimum;\n              axis.sessionVariables.newViewportMinimum = axis.viewportMinimum + overflow;\n              axis.sessionVariables.newViewportMaximum = axis.viewportMaximum + overflow;\n              reRender = true;\n            } else if (axis.viewportMaximum > axis.maximum) {\n              overflow = axis.viewportMaximum - axis.maximum;\n              axis.sessionVariables.newViewportMinimum = axis.viewportMinimum - overflow;\n              axis.sessionVariables.newViewportMaximum = axis.viewportMaximum - overflow;\n              reRender = true;\n            }\n          }\n        } else if ((!zoomPX || Math.abs(dragDeltaPX) > 2) && (!zoomPY || Math.abs(dragDeltaPY) > 2) && this.zoomEnabled) {\n          if (!this.dragStartPoint) return;\n          var selectedRegion = {\n            x1: zoomPX ? this.dragStartPoint.x : this.plotArea.x1,\n            y1: zoomPY ? this.dragStartPoint.y : this.plotArea.y1,\n            x2: zoomPX ? x : this.plotArea.x2,\n            y2: zoomPY ? y : this.plotArea.y2\n          };\n          if (Math.abs(selectedRegion.x1 - selectedRegion.x2) > 2 && Math.abs(selectedRegion.y1 - selectedRegion.y2) > 2) {\n            if (this._zoomPanToSelectedRegion(selectedRegion.x1, selectedRegion.y1, selectedRegion.x2, selectedRegion.y2)) {\n              reRender = true;\n            }\n          }\n        }\n        if (reRender) {\n          this._ignoreNextEvent = true; //Required so that click event doesn't fire after zooming into a section of the chart.\n\n          this._dispatchRangeEvent(\"rangeChanging\", \"zoom\");\n          this.render();\n          this._dispatchRangeEvent(\"rangeChanged\", \"zoom\");\n          if (reRender && this.zoomEnabled && this._zoomButton.style.display === \"none\") {\n            show(this._zoomButton, this._resetButton);\n            setButtonState(this, this._zoomButton, \"pan\");\n            setButtonState(this, this._resetButton, \"reset\");\n          }\n        }\n      }\n    }\n  }\n  this.isDrag = false;\n};\nChart.prototype._plotAreaMouseMove = function (x, y) {\n  if (this.isDrag && this.plotInfo.axisPlacement !== \"none\") {\n    var dragDeltaPX = 0,\n      dragDeltaPY = 0,\n      alpha = null,\n      selectedRegion = null,\n      zoomPX = this.zoomType.indexOf(\"x\") >= 0,\n      //Whether to zoom horizontally\n      zoomPY = this.zoomType.indexOf(\"y\") >= 0,\n      //Whether to zoom vertically\n      _this = this;\n    if (this.plotInfo.axisPlacement === \"xySwapped\") {\n      var temp = zoomPY;\n      zoomPY = zoomPX;\n      zoomPX = temp;\n    }\n    dragDeltaPX = this.dragStartPoint.x - x;\n    dragDeltaPY = this.dragStartPoint.y - y;\n    if (Math.abs(dragDeltaPX) > 2 && Math.abs(dragDeltaPX) < 8 && (this.panEnabled || this.zoomEnabled)) {\n      this._toolTip.hide();\n    } else if (!this.panEnabled && !this.zoomEnabled) {\n      this._toolTip.mouseMoveHandler(x, y);\n    }\n    if ((!zoomPX || Math.abs(dragDeltaPX) > 2 || !zoomPY || Math.abs(dragDeltaPY) > 2) && (this.panEnabled || this.zoomEnabled)) {\n      if (this.panEnabled) {\n        selectedRegion = {\n          x1: zoomPX ? this.plotArea.x1 + dragDeltaPX : this.plotArea.x1,\n          y1: zoomPY ? this.plotArea.y1 + dragDeltaPY : this.plotArea.y1,\n          x2: zoomPX ? this.plotArea.x2 + dragDeltaPX : this.plotArea.x2,\n          y2: zoomPY ? this.plotArea.y2 + dragDeltaPY : this.plotArea.y2\n        };\n        if (this._zoomPanToSelectedRegion(selectedRegion.x1, selectedRegion.y1, selectedRegion.x2, selectedRegion.y2, true)) {\n          this._dispatchRangeEvent(\"rangeChanging\", \"pan\");\n          this.render();\n          this._dispatchRangeEvent(\"rangeChanged\", \"pan\");\n          this.dragStartPoint.x = x;\n          this.dragStartPoint.y = y;\n\n          //clearTimeout(this._panTimerId);\n          //this._panTimerId = setTimeout(function () {\n          //\t_this._dispatchRangeEvent(\"rangeChanging\", \"pan\");\n          //\t_this.render();\n          //\t_this._dispatchRangeEvent(\"rangeChanged\", \"pan\");\n          //}, 0);\n        }\n      } else if (this.zoomEnabled) {\n        this.resetOverlayedCanvas();\n        alpha = this.overlaidCanvasCtx.globalAlpha;\n        this.overlaidCanvasCtx.globalAlpha = .7;\n        this.overlaidCanvasCtx.fillStyle = \"#A0ABB8\";\n        var rect = {\n          x1: zoomPX ? this.dragStartPoint.x : this.plotArea.x1,\n          y1: zoomPY ? this.dragStartPoint.y : this.plotArea.y1,\n          x2: zoomPX ? x - this.dragStartPoint.x : this.plotArea.x2 - this.plotArea.x1,\n          y2: zoomPY ? y - this.dragStartPoint.y : this.plotArea.y2 - this.plotArea.y1\n        };\n        this.overlaidCanvasCtx.fillRect(rect.x1, rect.y1, rect.x2, rect.y2);\n        this.overlaidCanvasCtx.globalAlpha = alpha;\n      }\n    }\n  } else this._toolTip.mouseMoveHandler(x, y);\n};\n\n//#endregion Events\n\n//Sets the viewport range of Axis based on the given rect bounds (pixels). Also limits the zooming/panning based on axis bounds. Returns a boolean to indicate whether it was succesful or not based on the selected region.\nChart.prototype._zoomPanToSelectedRegion = function (px1, py1, px2, py2, keepAxisIndependent) {\n  keepAxisIndependent = keepAxisIndependent || false;\n  var zoomPX = this.zoomType.indexOf(\"x\") >= 0,\n    //Whether to zoom horizontally\n    zoomPY = this.zoomType.indexOf(\"y\") >= 0,\n    //Whether to zoom vertically\n    validRegion = false;\n  var axes = [],\n    axesWithValidRange = [];\n  if (this.axisX && zoomPX) axes.push(this.axisX);\n  if (this.axisY && zoomPY) axes.push(this.axisY);\n  if (this.axisY2 && zoomPY) axes.push(this.axisY2);\n  var params = [];\n  for (var i = 0; i < axes.length; i++) {\n    var axis = axes[i];\n    //var range = Math.abs(axis.viewportMaximum - axis.viewportMinimum);\n\n    var val1 = axis.convertPixelToValue({\n      x: px1,\n      y: py1\n    });\n    var val2 = axis.convertPixelToValue({\n      x: px2,\n      y: py2\n    });\n    if (val1 > val2) {\n      var temp = val2;\n      val2 = val1;\n      val1 = temp;\n    }\n    if (isFinite(axis.dataInfo.minDiff)) {\n      if (!(Math.abs(val2 - val1) < 3 * Math.abs(axis.dataInfo.minDiff) || val1 < axis.minimum || val2 > axis.maximum)) {\n        axesWithValidRange.push(axis);\n        params.push({\n          val1: val1,\n          val2: val2\n        });\n        validRegion = true;\n      } else if (!keepAxisIndependent) {\n        validRegion = false;\n        break;\n      }\n    }\n  }\n  if (validRegion) {\n    for (var i = 0; i < axesWithValidRange.length; i++) {\n      var axis = axesWithValidRange[i];\n      var param = params[i];\n      axis.setViewPortRange(param.val1, param.val2);\n    }\n  }\n  return validRegion;\n};\nChart.prototype.preparePlotArea = function () {\n  var plotArea = this.plotArea;\n  var yAxis = this.axisY ? this.axisY : this.axisY2;\n  if (!isCanvasSupported && (plotArea.x1 > 0 || plotArea.y1 > 0)) {\n    plotArea.ctx.translate(plotArea.x1, plotArea.y1);\n  }\n  if (this.axisX && yAxis) {\n    plotArea.x1 = this.axisX.lineCoordinates.x1 < this.axisX.lineCoordinates.x2 ? this.axisX.lineCoordinates.x1 : yAxis.lineCoordinates.x1;\n    plotArea.y1 = this.axisX.lineCoordinates.y1 < yAxis.lineCoordinates.y1 ? this.axisX.lineCoordinates.y1 : yAxis.lineCoordinates.y1;\n    plotArea.x2 = this.axisX.lineCoordinates.x2 > yAxis.lineCoordinates.x2 ? this.axisX.lineCoordinates.x2 : yAxis.lineCoordinates.x2;\n    plotArea.y2 = this.axisX.lineCoordinates.y2 > this.axisX.lineCoordinates.y1 ? this.axisX.lineCoordinates.y2 : yAxis.lineCoordinates.y2;\n    plotArea.width = plotArea.x2 - plotArea.x1;\n    plotArea.height = plotArea.y2 - plotArea.y1;\n    //plotArea = { x1: x1, y1: y1, x2: x2, y2: y2, width: x2 - x1, height: y2 - y1 };\n  } else {\n    //ToDo: @sunil\n    var freeSpace = this.layoutManager.getFreeSpace();\n    plotArea.x1 = freeSpace.x1;\n    plotArea.x2 = freeSpace.x2;\n    plotArea.y1 = freeSpace.y1;\n    plotArea.y2 = freeSpace.y2;\n    plotArea.width = freeSpace.width;\n    plotArea.height = freeSpace.height;\n  }\n  if (!isCanvasSupported) {\n    plotArea.canvas.width = plotArea.width;\n    plotArea.canvas.height = plotArea.height;\n    plotArea.canvas.style.left = plotArea.x1 + \"px\";\n    plotArea.canvas.style.top = plotArea.y1 + \"px\";\n    if (plotArea.x1 > 0 || plotArea.y1 > 0) {\n      plotArea.ctx.translate(-plotArea.x1, -plotArea.y1);\n    }\n  }\n  plotArea.layoutManager = new LayoutManager(plotArea.x1, plotArea.y1, plotArea.x2, plotArea.y2, 2);\n};\nChart.prototype.getPixelCoordinatesOnPlotArea = function (x, y) {\n  return {\n    x: this.axisX.getPixelCoordinatesOnAxis(x).x,\n    y: this.axisY.getPixelCoordinatesOnAxis(y).y\n  };\n  //return { x: 5, y: 10 };\n};\n\n//#region Render Methods\n\nChart.prototype.renderIndexLabels = function (targetCtx) {\n  var ctx = targetCtx || this.plotArea.ctx;\n  var plotArea = this.plotArea;\n  var mid = 0;\n  var yMinLimit = 0;\n  var yMaxLimit = 0;\n  var xMinLimit = 0;\n  var xMaxLimit = 0;\n  var marginX = 0,\n    marginY = 0; // Margin between label and dataPoint / PlotArea\n  var offSetX = 0,\n    offSetY = 0; // Distance to offSet textBlock (top) from dataPoint inorder to position it\n  var visibleWidth = 0;\n  var visibleHeight = 0;\n  for (var i = 0; i < this._indexLabels.length; i++) {\n    var indexLabel = this._indexLabels[i];\n    var chartTypeLower = indexLabel.chartType.toLowerCase();\n    var x, y, angle;\n    var fontColor = getProperty(\"indexLabelFontColor\", indexLabel.dataPoint, indexLabel.dataSeries);\n    var fontSize = getProperty(\"indexLabelFontSize\", indexLabel.dataPoint, indexLabel.dataSeries);\n    var fontFamily = getProperty(\"indexLabelFontFamily\", indexLabel.dataPoint, indexLabel.dataSeries);\n    var fontStyle = getProperty(\"indexLabelFontStyle\", indexLabel.dataPoint, indexLabel.dataSeries);\n    var fontWeight = getProperty(\"indexLabelFontWeight\", indexLabel.dataPoint, indexLabel.dataSeries);\n    var backgroundColor = getProperty(\"indexLabelBackgroundColor\", indexLabel.dataPoint, indexLabel.dataSeries);\n    var maxWidth = getProperty(\"indexLabelMaxWidth\", indexLabel.dataPoint, indexLabel.dataSeries);\n    var indexLabelWrap = getProperty(\"indexLabelWrap\", indexLabel.dataPoint, indexLabel.dataSeries);\n    var percentAndTotal = {\n      percent: null,\n      total: null\n    };\n    var formatterParameter = null;\n    if (indexLabel.dataSeries.type.indexOf(\"stacked\") >= 0 || indexLabel.dataSeries.type === \"pie\" || indexLabel.dataSeries.type === \"doughnut\") percentAndTotal = this.getPercentAndTotal(indexLabel.dataSeries, indexLabel.dataPoint);\n    if (indexLabel.dataSeries.indexLabelFormatter || indexLabel.dataPoint.indexLabelFormatter) formatterParameter = {\n      chart: this._options,\n      dataSeries: indexLabel.dataSeries,\n      dataPoint: indexLabel.dataPoint,\n      index: indexLabel.indexKeyword,\n      total: percentAndTotal.total,\n      percent: percentAndTotal.percent\n    };\n    var indexLabelText = indexLabel.dataPoint.indexLabelFormatter ? indexLabel.dataPoint.indexLabelFormatter(formatterParameter) : indexLabel.dataPoint.indexLabel ? this.replaceKeywordsWithValue(indexLabel.dataPoint.indexLabel, indexLabel.dataPoint, indexLabel.dataSeries, null, indexLabel.indexKeyword) : indexLabel.dataSeries.indexLabelFormatter ? indexLabel.dataSeries.indexLabelFormatter(formatterParameter) : indexLabel.dataSeries.indexLabel ? this.replaceKeywordsWithValue(indexLabel.dataSeries.indexLabel, indexLabel.dataPoint, indexLabel.dataSeries, null, indexLabel.indexKeyword) : null;\n    if (indexLabelText === null || indexLabelText === \"\") continue;\n    var placement = getProperty(\"indexLabelPlacement\", indexLabel.dataPoint, indexLabel.dataSeries);\n    var orientation = getProperty(\"indexLabelOrientation\", indexLabel.dataPoint, indexLabel.dataSeries);\n    var angle = 0;\n    var direction = indexLabel.direction; // +1 for above the point and -1 for below the point\n\n    var axisX = indexLabel.dataSeries.axisX;\n    var axisY = indexLabel.dataSeries.axisY;\n    var textBlock = new TextBlock(ctx, {\n      x: 0,\n      y: 0,\n      maxWidth: maxWidth ? maxWidth : this.width * .5,\n      maxHeight: indexLabelWrap ? fontSize * 5 : fontSize * 1.5,\n      angle: orientation === \"horizontal\" ? 0 : -90,\n      text: indexLabelText,\n      padding: 0,\n      backgroundColor: backgroundColor,\n      horizontalAlign: \"left\",\n      //left, center, right\n      fontSize: fontSize,\n      //in pixels\n      fontFamily: fontFamily,\n      fontWeight: fontWeight,\n      //normal, bold, bolder, lighter,\n      fontColor: fontColor,\n      fontStyle: fontStyle,\n      // normal, italic, oblique\n      textBaseline: \"top\"\n    });\n    var textSize = textBlock.measureText();\n\n    //if (indexLabel.dataPoint.x < axisX.viewportMinimum || indexLabel.dataPoint.x > axisX.viewportMaximum || indexLabel.dataPoint.y < axisY.viewportMinimum || indexLabel.dataPoint.y > axisY.viewportMaximum)\n    //\tcontinue;\n\n    if (chartTypeLower.indexOf(\"line\") >= 0 || chartTypeLower.indexOf(\"area\") >= 0 || chartTypeLower.indexOf(\"bubble\") >= 0 || chartTypeLower.indexOf(\"scatter\") >= 0) {\n      if (indexLabel.dataPoint.x < axisX.viewportMinimum || indexLabel.dataPoint.x > axisX.viewportMaximum || indexLabel.dataPoint.y < axisY.viewportMinimum || indexLabel.dataPoint.y > axisY.viewportMaximum) continue;\n    } else {\n      if (indexLabel.dataPoint.x < axisX.viewportMinimum || indexLabel.dataPoint.x > axisX.viewportMaximum) continue;\n    }\n    marginY = 2;\n    marginX = 2;\n    if (orientation === \"horizontal\") {\n      visibleWidth = textBlock.width;\n      visibleHeight = textBlock.height;\n    } else {\n      visibleHeight = textBlock.width;\n      visibleWidth = textBlock.height;\n    }\n    if (this.plotInfo.axisPlacement === \"normal\") {\n      if (chartTypeLower.indexOf(\"line\") >= 0 || chartTypeLower.indexOf(\"area\") >= 0) {\n        placement = \"auto\";\n        marginY = 4;\n      } else if (chartTypeLower.indexOf(\"stacked\") >= 0) {\n        if (placement === \"auto\") placement = \"inside\";\n      } else if (chartTypeLower === \"bubble\" || chartTypeLower === \"scatter\") {\n        placement = \"inside\";\n      }\n      x = indexLabel.point.x - visibleWidth / 2;\n      if (placement !== \"inside\") {\n        //outside or auto\n\n        yMinLimit = plotArea.y1;\n        yMaxLimit = plotArea.y2;\n        if (direction > 0) {\n          y = indexLabel.point.y - visibleHeight - marginY;\n          if (y < yMinLimit) {\n            if (placement === \"auto\") {\n              y = Math.max(indexLabel.point.y, yMinLimit) + marginY;\n            } else {\n              y = yMinLimit + marginY;\n            }\n          }\n        } else {\n          y = indexLabel.point.y + marginY;\n          if (y > yMaxLimit - visibleHeight - marginY) {\n            if (placement === \"auto\") {\n              y = Math.min(indexLabel.point.y, yMaxLimit) - visibleHeight - marginY;\n            } else {\n              y = yMaxLimit - visibleHeight - marginY;\n            }\n          }\n        }\n      } else {\n        yMinLimit = Math.max(indexLabel.bounds.y1, plotArea.y1);\n        yMaxLimit = Math.min(indexLabel.bounds.y2, plotArea.y2);\n        if (chartTypeLower.indexOf(\"range\") >= 0) {\n          if (direction > 0) mid = Math.max(indexLabel.bounds.y1, plotArea.y1) + visibleHeight / 2 + marginY;else mid = Math.min(indexLabel.bounds.y2, plotArea.y2) - visibleHeight / 2 - marginY;\n        } else mid = (Math.max(indexLabel.bounds.y1, plotArea.y1) + Math.min(indexLabel.bounds.y2, plotArea.y2)) / 2;\n        if (direction > 0) {\n          y = Math.max(indexLabel.point.y, mid) - visibleHeight / 2;\n          if (y < yMinLimit && (chartTypeLower === \"bubble\" || chartTypeLower === \"scatter\")) {\n            y = Math.max(indexLabel.point.y - visibleHeight - marginY, plotArea.y1 + marginY);\n          }\n        } else {\n          y = Math.min(indexLabel.point.y, mid) - visibleHeight / 2;\n          if (y > yMaxLimit - visibleHeight - marginY && (chartTypeLower === \"bubble\" || chartTypeLower === \"scatter\")) {\n            y = Math.min(indexLabel.point.y + marginY, plotArea.y2 - visibleHeight - marginY);\n          }\n        }\n\n        // Make Sure that it does not overlap the axis line\n        y = Math.min(y, yMaxLimit - visibleHeight);\n      }\n    } else {\n      if (chartTypeLower.indexOf(\"line\") >= 0 || chartTypeLower.indexOf(\"area\") >= 0 || chartTypeLower.indexOf(\"scatter\") >= 0) {\n        placement = \"auto\";\n        marginX = 4;\n      } else if (chartTypeLower.indexOf(\"stacked\") >= 0) {\n        if (placement === \"auto\") placement = \"inside\";\n      } else if (chartTypeLower === \"bubble\") {\n        placement = \"inside\";\n      }\n      y = indexLabel.point.y - visibleHeight / 2;\n      if (placement !== \"inside\") {\n        //outside or auto\n\n        xMinLimit = plotArea.x1;\n        xMaxLimit = plotArea.x2;\n        if (direction < 0) {\n          x = indexLabel.point.x - visibleWidth - marginX;\n          if (x < xMinLimit) {\n            if (placement === \"auto\") {\n              x = Math.max(indexLabel.point.x, xMinLimit) + marginX;\n            } else {\n              x = xMinLimit + marginX;\n            }\n          }\n        } else {\n          x = indexLabel.point.x + marginX;\n          if (x > xMaxLimit - visibleWidth - marginX) {\n            if (placement === \"auto\") {\n              x = Math.min(indexLabel.point.x, xMaxLimit) - visibleWidth - marginX;\n            } else {\n              x = xMaxLimit - visibleWidth - marginX;\n            }\n          }\n        }\n      } else {\n        xMinLimit = Math.max(indexLabel.bounds.x1, plotArea.x1);\n        xMaxLimit = Math.min(indexLabel.bounds.x2, plotArea.x2);\n        if (chartTypeLower.indexOf(\"range\") >= 0) {\n          if (direction < 0) mid = Math.max(indexLabel.bounds.x1, plotArea.x1) + visibleWidth / 2 + marginX;else mid = Math.min(indexLabel.bounds.x2, plotArea.x2) - visibleWidth / 2 - marginX;\n        } else var mid = (Math.max(indexLabel.bounds.x1, plotArea.x1) + Math.min(indexLabel.bounds.x2, plotArea.x2)) / 2;\n        if (direction < 0) {\n          x = Math.max(indexLabel.point.x, mid) - visibleWidth / 2;\n\n          //if (y < xMinLimit) {\n          //\ty = Math.max(indexLabel.point.y - visibleHeight - marginY, plotArea.y1 + marginY);\n          //}\n        } else {\n          x = Math.min(indexLabel.point.x, mid) - visibleWidth / 2;\n\n          //if (y > xMaxLimit - visibleHeight - marginY) {\n          //\ty = Math.min(indexLabel.point.y + marginY, plotArea.y2 - visibleHeight - marginY);\n          //}\n        }\n\n        // Make Sure that it does not overlap the axis line\n        x = Math.max(x, xMinLimit);\n      }\n    }\n    if (orientation === \"vertical\") {\n      y += visibleHeight;\n    }\n    textBlock.x = x;\n    textBlock.y = y;\n\n    //console.log(textBlock.text + \": \" + textBlock.x + \"; \" + textBlock.y);\n\n    textBlock.render(true);\n  }\n\n  //source and dest would be same when animation is not enabled\n  var animationInfo = {\n    source: ctx,\n    dest: this.plotArea.ctx,\n    animationCallback: AnimationHelper.fadeInAnimation,\n    easingFunction: AnimationHelper.easing.easeInQuad,\n    animationBase: 0,\n    startTimePercent: .7\n  };\n  return animationInfo;\n};\nChart.prototype.renderLine = function (plotUnit) {\n  var ctx = plotUnit.targetCanvasCtx || this.plotArea.ctx;\n  var totalDataSeries = plotUnit.dataSeriesIndexes.length;\n  if (totalDataSeries <= 0) return;\n  var ghostCtx = this._eventManager.ghostCtx;\n  //var ghostCtx = this.overlaidCanvasCtx;\n\n  ctx.save();\n  var plotArea = this.plotArea;\n  ctx.beginPath();\n  ctx.rect(plotArea.x1, plotArea.y1, plotArea.width, plotArea.height);\n  ctx.clip();\n  var markers = [];\n  for (var j = 0; j < plotUnit.dataSeriesIndexes.length; j++) {\n    var dataSeriesIndex = plotUnit.dataSeriesIndexes[j];\n    var dataSeries = this.data[dataSeriesIndex];\n    ctx.lineWidth = dataSeries.lineThickness;\n    var dataPoints = dataSeries.dataPoints;\n    if (ctx.setLineDash) {\n      ctx.setLineDash(getLineDashArray(dataSeries.lineDashType, dataSeries.lineThickness));\n    }\n    var seriesId = dataSeries.id;\n    this._eventManager.objectMap[seriesId] = {\n      objectType: \"dataSeries\",\n      dataSeriesIndex: dataSeriesIndex\n    };\n    var hexColor = intToHexColorString(seriesId);\n    ghostCtx.strokeStyle = hexColor;\n    //ghostCtx.lineWidth = dataSeries.lineThickness;\n    ghostCtx.lineWidth = dataSeries.lineThickness > 0 ? Math.max(dataSeries.lineThickness, 4) : 0;\n    var colorSet = dataSeries._colorSet;\n    var color = colorSet[0];\n    ctx.strokeStyle = color;\n    var isFirstDataPointInPlotArea = true;\n    var i = 0,\n      x,\n      y;\n    var dataPointX; //Used so that when dataPoint.x is a DateTime value, it doesn't get converted to number back and forth.\n\n    //if (!dataSeries._options.markerSize && dataSeries.dataPoints.length < 1000)\n    //    dataSeries.markerSize = 8;\n    ctx.beginPath();\n    if (dataPoints.length > 0) {\n      //var xy = this.getPixelCoordinatesOnPlotArea(dataPoints[0].x, dataPoints[0].y);\n\n      //dataSeries.noDataPointsInPlotArea = 0\n      var prevDataNull = false;\n      for (i = 0; i < dataPoints.length; i++) {\n        dataPointX = dataPoints[i].x.getTime ? dataPoints[i].x.getTime() : dataPoints[i].x;\n        if (dataPointX < plotUnit.axisX.dataInfo.viewPortMin || dataPointX > plotUnit.axisX.dataInfo.viewPortMax) continue;\n\n        //if (!isFinite(dataPoints[i].y))\n        //    continue;\n\n        if (typeof dataPoints[i].y !== \"number\") {\n          if (i > 0) {\n            // if first dataPoint is null then no need to call stroke method\n            ctx.stroke();\n            if (isCanvasSupported) {\n              ghostCtx.stroke();\n            }\n          }\n          prevDataNull = true;\n          continue;\n        }\n        x = plotUnit.axisX.conversionParameters.reference + plotUnit.axisX.conversionParameters.pixelPerUnit * (dataPointX - plotUnit.axisX.conversionParameters.minimum) + .5 << 0;\n        y = plotUnit.axisY.conversionParameters.reference + plotUnit.axisY.conversionParameters.pixelPerUnit * (dataPoints[i].y - plotUnit.axisY.conversionParameters.minimum) + .5 << 0;\n        var id = dataSeries.dataPointIds[i];\n        this._eventManager.objectMap[id] = {\n          id: id,\n          objectType: \"dataPoint\",\n          dataSeriesIndex: dataSeriesIndex,\n          dataPointIndex: i,\n          x1: x,\n          y1: y\n        };\n\n        //dataSeries.noDataPointsInPlotArea++;\n\n        if (isFirstDataPointInPlotArea || prevDataNull) {\n          ctx.beginPath();\n          ctx.moveTo(x, y);\n          if (isCanvasSupported) {\n            ghostCtx.beginPath();\n            ghostCtx.moveTo(x, y);\n          }\n          isFirstDataPointInPlotArea = false;\n          prevDataNull = false;\n        } else {\n          ctx.lineTo(x, y);\n          if (isCanvasSupported) ghostCtx.lineTo(x, y);\n          if (i % 500 == 0) {\n            ctx.stroke();\n            ctx.beginPath();\n            ctx.moveTo(x, y);\n            if (isCanvasSupported) {\n              ghostCtx.stroke();\n              ghostCtx.beginPath();\n              ghostCtx.moveTo(x, y);\n            }\n          }\n        }\n\n        //Render Marker\n        if (dataPoints[i].markerSize > 0 || dataSeries.markerSize > 0) {\n          var markerProps = dataSeries.getMarkerProperties(i, x, y, ctx);\n          markers.push(markerProps);\n\n          //if (!dataSeries.maxWidthInX || markerProps.size > dataSeries.maxWidthInX) {\n          //\tdataSeries.maxWidthInX = markerProps.size / (plotUnit.axisX.conversionParameters.pixelPerUnit > 1 ? plotUnit.axisX.conversionParameters.pixelPerUnit - 1 : plotUnit.axisX.conversionParameters.pixelPerUnit);\n          //}\n\n          var markerColor = intToHexColorString(id);\n\n          //window.console.log(\"index: \" + i + \"; id: \" + id + \"; hex: \" + markerColor);\n\n          if (isCanvasSupported) {\n            markers.push({\n              x: x,\n              y: y,\n              ctx: ghostCtx,\n              type: markerProps.type,\n              size: markerProps.size,\n              color: markerColor,\n              borderColor: markerColor,\n              borderThickness: markerProps.borderThickness\n            });\n          }\n        }\n        if (dataPoints[i].indexLabel || dataSeries.indexLabel || dataPoints[i].indexLabelFormatter || dataSeries.indexLabelFormatter) {\n          this._indexLabels.push({\n            chartType: \"line\",\n            dataPoint: dataPoints[i],\n            dataSeries: dataSeries,\n            point: {\n              x: x,\n              y: y\n            },\n            direction: dataPoints[i].y >= 0 ? 1 : -1,\n            color: color\n          });\n        }\n      }\n      ctx.stroke();\n      if (isCanvasSupported) ghostCtx.stroke();\n    }\n  }\n  RenderHelper.drawMarkers(markers);\n  ctx.restore();\n  ctx.beginPath();\n  if (isCanvasSupported) ghostCtx.beginPath();\n\n  //source and dest would be same when animation is not enabled\n  var animationInfo = {\n    source: ctx,\n    dest: this.plotArea.ctx,\n    animationCallback: AnimationHelper.xClipAnimation,\n    easingFunction: AnimationHelper.easing.linear,\n    animationBase: 0\n  };\n  return animationInfo;\n};\nChart.prototype.renderStepLine = function (plotUnit) {\n  var ctx = plotUnit.targetCanvasCtx || this.plotArea.ctx;\n  var totalDataSeries = plotUnit.dataSeriesIndexes.length;\n  if (totalDataSeries <= 0) return;\n  var ghostCtx = this._eventManager.ghostCtx;\n  //var ghostCtx = this.overlaidCanvasCtx;\n\n  ctx.save();\n  var plotArea = this.plotArea;\n  ctx.beginPath();\n  ctx.rect(plotArea.x1, plotArea.y1, plotArea.width, plotArea.height);\n  ctx.clip();\n  var markers = [];\n  for (var j = 0; j < plotUnit.dataSeriesIndexes.length; j++) {\n    var dataSeriesIndex = plotUnit.dataSeriesIndexes[j];\n    var dataSeries = this.data[dataSeriesIndex];\n    ctx.lineWidth = dataSeries.lineThickness;\n    var dataPoints = dataSeries.dataPoints;\n    if (ctx.setLineDash) {\n      ctx.setLineDash(getLineDashArray(dataSeries.lineDashType, dataSeries.lineThickness));\n    }\n    var seriesId = dataSeries.id;\n    this._eventManager.objectMap[seriesId] = {\n      objectType: \"dataSeries\",\n      dataSeriesIndex: dataSeriesIndex\n    };\n    var hexColor = intToHexColorString(seriesId);\n    ghostCtx.strokeStyle = hexColor;\n    //ghostCtx.lineWidth = dataSeries.lineThickness;\n    ghostCtx.lineWidth = dataSeries.lineThickness > 0 ? Math.max(dataSeries.lineThickness, 4) : 0;\n    var colorSet = dataSeries._colorSet;\n    var color = colorSet[0];\n    ctx.strokeStyle = color;\n    var isFirstDataPointInPlotArea = true;\n    var i = 0,\n      x,\n      y;\n    var dataPointX; //Used so that when dataPoint.x is a DateTime value, it doesn't get converted to number back and forth.\n\n    //if (!dataSeries._options.markerSize && dataSeries.dataPoints.length < 1000)\n    //    dataSeries.markerSize = 8;\n    ctx.beginPath();\n    if (dataPoints.length > 0) {\n      //var xy = this.getPixelCoordinatesOnPlotArea(dataPoints[0].x, dataPoints[0].y);\n\n      //dataSeries.noDataPointsInPlotArea = 0\n      var prevDataNull = false;\n      for (i = 0; i < dataPoints.length; i++) {\n        dataPointX = dataPoints[i].getTime ? dataPoints[i].x.getTime() : dataPoints[i].x;\n        if (dataPointX < plotUnit.axisX.dataInfo.viewPortMin || dataPointX > plotUnit.axisX.dataInfo.viewPortMax) continue;\n\n        //if (!isFinite(dataPoints[i].y))\n        //    continue;\n\n        if (typeof dataPoints[i].y !== \"number\") {\n          if (i > 0) {\n            // if first dataPoint is null then no need to call stroke method\n            ctx.stroke();\n            if (isCanvasSupported) {\n              ghostCtx.stroke();\n            }\n          }\n          prevDataNull = true;\n          continue;\n        }\n        var prevY = y;\n        x = plotUnit.axisX.conversionParameters.reference + plotUnit.axisX.conversionParameters.pixelPerUnit * (dataPointX - plotUnit.axisX.conversionParameters.minimum) + .5 << 0;\n        y = plotUnit.axisY.conversionParameters.reference + plotUnit.axisY.conversionParameters.pixelPerUnit * (dataPoints[i].y - plotUnit.axisY.conversionParameters.minimum) + .5 << 0;\n        var id = dataSeries.dataPointIds[i];\n        this._eventManager.objectMap[id] = {\n          id: id,\n          objectType: \"dataPoint\",\n          dataSeriesIndex: dataSeriesIndex,\n          dataPointIndex: i,\n          x1: x,\n          y1: y\n        };\n\n        //dataSeries.noDataPointsInPlotArea++;\n\n        if (isFirstDataPointInPlotArea || prevDataNull) {\n          ctx.beginPath();\n          ctx.moveTo(x, y);\n          if (isCanvasSupported) {\n            ghostCtx.beginPath();\n            ghostCtx.moveTo(x, y);\n          }\n          isFirstDataPointInPlotArea = false;\n          prevDataNull = false;\n        } else {\n          ctx.lineTo(x, prevY);\n          if (isCanvasSupported) ghostCtx.lineTo(x, prevY);\n          ctx.lineTo(x, y);\n          if (isCanvasSupported) ghostCtx.lineTo(x, y);\n          if (i % 500 == 0) {\n            ctx.stroke();\n            ctx.beginPath();\n            ctx.moveTo(x, y);\n            if (isCanvasSupported) {\n              ghostCtx.stroke();\n              ghostCtx.beginPath();\n              ghostCtx.moveTo(x, y);\n            }\n          }\n        }\n\n        //Render Marker\n        if (dataPoints[i].markerSize > 0 || dataSeries.markerSize > 0) {\n          var markerProps = dataSeries.getMarkerProperties(i, x, y, ctx);\n          markers.push(markerProps);\n\n          //if (!dataSeries.maxWidthInX || markerProps.size > dataSeries.maxWidthInX) {\n          //\tdataSeries.maxWidthInX = markerProps.size / (plotUnit.axisX.conversionParameters.pixelPerUnit > 1 ? plotUnit.axisX.conversionParameters.pixelPerUnit - 1 : plotUnit.axisX.conversionParameters.pixelPerUnit);\n          //}\n\n          var markerColor = intToHexColorString(id);\n\n          //window.console.log(\"index: \" + i + \"; id: \" + id + \"; hex: \" + markerColor);\n          if (isCanvasSupported) {\n            markers.push({\n              x: x,\n              y: y,\n              ctx: ghostCtx,\n              type: markerProps.type,\n              size: markerProps.size,\n              color: markerColor,\n              borderColor: markerColor,\n              borderThickness: markerProps.borderThickness\n            });\n          }\n        }\n        if (dataPoints[i].indexLabel || dataSeries.indexLabel || dataPoints[i].indexLabelFormatter || dataSeries.indexLabelFormatter) {\n          this._indexLabels.push({\n            chartType: \"stepLine\",\n            dataPoint: dataPoints[i],\n            dataSeries: dataSeries,\n            point: {\n              x: x,\n              y: y\n            },\n            direction: dataPoints[i].y >= 0 ? 1 : -1,\n            color: color\n          });\n        }\n      }\n      ctx.stroke();\n      if (isCanvasSupported) ghostCtx.stroke();\n    }\n  }\n  RenderHelper.drawMarkers(markers);\n  ctx.restore();\n  ctx.beginPath();\n  if (isCanvasSupported) ghostCtx.beginPath();\n\n  //source and dest would be same when animation is not enabled\n  var animationInfo = {\n    source: ctx,\n    dest: this.plotArea.ctx,\n    animationCallback: AnimationHelper.xClipAnimation,\n    easingFunction: AnimationHelper.easing.linear,\n    animationBase: 0\n  };\n  return animationInfo;\n};\nChart.prototype.animationRequestId = null;\nChart.prototype.requestAnimFrame = function () {\n  return window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || window.oRequestAnimationFrame || window.msRequestAnimationFrame || function (callback) {\n    window.setTimeout(callback, 1000 / 60);\n  };\n}();\nChart.prototype.cancelRequestAnimFrame = function () {\n  return window.cancelAnimationFrame || window.webkitCancelRequestAnimationFrame || window.mozCancelRequestAnimationFrame || window.oCancelRequestAnimationFrame || window.msCancelRequestAnimationFrame || clearTimeout;\n}();\nChart.prototype.getPercentAndTotal = function (ds, dp) {\n  var dpX = null;\n  var total = null;\n  var percent = null;\n  if (ds.type.indexOf(\"stacked\") >= 0) {\n    total = 0;\n    dpX = dp.x.getTime ? dp.x.getTime() : dp.x;\n    if (dpX in ds.plotUnit.yTotals) {\n      total = ds.plotUnit.yTotals[dpX];\n      if (!isNaN(dp.y)) {\n        if (total === 0) percent = 0;else percent = dp.y / total * 100;\n      } else percent = 0;\n    }\n  } else if (ds.type === \"pie\" || ds.type === \"doughnut\") {\n    total = 0;\n    for (var i = 0; i < ds.dataPoints.length; i++) {\n      if (!isNaN(ds.dataPoints[i].y)) total += ds.dataPoints[i].y;\n    }\n    if (!isNaN(dp.y)) percent = dp.y / total * 100;else percent = 0;\n  }\n  return {\n    percent: percent,\n    total: total\n  };\n};\nChart.prototype.replaceKeywordsWithValue = function (str, dp, ds, dpIndex, indexKeywordValue) {\n  //var regex = /\\{\\s*[a-zA-Z]+\\s*\\}|\"[^\"]*\"|'[^']*'/g;\n  var regex = /\\{.*?\\}|\"[^\"]*\"|'[^']*'/g;\n  var chart = this;\n  indexKeywordValue = typeof indexKeywordValue === \"undefined\" ? 0 : indexKeywordValue;\n  if ((ds.type.indexOf(\"stacked\") >= 0 || ds.type === \"pie\" || ds.type === \"doughnut\") && (str.indexOf(\"#percent\") >= 0 || str.indexOf(\"#total\") >= 0)) {\n    var percent = \"#percent\";\n    var total = \"#total\";\n    var dpX = null;\n    var percentAndTotal = this.getPercentAndTotal(ds, dp);\n    total = isNaN(percentAndTotal.total) ? total : percentAndTotal.total;\n    percent = isNaN(percentAndTotal.percent) ? percent : percentAndTotal.percent;\n    do {\n      var percentFormatString = \"\";\n      if (ds.percentFormatString) percentFormatString = ds.percentFormatString;else {\n        percentFormatString = \"#,##0.\";\n        var numberOfDecimals = Math.max(Math.ceil(Math.log(1 / Math.abs(percent)) / Math.LN10), 2);\n        if (isNaN(numberOfDecimals) || !isFinite(numberOfDecimals)) numberOfDecimals = 2;\n        for (var n = 0; n < numberOfDecimals; n++) {\n          percentFormatString += \"#\";\n        }\n      }\n      str = str.replace(\"#percent\", numberFormat(percent, percentFormatString, chart._cultureInfo));\n      str = str.replace(\"#total\", numberFormat(total, ds.yValueFormatString ? ds.yValueFormatString : \"#,##0.########\"));\n    } while (str.indexOf(\"#percent\") >= 0 || str.indexOf(\"#total\") >= 0);\n  }\n  var fcn = function ($0) {\n    if ($0[0] === \"\\\"\" && $0[$0.length - 1] === \"\\\"\" || $0[0] === \"\\'\" && $0[$0.length - 1] === \"\\'\") return $0.slice(1, $0.length - 1);\n    var key = trimString($0.slice(1, $0.length - 1));\n    key = key.replace(\"#index\", indexKeywordValue);\n    var index = null;\n    try {\n      var match = key.match(/(.*?)\\s*\\[\\s*(.*?)\\s*\\]/);\n      if (match && match.length > 0) {\n        index = trimString(match[2]);\n        key = trimString(match[1]);\n      }\n    } catch (e) {}\n    ;\n    var obj = null;\n    if (key === \"color\") {\n      return dp.color ? dp.color : ds.color ? ds.color : ds._colorSet[dpIndex % ds._colorSet.length];\n    }\n    if (dp.hasOwnProperty(key)) obj = dp;else if (ds.hasOwnProperty(key)) obj = ds;else return \"\";\n    var value = obj[key];\n    if (index !== null) value = value[index];\n    if (key === \"x\") {\n      if (chart.axisX && chart.plotInfo.axisXValueType === \"dateTime\") return dateFormat(value, dp.xValueFormatString ? dp.xValueFormatString : ds.xValueFormatString ? ds.xValueFormatString : chart.axisX && chart.axisX.valueFormatString ? chart.axisX.valueFormatString : \"DD MMM YY\", chart._cultureInfo);else return numberFormat(value, dp.xValueFormatString ? dp.xValueFormatString : ds.xValueFormatString ? ds.xValueFormatString : \"#,##0.########\", chart._cultureInfo);\n    } else if (key === \"y\") return numberFormat(value, dp.yValueFormatString ? dp.yValueFormatString : ds.yValueFormatString ? ds.yValueFormatString : \"#,##0.########\", chart._cultureInfo);else if (key === \"z\") return numberFormat(value, dp.zValueFormatString ? dp.zValueFormatString : ds.zValueFormatString ? ds.zValueFormatString : \"#,##0.########\", chart._cultureInfo);else return value;\n  };\n  return str.replace(regex, fcn);\n};\nChart.prototype.renderSpline = SplineChart;\nChart.prototype.renderColumn = ColumnChart;\nChart.prototype.renderStackedColumn = StackedColumnChart;\nChart.prototype.renderStackedColumn100 = StackedColumn100Chart;\nChart.prototype.renderBar = BarChart;\nChart.prototype.renderStackedBar = StackedBarChart;\nChart.prototype.renderStackedBar100 = StackedBar100Chart;\nChart.prototype.renderArea = AreaChart;\nChart.prototype.renderSplineArea = SplineAreaChart;\nChart.prototype.renderStepArea = StepAreaChart;\nChart.prototype.renderStackedArea = StackedAreaChart;\nChart.prototype.renderStackedArea100 = StackedArea100Chart;\nChart.prototype.renderBubble = BubbleChart;\nChart.prototype.renderScatter = ScatterChart;\nChart.prototype.renderCandlestick = CandlestickChart;\nChart.prototype.renderRangeColumn = RangeColumnChart;\nChart.prototype.renderRangeBar = RangeBarChart;\nChart.prototype.renderRangeArea = RangeAreaChart;\nChart.prototype.renderRangeSplineArea = RangeSplineAreaChart;\nChart.prototype.renderPie = PieChart;\nexport default Chart;","map":{"version":3,"names":["CanvasJSObject","Animator","DataSeries","TextBlock","RenderHelper","LayoutManager","EventManager","ToolTip","CultureInfo","Axis","Title","Legend","AnimationHelper","colorSets","isDebugMode","defaultOptions","addEvent","setCanvasSize","addArrayIndexOf","hide","show","getMouseCoordinates","getProperty","isCanvasSupported","extend","createCanvas","extendCtx","getObjectId","getDevicePixelBackingStoreRatio","trimString","numberFormat","getLineDashArray","intToHexColorString","compareDataPointX","SplineChart","ColumnChart","StackedColumnChart","StackedColumn100Chart","BarChart","StackedBarChart","StackedBar100Chart","AreaChart","SplineAreaChart","StepAreaChart","StackedAreaChart","StackedArea100Chart","BubbleChart","ScatterChart","CandlestickChart","RangeColumnChart","RangeBarChart","RangeAreaChart","RangeSplineAreaChart","PieChart","devicePixelBackingStoreRatio","Chart","containerId","options","publicChartReference","_publicChartReference","base","constructor","call","theme","_this","_containerId","_objectsInitialized","ctx","overlaidCanvasCtx","_indexLabels","_panTimerId","_lastTouchEventType","_lastTouchData","isAnimating","renderCount","animatedRender","disableToolTip","panEnabled","_defaultCursor","plotArea","canvas","x1","y1","x2","y2","width","height","_dataInRenderedOrder","_container","document","getElementById","window","console","log","innerHTML","_options","clientWidth","clientHeight","_selectedColorSet","colorSet","_canvasJSContainer","createElement","setAttribute","style","position","textAlign","cursor","appendChild","getContext","textBaseline","overlaidCanvas","_eventManager","_updateSize","render","_toolBar","cssText","bounds","e","_mouseEventHandler","_dropdownMenu","navigator","msPointerEnabled","_touchEventHandler","_creditLink","_toolTip","toolTip","data","axisX","axisY","axisY2","sessionVariables","prototype","_updateOptions","updateOption","backgroundColor","_cultureInfo","culture","animationEnabled","zoomEnabled","_zoomButton","setButtonState","_resetButton","newViewportMinimum","newViewportMaximum","resetOverlayedCanvas","_dispatchRangeEvent","getAttribute","zoomText","_menuButton","exportEnabled","display","_dropDownCloseTime","Date","getTime","blur","focus","exportOption","saveJPGText","exportCanvas","exportFileName","savePNGText","resetText","creditHref","creditText","creditTextChanged","creditHrefChanged","parentElement","removeChild","prop","hasOwnProperty","ghostCanvas","_initialize","_animator","cancelAllAnimations","removeAllEventListeners","_axes","pieDoughnutClickHandler","animationRequestId","cancelRequestAnimFrame","clearCanvas","beginPath","_events","reset","plotInfo","axisPlacement","axisXValueType","plotTypes","layoutManager","dataSeriesIndex","series","length","type","_supportedChartTypes","indexOf","dataSeries","lastObjectId","name","color","_colorSet","index","markerSize","dataPoints","sort","push","seriesAxisPlacement","errorMessage","plotAreaElements","i","axisYType","gridThickness","showToolBar","viewportMinimum","viewportMaximum","_processData","title","_title","dockInsidePlotArea","subtitles","subtitle","Subtitle","legend","showInLegend","setLayoutAndRender","getFreeSpace","preparePlotArea","animations","initialState","initialStateCtx","drawImage","plotType","j","plotUnits","plotUnit","animationInfo","targetCanvas","targetCanvasCtx","renderLine","renderStepLine","renderSpline","renderColumn","renderBar","renderArea","renderStepArea","renderSplineArea","renderStackedColumn","renderStackedColumn100","renderStackedBar","renderStackedBar100","renderStackedArea","renderStackedArea100","renderBubble","renderScatter","renderPie","renderCandlestick","renderRangeColumn","renderRangeBar","renderRangeArea","renderRangeSplineArea","k","dataSeriesIndexes","indexLabelCanvas","indexLabelCanvasCtx","renderIndexLabels","animate","animationDuration","fractionComplete","clearRect","Math","floor","l","startTimePercent","animationCallback","easingFunction","dispatchEvent","chart","count","attachPlotAreaEventHandlers","_updateToolTip","setTimeout","ghostCanvasCopy","ghostCanvasCopyCtx","attachEvent","context","mousedown","_plotAreaMouseDown","mouseup","_plotAreaMouseUp","mousemove","_plotAreaMouseMove","capture","categoriseDataSeries","visible","plotTypeExists","plotUnitExists","totalDataSeries","previousDataSeriesCount","yTotals","assignIdToDataPoints","dataPointIds","_processMultiseriesPlotUnit","_processStackedPlotUnit","_processStacked100PlotUnit","_processMultiYPlotUnit","axisYDataInfo","dataInfo","axisXDataInfo","dataPointX","dataPointY","isDateTime","isFirstDPInViewPort","isLastDPInViewPort","plotAreaXMin","minimum","Infinity","plotAreaXMax","maximum","x","xValueType","y","min","max","xDiff","minDiff","yDiff","label","labels","viewPortMin","viewPortMax","dataPointYPositiveSums","dataPointYNegativeSums","abs","isNaN","ySum","containsPositiveY","containsNegativeY","dataPointYSums","dataPointYMin","dataPointYMax","apply","getDataPointAtXY","mouseX","mouseY","getClosest","results","result","closestResult","onlyLineAreaTypes","m","dataPoint","distance","getObjectAtXY","id","dataPointInfo","dataPointIndex","ghostCtx","items","item","getAutoFontSize","standardSize","fontSizeScaleFactor","round","fillStyle","fillRect","param","ev","changedTouches","interactivityEnabled","mouseEvents","touches","first","touchCurrentCoordinates","time","dy","dx","dt","scroll","win","parent","scrollBy","isDrag","simulatedEvent","createEvent","initMouseEvent","screenX","screenY","clientX","clientY","target","preventManipulation","preventDefault","eventName","triggerSource","eventParameter","trigger","axes","_ignoreNextEvent","srcElement","xy","eventParam","rightclick","event","which","button","capturedEventParam","releaseCapture","body","removeEventListener","setCapture","addEventListener","enabled","mouseEventHandler","dragStartPoint","dragDelta","dragDeltaPY","dragDeltaPX","zoomPX","zoomType","zoomPY","reRender","temp","overflow","axis","selectedRegion","_zoomPanToSelectedRegion","alpha","mouseMoveHandler","globalAlpha","rect","px1","py1","px2","py2","keepAxisIndependent","validRegion","axesWithValidRange","params","val1","convertPixelToValue","val2","isFinite","setViewPortRange","yAxis","translate","lineCoordinates","freeSpace","left","top","getPixelCoordinatesOnPlotArea","getPixelCoordinatesOnAxis","targetCtx","mid","yMinLimit","yMaxLimit","xMinLimit","xMaxLimit","marginX","marginY","offSetX","offSetY","visibleWidth","visibleHeight","indexLabel","chartTypeLower","chartType","toLowerCase","angle","fontColor","fontSize","fontFamily","fontStyle","fontWeight","maxWidth","indexLabelWrap","percentAndTotal","percent","total","formatterParameter","getPercentAndTotal","indexLabelFormatter","indexKeyword","indexLabelText","replaceKeywordsWithValue","placement","orientation","direction","textBlock","maxHeight","text","padding","horizontalAlign","textSize","measureText","point","source","dest","fadeInAnimation","easing","easeInQuad","animationBase","save","clip","markers","lineWidth","lineThickness","setLineDash","lineDashType","seriesId","objectMap","objectType","hexColor","strokeStyle","isFirstDataPointInPlotArea","prevDataNull","stroke","conversionParameters","reference","pixelPerUnit","moveTo","lineTo","markerProps","getMarkerProperties","markerColor","size","borderColor","borderThickness","drawMarkers","restore","xClipAnimation","linear","prevY","requestAnimFrame","requestAnimationFrame","webkitRequestAnimationFrame","mozRequestAnimationFrame","oRequestAnimationFrame","msRequestAnimationFrame","callback","cancelAnimationFrame","webkitCancelRequestAnimationFrame","mozCancelRequestAnimationFrame","oCancelRequestAnimationFrame","msCancelRequestAnimationFrame","clearTimeout","ds","dp","dpX","str","dpIndex","indexKeywordValue","regex","percentFormatString","numberOfDecimals","ceil","LN10","n","replace","yValueFormatString","fcn","$0","slice","key","match","obj","value","dateFormat","xValueFormatString","valueFormatString","zValueFormatString"],"sources":["C:/Users/IMPEGNOABS010/Desktop/HRMSROUT/node_modules/canvasjs/src/core/charts.js"],"sourcesContent":["\r\nimport CanvasJSObject from './canvasjs';\r\nimport Animator from './animator';\r\nimport DataSeries from './data_series';\r\nimport TextBlock from './text_block';\r\nimport RenderHelper from '../helpers/render';\r\nimport LayoutManager from './layout_manager';\r\nimport EventManager from './event_manager';\r\nimport ToolTip from './tooltip';\r\nimport CultureInfo from '../core/culture_info';\r\nimport Axis from '../core/axis';\r\nimport Title from '../core/title';\r\nimport Legend from '../core/legend';\r\nimport AnimationHelper from '../helpers/animator';\r\nimport {colorSets} from '../constants/themes';\r\nimport {isDebugMode, defaultOptions} from '../constants/options';\r\n// import {inherits} from 'util';\r\n\r\nimport {\r\n\taddEvent,\r\n\tsetCanvasSize,\r\n\taddArrayIndexOf,\r\n\thide,\r\n\tshow,\r\n\tgetMouseCoordinates,\r\n\tgetProperty,\r\n\tisCanvasSupported,\r\n\textend,\r\n\tcreateCanvas,\r\n\textendCtx,\r\n\tgetObjectId,\r\n\tgetDevicePixelBackingStoreRatio,\r\n\ttrimString,\r\n\tnumberFormat,\r\n\tgetLineDashArray,\r\n\tintToHexColorString,\r\n\tcompareDataPointX\r\n} from '../helpers/utils';\r\n\r\nimport {\r\n\tSplineChart,\r\n\tColumnChart,\r\n\tStackedColumnChart,\r\n\tStackedColumn100Chart,\r\n\tBarChart,\r\n\tStackedBarChart,\r\n\tStackedBar100Chart,\r\n\tAreaChart,\r\n\tSplineAreaChart,\r\n\tStepAreaChart,\r\n\tStackedAreaChart,\r\n\tStackedArea100Chart,\r\n\tBubbleChart,\r\n\tScatterChart,\r\n\tCandlestickChart,\r\n\tRangeColumnChart,\r\n\tRangeBarChart,\r\n\tRangeAreaChart,\r\n\tRangeSplineAreaChart,\r\n\tPieChart\r\n} from '../charts/index';\r\n\r\nvar devicePixelBackingStoreRatio = getDevicePixelBackingStoreRatio();\r\n\r\nfunction Chart(containerId, options, publicChartReference) {\r\n\r\n\tthis._publicChartReference = publicChartReference;\r\n\r\n\toptions = options || {};\r\n\r\n\tChart.base.constructor.call(this, \"Chart\", options, options.theme ? options.theme : \"theme1\");\r\n\r\n\tvar _this = this;\r\n\r\n\tthis._containerId = containerId;\r\n\tthis._objectsInitialized = false;\r\n\tthis.ctx = null;\r\n\tthis.overlaidCanvasCtx = null;\r\n\tthis._indexLabels = [];\r\n\tthis._panTimerId = 0;\r\n\tthis._lastTouchEventType = \"\";\r\n\tthis._lastTouchData = null;\r\n\tthis.isAnimating = false;\r\n\tthis.renderCount = 0;\r\n\tthis.animatedRender = false;\r\n\tthis.disableToolTip = false;\r\n\r\n\r\n\tthis.panEnabled = false;\r\n\tthis._defaultCursor = \"default\";\r\n\tthis.plotArea = { canvas: null, ctx: null, x1: 0, y1: 0, x2: 0, y2: 0, width: 0, height: 0 };\r\n\tthis._dataInRenderedOrder = [];\r\n\r\n\tthis._container = typeof (this._containerId) === \"string\" ? document.getElementById(this._containerId) : this._containerId;\r\n\r\n\tif (!this._container) {\r\n\t\tif (window.console)\r\n\t\t\twindow.console.log(\"CanvasJS Error: Chart Container with id \\\"\" + this._containerId + \"\\\" was not found\");\r\n\t\treturn;\r\n\t}\r\n\r\n\tthis._container.innerHTML = \"\";\r\n\r\n\tvar width = 0;\r\n\tvar height = 0;\r\n\r\n\tif (this._options.width)\r\n\t\twidth = this.width;\r\n\telse\r\n\t\twidth = this._container.clientWidth > 0 ? this._container.clientWidth : this.width;\r\n\r\n\tif (this._options.height)\r\n\t\theight = this.height;\r\n\telse\r\n\t\theight = this._container.clientHeight > 0 ? this._container.clientHeight : this.height;\r\n\r\n\tthis.width = width;\r\n\tthis.height = height;\r\n\r\n\tthis.x1 = this.y1 = 0;\r\n\tthis.x2 = this.width;\r\n\tthis.y2 = this.height;\r\n\r\n\r\n\tthis._selectedColorSet = typeof (colorSets[this.colorSet]) !== \"undefined\" ? colorSets[this.colorSet] : colorSets[\"colorSet1\"];\r\n\r\n\tthis._canvasJSContainer = document.createElement(\"div\");\r\n\tthis._canvasJSContainer.setAttribute(\"class\", \"canvasjs-chart-container\");\r\n\r\n\tthis._canvasJSContainer.style.position = \"relative\";\r\n\tthis._canvasJSContainer.style.textAlign = \"left\";\r\n\tthis._canvasJSContainer.style.cursor = \"auto\";\r\n\r\n\tif (!isCanvasSupported) {\r\n\t\tthis._canvasJSContainer.style.height = \"0px\";//In IE6 toolTip doesn't show at proper position if not set.\r\n\t}\r\n\tthis._container.appendChild(this._canvasJSContainer);\r\n\r\n\r\n\tthis.canvas = createCanvas(width, height);\r\n\r\n\tthis.canvas.style.position = \"absolute\";\r\n\tif (this.canvas.getContext) {\r\n\t\t//try {\r\n\t\t//\tthis.canvas.style.background = this.backgroundColor;\r\n\t\t//} catch (e) { }\r\n\t\tthis._canvasJSContainer.appendChild(this.canvas);\r\n\t\tthis.ctx = this.canvas.getContext(\"2d\");\r\n\t\tthis.ctx.textBaseline = \"top\";\r\n\t\textendCtx(this.ctx);\r\n\r\n\t} else return;\r\n\r\n\t//this.canvas.style.cursor = \"pointer\";\r\n\r\n\tif (!isCanvasSupported) {\r\n\t\tthis.plotArea.canvas = createCanvas(width, height);\r\n\t\tthis.plotArea.canvas.style.position = \"absolute\";\r\n\t\tthis.plotArea.canvas.setAttribute(\"class\", \"plotAreaCanvas\");\r\n\t\tthis._canvasJSContainer.appendChild(this.plotArea.canvas);\r\n\r\n\t\tthis.plotArea.ctx = this.plotArea.canvas.getContext(\"2d\");\r\n\t} else {\r\n\t\tthis.plotArea.ctx = this.ctx;\r\n\t}\r\n\r\n\tthis.overlaidCanvas = createCanvas(width, height);\r\n\tthis.overlaidCanvas.style.position = \"absolute\";\r\n\tthis._canvasJSContainer.appendChild(this.overlaidCanvas);\r\n\tthis.overlaidCanvasCtx = this.overlaidCanvas.getContext(\"2d\");\r\n\tthis.overlaidCanvasCtx.textBaseline = \"top\";\r\n\r\n\tthis._eventManager = new EventManager(this);\r\n\r\n\taddEvent(window, \"resize\", function () {\r\n\t\t//this._container.addEventListener(\"DOMSubtreeModified\", function () {\r\n\r\n\t\tif (_this._updateSize())\r\n\t\t\t_this.render();\r\n\t});\r\n\r\n\r\n\tthis._toolBar = document.createElement(\"div\");\r\n\tthis._toolBar.setAttribute(\"class\", \"canvasjs-chart-toolbar\");\r\n\tthis._toolBar.style.cssText = \"position: absolute; right: 1px; top: 1px;\";\r\n\tthis._canvasJSContainer.appendChild(this._toolBar);\r\n\r\n\r\n\tthis.bounds = { x1: 0, y1: 0, x2: this.width, y2: this.height };\r\n\r\n\taddEvent(this.overlaidCanvas, 'click', function (e) {\r\n\t\t_this._mouseEventHandler(e);\r\n\t});\r\n\r\n\taddEvent(this.overlaidCanvas, 'mousemove', function (e) {\r\n\t\t_this._mouseEventHandler(e);\r\n\t});\r\n\r\n\taddEvent(this.overlaidCanvas, 'mouseup', function (e) {\r\n\t\t_this._mouseEventHandler(e);\r\n\t});\r\n\r\n\taddEvent(this.overlaidCanvas, 'mousedown', function (e) {\r\n\t\t_this._mouseEventHandler(e);\r\n\t\thide(_this._dropdownMenu);\r\n\t});\r\n\r\n\taddEvent(this.overlaidCanvas, 'mouseout', function (e) {\r\n\t\t_this._mouseEventHandler(e);\r\n\t});\r\n\r\n\r\n\taddEvent(this.overlaidCanvas, window.navigator.msPointerEnabled ? \"MSPointerDown\" : \"touchstart\", function (e) {\r\n\t\t_this._touchEventHandler(e);\r\n\t});\r\n\r\n\taddEvent(this.overlaidCanvas, window.navigator.msPointerEnabled ? \"MSPointerMove\" : 'touchmove', function (e) {\r\n\t\t_this._touchEventHandler(e);\r\n\t});\r\n\r\n\taddEvent(this.overlaidCanvas, window.navigator.msPointerEnabled ? \"MSPointerUp\" : 'touchend', function (e) {\r\n\t\t_this._touchEventHandler(e);\r\n\t});\r\n\r\n\taddEvent(this.overlaidCanvas, window.navigator.msPointerEnabled ? \"MSPointerCancel\" : 'touchcancel', function (e) {\r\n\t\t_this._touchEventHandler(e);\r\n\t});\r\n\r\n\tif (!this._creditLink) {\r\n\r\n\t\tthis._creditLink = document.createElement(\"a\");\r\n\t\tthis._creditLink.setAttribute(\"class\", \"canvasjs-chart-credit\");\r\n\t\tthis._creditLink.setAttribute(\"style\", \"outline:none;margin:0px;position:absolute;right:3px;top:\" + (this.height - 14) + \"px;color:dimgrey;text-decoration:none;font-size:10px;font-family:Lucida Grande, Lucida Sans Unicode, Arial, sans-serif\");\r\n\r\n\t\tthis._creditLink.setAttribute(\"tabIndex\", -1);\r\n\r\n\t\tthis._creditLink.setAttribute(\"target\", \"_blank\");\r\n\t}\r\n\r\n\tthis._toolTip = new ToolTip(this, this._options.toolTip, this.theme);\r\n\r\n\tthis.data = null;\r\n\tthis.axisX = null;\r\n\tthis.axisY = null;\r\n\tthis.axisY2 = null;\r\n\r\n\tthis.sessionVariables = {\r\n\t\taxisX: {},\r\n\t\taxisY: {},\r\n\t\taxisY2: {}\r\n\t};\r\n}\r\n\r\nextend(Chart, CanvasJSObject);\r\n\r\n//Update Chart Properties\r\nChart.prototype._updateOptions = function () {\r\n\r\n\tvar _this = this;\r\n\r\n\tthis.updateOption(\"width\");\r\n\tthis.updateOption(\"height\");\r\n\tthis.updateOption(\"dataPointMaxWidth\");\r\n\tthis.updateOption(\"interactivityEnabled\");\r\n\tthis.updateOption(\"theme\");\r\n\r\n\tif (this.updateOption(\"colorSet\"))\r\n\t\tthis._selectedColorSet = typeof (colorSets[this.colorSet]) !== \"undefined\" ? colorSets[this.colorSet] : colorSets[\"colorSet1\"];\r\n\r\n\tthis.updateOption(\"backgroundColor\");\r\n\tif (!this.backgroundColor)\r\n\t\tthis.backgroundColor = \"rgba(0,0,0,0)\";\r\n\r\n\tthis.updateOption(\"culture\");\r\n\tthis._cultureInfo = new CultureInfo(this._options.culture);\r\n\r\n\tthis.updateOption(\"animationEnabled\");\r\n\tthis.animationEnabled = this.animationEnabled && isCanvasSupported;\r\n\tthis.updateOption(\"animationDuration\");\r\n\r\n\tthis.updateOption(\"rangeChanging\");\r\n\tthis.updateOption(\"rangeChanged\");\r\n\r\n\t//Need to check this._options.zoomEnabled because this.zoomEnabled is used internally to keep track of state - and hence changes.\r\n\tif (this._options.zoomEnabled) {\r\n\r\n\t\tif (!this._zoomButton) {\r\n\r\n\t\t\thide(this._zoomButton = document.createElement(\"button\"));\r\n\r\n\t\t\tsetButtonState(this, this._zoomButton, \"pan\");\r\n\r\n\t\t\tthis._toolBar.appendChild(this._zoomButton);\r\n\t\t\taddEvent(this._zoomButton, \"click\", function () {\r\n\t\t\t\tif (_this.zoomEnabled) {\r\n\t\t\t\t\t_this.zoomEnabled = false;\r\n\t\t\t\t\t_this.panEnabled = true;\r\n\r\n\t\t\t\t\tsetButtonState(_this, _this._zoomButton, \"zoom\");\r\n\r\n\t\t\t\t} else {\r\n\t\t\t\t\t_this.zoomEnabled = true;\r\n\t\t\t\t\t_this.panEnabled = false;\r\n\r\n\t\t\t\t\tsetButtonState(_this, _this._zoomButton, \"pan\");\r\n\t\t\t\t}\r\n\r\n\t\t\t\t_this.render();\r\n\t\t\t});\r\n\t\t}\r\n\r\n\r\n\t\tif (!this._resetButton) {\r\n\t\t\thide(this._resetButton = document.createElement(\"button\"));\r\n\t\t\tsetButtonState(this, this._resetButton, \"reset\");\r\n\t\t\tthis._toolBar.appendChild(this._resetButton);\r\n\r\n\t\t\taddEvent(this._resetButton, \"click\", function () {\r\n\r\n\t\t\t\t_this._toolTip.hide();\r\n\r\n\t\t\t\tif (_this.zoomEnabled || _this.panEnabled) {\r\n\t\t\t\t\t_this.zoomEnabled = true;\r\n\t\t\t\t\t_this.panEnabled = false;\r\n\t\t\t\t\tsetButtonState(_this, _this._zoomButton, \"pan\");\r\n\r\n\t\t\t\t\t_this._defaultCursor = \"default\";\r\n\t\t\t\t\t_this.overlaidCanvas.style.cursor = _this._defaultCursor;\r\n\t\t\t\t} else {\r\n\t\t\t\t\t_this.zoomEnabled = false;\r\n\t\t\t\t\t_this.panEnabled = false;\r\n\t\t\t\t}\r\n\t\t\t\t//Reset axisX\r\n\t\t\t\tif (_this.sessionVariables.axisX) {\r\n\t\t\t\t\t_this.sessionVariables.axisX.newViewportMinimum = null;\r\n\t\t\t\t\t_this.sessionVariables.axisX.newViewportMaximum = null;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t//Reset axisY\r\n\t\t\t\tif (_this.sessionVariables.axisY) {\r\n\t\t\t\t\t_this.sessionVariables.axisY.newViewportMinimum = null;\r\n\t\t\t\t\t_this.sessionVariables.axisY.newViewportMaximum = null;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t//Reset axisY2\r\n\t\t\t\tif (_this.sessionVariables.axisY2) {\r\n\t\t\t\t\t_this.sessionVariables.axisY2.newViewportMinimum = null;\r\n\t\t\t\t\t_this.sessionVariables.axisY2.newViewportMaximum = null;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t_this.resetOverlayedCanvas();\r\n\r\n\t\t\t\thide(_this._zoomButton, _this._resetButton);\r\n\r\n\t\t\t\t_this._dispatchRangeEvent(\"rangeChanging\", \"reset\");\r\n\t\t\t\t_this.render();\r\n\t\t\t\t_this._dispatchRangeEvent(\"rangeChanged\", \"reset\");\r\n\t\t\t});\r\n\r\n\t\t\tthis.overlaidCanvas.style.cursor = _this._defaultCursor;\r\n\t\t}\r\n\r\n\t\tif (!this.zoomEnabled && !this.panEnabled) {\r\n\t\t\tif (!this._zoomButton) {\r\n\t\t\t\tthis.zoomEnabled = true;\r\n\t\t\t\tthis.panEnabled = false;\r\n\t\t\t} else {\r\n\r\n\t\t\t\tif (_this._zoomButton.getAttribute(\"state\") === _this._cultureInfo.zoomText) {\r\n\t\t\t\t\tthis.panEnabled = true;\r\n\t\t\t\t\tthis.zoomEnabled = false;\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tthis.zoomEnabled = true;\r\n\t\t\t\t\tthis.panEnabled = false;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tshow(_this._zoomButton, _this._resetButton);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\r\n\r\n\t} else {\r\n\t\tthis.zoomEnabled = false;\r\n\t\tthis.panEnabled = false;\r\n\t}\r\n\r\n\r\n\r\n\tif (this._menuButton) {\r\n\t\tif (this.exportEnabled)\r\n\t\t\tshow(this._menuButton);\r\n\t\telse\r\n\t\t\thide(this._menuButton);\r\n\t} else if (this.exportEnabled && isCanvasSupported) {\r\n\t\tthis._menuButton = document.createElement(\"button\");\r\n\t\tsetButtonState(this, this._menuButton, \"menu\");\r\n\t\tthis._toolBar.appendChild(this._menuButton);\r\n\r\n\t\taddEvent(this._menuButton, \"click\", function () {\r\n\t\t\tif (_this._dropdownMenu.style.display === \"none\") {\r\n\r\n\t\t\t\tif (_this._dropDownCloseTime && ((new Date()).getTime() - _this._dropDownCloseTime.getTime() <= 500))\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\t_this._dropdownMenu.style.display = \"block\";\r\n\t\t\t\t_this._menuButton.blur();\r\n\t\t\t\t_this._dropdownMenu.focus();\r\n\t\t\t}\r\n\r\n\t\t}, true);\r\n\t}\r\n\r\n\r\n\tif (!this._dropdownMenu && this.exportEnabled && isCanvasSupported) {\r\n\t\tthis._dropdownMenu = document.createElement(\"div\");\r\n\t\tthis._dropdownMenu.setAttribute(\"tabindex\", -1);\r\n\t\tthis._dropdownMenu.style.cssText = \"position: absolute; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; cursor: pointer;right: 1px;top: 25px;min-width: 120px;outline: 0;border: 1px solid silver;font-size: 14px;font-family: Calibri, Verdana, sans-serif;padding: 5px 0px 5px 0px;text-align: left;background-color: #fff;line-height: 20px;box-shadow: 2px 2px 10px #888888;\";\r\n\t\t_this._dropdownMenu.style.display = \"none\";\r\n\t\tthis._toolBar.appendChild(this._dropdownMenu);\r\n\r\n\t\taddEvent(this._dropdownMenu, \"blur\", function () {\r\n\t\t\thide(_this._dropdownMenu);\r\n\r\n\t\t\t_this._dropDownCloseTime = new Date();\r\n\t\t}, true);\r\n\r\n\t\tvar exportOption = document.createElement(\"div\");\r\n\t\texportOption.style.cssText = \"padding: 2px 15px 2px 10px\"\r\n\t\texportOption.innerHTML = this._cultureInfo.saveJPGText;\r\n\t\tthis._dropdownMenu.appendChild(exportOption);\r\n\r\n\t\taddEvent(exportOption, \"mouseover\", function () {\r\n\t\t\tthis.style.backgroundColor = \"#EEEEEE\";\r\n\t\t}, true);\r\n\r\n\t\taddEvent(exportOption, \"mouseout\", function () {\r\n\t\t\tthis.style.backgroundColor = \"transparent\";\r\n\t\t}, true);\r\n\r\n\t\taddEvent(exportOption, \"click\", function () {\r\n\t\t\texportCanvas(_this.canvas, \"jpg\", _this.exportFileName);\r\n\t\t\thide(_this._dropdownMenu);\r\n\t\t}, true);\r\n\r\n\t\tvar exportOption = document.createElement(\"div\");\r\n\t\texportOption.style.cssText = \"padding: 2px 15px 2px 10px\"\r\n\t\texportOption.innerHTML = this._cultureInfo.savePNGText;\r\n\t\tthis._dropdownMenu.appendChild(exportOption);\r\n\r\n\t\taddEvent(exportOption, \"mouseover\", function () {\r\n\t\t\tthis.style.backgroundColor = \"#EEEEEE\";\r\n\t\t}, true);\r\n\r\n\t\taddEvent(exportOption, \"mouseout\", function () {\r\n\t\t\tthis.style.backgroundColor = \"transparent\";\r\n\t\t}, true);\r\n\r\n\t\taddEvent(exportOption, \"click\", function () {\r\n\t\t\texportCanvas(_this.canvas, \"png\", _this.exportFileName);\r\n\t\t\thide(_this._dropdownMenu);\r\n\t\t}, true);\r\n\t}\r\n\r\n\r\n\tif (this._toolBar.style.display !== \"none\" && this._zoomButton) {\r\n\r\n\t\tthis.panEnabled ? setButtonState(_this, _this._zoomButton, \"zoom\") : setButtonState(_this, _this._zoomButton, \"pan\");\r\n\r\n\r\n\t\tif (_this._resetButton.getAttribute(\"state\") !== _this._cultureInfo.resetText)\r\n\t\t\tsetButtonState(_this, _this._resetButton, \"reset\");\r\n\t}\r\n\r\n\tif (typeof (defaultOptions.Chart.creditHref) === \"undefined\") {\r\n\t\tthis.creditHref = \"http://canvasjs.com/\";\r\n\t\tthis.creditText = \"CanvasJS.com\";\r\n\t} else {\r\n\t\tvar creditTextChanged = this.updateOption(\"creditText\");\r\n\t\tvar creditHrefChanged = this.updateOption(\"creditHref\");\r\n\t}\r\n\r\n\tif (this.renderCount === 0 || (creditTextChanged || creditHrefChanged)) {\r\n\t\tthis._creditLink.setAttribute(\"href\", this.creditHref);\r\n\t\tthis._creditLink.innerHTML = this.creditText;\r\n\t}\r\n\r\n\tif (this.creditHref && this.creditText) {\r\n\t\tif (!this._creditLink.parentElement)\r\n\t\t\tthis._canvasJSContainer.appendChild(this._creditLink);\r\n\t}\r\n\telse if (this._creditLink.parentElement)\r\n\t\tthis._canvasJSContainer.removeChild(this._creditLink);\r\n\r\n\tif (this._options.toolTip && this._toolTip._options !== this._options.toolTip)\r\n\t\tthis._toolTip._options = this._options.toolTip\r\n\r\n\tfor (var prop in this._toolTip._options) {\r\n\r\n\t\tif (this._toolTip._options.hasOwnProperty(prop)) {\r\n\t\t\tthis._toolTip.updateOption(prop);\r\n\t\t}\r\n\t}\r\n\r\n}\r\n\r\nChart.prototype._updateSize = function () {\r\n\tvar width = 0;\r\n\tvar height = 0;\r\n\r\n\tif (this._options.width)\r\n\t\twidth = this.width;\r\n\telse\r\n\t\tthis.width = width = this._container.clientWidth > 0 ? this._container.clientWidth : this.width;\r\n\r\n\tif (this._options.height)\r\n\t\theight = this.height;\r\n\telse\r\n\t\tthis.height = height = this._container.clientHeight > 0 ? this._container.clientHeight : this.height;\r\n\r\n\tif (this.canvas.width !== width * devicePixelBackingStoreRatio || this.canvas.height !== height * devicePixelBackingStoreRatio) {\r\n\t\tsetCanvasSize(this.canvas, width, height);\r\n\r\n\t\tsetCanvasSize(this.overlaidCanvas, width, height);\r\n\t\tsetCanvasSize(this._eventManager.ghostCanvas, width, height);\r\n\r\n\t\treturn true;\r\n\t}\r\n\r\n\treturn false;\r\n}\r\n\r\n// initialize chart objects\r\nChart.prototype._initialize = function () {\r\n\t///<signature>\r\n\t///<summary>Initializes Chart objects/state. Creates DataSeries class instance for each DataSeries provided by ther user. Sets the Axis Type based on the user data</summary>\r\n\t///</signature>\r\n\t//this.width = this.width;\r\n\r\n\tif (!this._animator)\r\n\t\tthis._animator = new Animator(this);\r\n\telse {\r\n\t\tthis._animator.cancelAllAnimations();\r\n\t}\r\n\r\n\tthis.removeAllEventListeners();\r\n\r\n\tthis.disableToolTip = false;\r\n\r\n\tthis._axes = [];\r\n\r\n\tthis.pieDoughnutClickHandler = null;\r\n\t//this._touchCurrentCoordinates = null;\r\n\r\n\tif (this.animationRequestId)\r\n\t\tthis.cancelRequestAnimFrame.call(window, this.animationRequestId);\r\n\r\n\tthis._updateOptions();\r\n\r\n\tthis.animatedRender = isCanvasSupported && this.animationEnabled && (this.renderCount === 0);\r\n\r\n\tthis._updateSize();\r\n\r\n\t//this._selectedColorSet = colorSets[\"colorSet2\"];\r\n\r\n\t//this.ctx.clearRect(0, 0, this.width, this.height);\r\n\tthis.clearCanvas();\r\n\tthis.ctx.beginPath();\r\n\r\n\tthis.axisX = null;\r\n\tthis.axisY = null;\r\n\tthis.axisY2 = null;\r\n\tthis._indexLabels = [];\r\n\tthis._dataInRenderedOrder = [];\r\n\r\n\tthis._events = [];\r\n\tif (this._eventManager)\r\n\t\tthis._eventManager.reset();\r\n\r\n\tthis.plotInfo = {\r\n\t\taxisPlacement: null,\r\n\t\taxisXValueType: null,\r\n\t\tplotTypes: []//array of plotType: {type:\"\", axisYType: \"primary\", dataSeriesIndexes:[]}\r\n\t};\r\n\r\n\tthis.layoutManager = new LayoutManager(0, 0, this.width, this.height, 2);\r\n\r\n\tif (this.plotArea.layoutManager)\r\n\t\tthis.plotArea.layoutManager.reset();\r\n\r\n\r\n\tthis.data = [];\r\n\tvar dataSeriesIndex = 0;\r\n\r\n\tfor (var series = 0; series < this._options.data.length; series++) {\r\n\t\t//for (series in this._options.data) {\r\n\r\n\t\tdataSeriesIndex++;\r\n\r\n\t\tif (!(!this._options.data[series].type || Chart._supportedChartTypes.indexOf(this._options.data[series].type) >= 0))\r\n\t\t\tcontinue;\r\n\r\n\t\tvar dataSeries = new DataSeries(this, this._options.data[series], this.theme, dataSeriesIndex - 1, ++this._eventManager.lastObjectId);\r\n\t\tif (dataSeries.name === null)\r\n\t\t\tdataSeries.name = \"DataSeries \" + (dataSeriesIndex);\r\n\r\n\t\tif (dataSeries.color === null) {\r\n\t\t\tif (this._options.data.length > 1) {\r\n\t\t\t\tdataSeries._colorSet = [this._selectedColorSet[dataSeries.index % this._selectedColorSet.length]];\r\n\t\t\t\tdataSeries.color = this._selectedColorSet[dataSeries.index % this._selectedColorSet.length];\r\n\t\t\t} else {\r\n\t\t\t\tif (dataSeries.type === \"line\" || dataSeries.type === \"stepLine\" || dataSeries.type === \"spline\" || dataSeries.type === \"area\"\r\n\t\t\t\t\t|| dataSeries.type === \"stepArea\" || dataSeries.type === \"splineArea\" || dataSeries.type === \"stackedArea\" || dataSeries.type === \"stackedArea100\"\r\n\t\t\t\t\t|| dataSeries.type === \"rangeArea\" || dataSeries.type === \"rangeSplineArea\" || dataSeries.type === \"candlestick\" || dataSeries.type === \"ohlc\") {\r\n\t\t\t\t\tdataSeries._colorSet = [this._selectedColorSet[0]];\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t\tdataSeries._colorSet = this._selectedColorSet;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tdataSeries._colorSet = [dataSeries.color];\r\n\t\t}\r\n\r\n\t\tif (dataSeries.markerSize === null) {\r\n\t\t\tif (((dataSeries.type === \"line\" || dataSeries.type === \"stepLine\" || dataSeries.type === \"spline\") && dataSeries.dataPoints && dataSeries.dataPoints.length < this.width / 16) || dataSeries.type === \"scatter\") {\r\n\t\t\t\t//if (dataSeries.type === \"line\") {\r\n\t\t\t\tdataSeries.markerSize = 8;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif ((dataSeries.type === \"bubble\" || dataSeries.type === \"scatter\") && dataSeries.dataPoints) {\r\n\t\t\tdataSeries.dataPoints.sort(compareDataPointX)\r\n\t\t}\r\n\r\n\t\t//if (dataSeries.markerBorderThickness === null && dataSeries.type === \"scatter\") {\r\n\t\t//    dataSeries.markerBorderThickness = 2;\r\n\t\t//}\r\n\r\n\t\t//if (dataSeries.markerType === null) {\r\n\t\t//    if (dataSeries.type === \"line\" & dataSeries.dataPoints.length < 500) {\r\n\t\t//        dataSeries.markerType = \"circle\";\r\n\t\t//    }\r\n\t\t//}\r\n\r\n\t\tthis.data.push(dataSeries);\r\n\r\n\t\tvar seriesAxisPlacement = dataSeries.axisPlacement;\r\n\r\n\t\t//if (isDebugMode && window.console)\r\n\t\t//    window.console.log(dataSeries.type);\r\n\r\n\t\tvar errorMessage;\r\n\r\n\t\tif (seriesAxisPlacement === \"normal\") {\r\n\r\n\t\t\tif (this.plotInfo.axisPlacement === \"xySwapped\") {\r\n\t\t\t\terrorMessage = \"You cannot combine \\\"\" + dataSeries.type + \"\\\" with bar chart\";\r\n\t\t\t} else if (this.plotInfo.axisPlacement === \"none\") {\r\n\t\t\t\terrorMessage = \"You cannot combine \\\"\" + dataSeries.type + \"\\\" with pie chart\";\r\n\t\t\t} else if (this.plotInfo.axisPlacement === null)\r\n\t\t\t\tthis.plotInfo.axisPlacement = \"normal\";\r\n\t\t}\r\n\t\telse if (seriesAxisPlacement === \"xySwapped\") {\r\n\r\n\t\t\tif (this.plotInfo.axisPlacement === \"normal\") {\r\n\t\t\t\terrorMessage = \"You cannot combine \\\"\" + dataSeries.type + \"\\\" with line, area, column or pie chart\";\r\n\t\t\t} else if (this.plotInfo.axisPlacement === \"none\") {\r\n\t\t\t\terrorMessage = \"You cannot combine \\\"\" + dataSeries.type + \"\\\" with pie chart\";\r\n\t\t\t} else if (this.plotInfo.axisPlacement === null)\r\n\t\t\t\tthis.plotInfo.axisPlacement = \"xySwapped\";\r\n\t\t}\r\n\t\telse if (seriesAxisPlacement == \"none\") {\r\n\r\n\t\t\tif (this.plotInfo.axisPlacement === \"normal\") {\r\n\t\t\t\terrorMessage = \"You cannot combine \\\"\" + dataSeries.type + \"\\\" with line, area, column or bar chart\";\r\n\t\t\t} else if (this.plotInfo.axisPlacement === \"xySwapped\") {\r\n\t\t\t\terrorMessage = \"You cannot combine \\\"\" + dataSeries.type + \"\\\" with bar chart\";\r\n\t\t\t} else if (this.plotInfo.axisPlacement === null)\r\n\t\t\t\tthis.plotInfo.axisPlacement = \"none\";\r\n\t\t}\r\n\r\n\t\tif (errorMessage && window.console) {\r\n\t\t\twindow.console.log(errorMessage);\r\n\t\t\treturn;\r\n\t\t}\r\n\t}\r\n\r\n\t//if (isDebugMode && window.console) {\r\n\t//    window.console.log(\"xMin: \" + this.plotInfo.viewPortXMin + \"; xMax: \" + this.plotInfo.viewPortXMax + \"; yMin: \" + this.plotInfo.yMin + \"; yMax: \" + this.plotInfo.yMax);\r\n\t//}\r\n\r\n\tthis._objectsInitialized = true;\r\n}\r\n\r\n//indexOf is not supported in IE8-\r\nChart._supportedChartTypes = addArrayIndexOf([\"line\", \"stepLine\", \"spline\", \"column\", \"area\", \"stepArea\", \"splineArea\", \"bar\", \"bubble\", \"scatter\",\r\n\t\"stackedColumn\", \"stackedColumn100\", \"stackedBar\", \"stackedBar100\",\r\n\t\"stackedArea\", \"stackedArea100\",\r\n\t\"candlestick\",\r\n\t\"ohlc\",\r\n\t\"rangeColumn\",\r\n\t\"rangeBar\",\r\n\t\"rangeArea\",\r\n\t\"rangeSplineArea\",\r\n\t\"pie\", \"doughnut\", \"funnel\"\r\n]);\r\n\r\nChart.prototype.render = function (options) {\r\n\r\n\tif (options)\r\n\t\tthis._options = options;\r\n\r\n\tthis._initialize();\r\n\tvar plotAreaElements = []; //Elements to be rendered inside the plotArea\r\n\r\n\t//Create Primary and Secondary axis and assign them to the series\r\n\tfor (var i = 0; i < this.data.length; i++) {\r\n\r\n\t\tif (this.plotInfo.axisPlacement === \"normal\" || this.plotInfo.axisPlacement === \"xySwapped\") {\r\n\t\t\tif (!this.data[i].axisYType || this.data[i].axisYType === \"primary\") {\r\n\t\t\t\tif (!this.axisY) {\r\n\r\n\t\t\t\t\tif (this.plotInfo.axisPlacement === \"normal\") {\r\n\t\t\t\t\t\tthis._axes.push(this.axisY = new Axis(this, this._options.axisY, \"axisY\", \"left\"));\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (this.plotInfo.axisPlacement === \"xySwapped\") {\r\n\t\t\t\t\t\tthis._axes.push(this.axisY = new Axis(this, this._options.axisY, \"axisY\", \"bottom\"));\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tthis.data[i].axisY = this.axisY;\r\n\t\t\t}\r\n\t\t\telse if (this.data[i].axisYType === \"secondary\") {\r\n\t\t\t\tif (!this.axisY2) {\r\n\t\t\t\t\tif (this.plotInfo.axisPlacement === \"normal\") {\r\n\t\t\t\t\t\tthis._axes.push(this.axisY2 = new Axis(this, this._options.axisY2, \"axisY\", \"right\"));\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (this.plotInfo.axisPlacement === \"xySwapped\") {\r\n\t\t\t\t\t\tthis._axes.push(this.axisY2 = new Axis(this, this._options.axisY2, \"axisY\", \"top\"));\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tthis.data[i].axisY = this.axisY2;\r\n\t\t\t}\r\n\r\n\t\t\tif (!this.axisX) {\r\n\t\t\t\tif (this.plotInfo.axisPlacement === \"normal\") {\r\n\t\t\t\t\tthis._axes.push(this.axisX = new Axis(this, this._options.axisX, \"axisX\", \"bottom\"));\r\n\t\t\t\t} else if (this.plotInfo.axisPlacement === \"xySwapped\") {\r\n\t\t\t\t\tthis._axes.push(this.axisX = new Axis(this, this._options.axisX, \"axisX\", \"left\"));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tthis.data[i].axisX = this.axisX;\r\n\t\t}\r\n\t}\r\n\r\n\t//If Both Primary and Secondary axis are present, disable gridlines for one of them unless the user has set value for both\r\n\tif (this.axisY && this.axisY2) {\r\n\t\tif (this.axisY.gridThickness > 0 && typeof (this.axisY2._options.gridThickness) === \"undefined\")\r\n\t\t\tthis.axisY2.gridThickness = 0;\r\n\t\telse if (this.axisY2.gridThickness > 0 && typeof (this.axisY._options.gridThickness) === \"undefined\")\r\n\t\t\tthis.axisY.gridThickness = 0;\r\n\t}\r\n\r\n\r\n\t//Show toolBar when viewportMinimum/viewportMaximum are set\r\n\tvar showToolBar = false;\r\n\tif (this._axes.length > 0 && (this.zoomEnabled || this.panEnabled)) {\r\n\t\tfor (var i = 0; i < this._axes.length; i++) {\r\n\t\t\tif (this._axes[i].viewportMinimum !== null || this._axes[i].viewportMaximum !== null) {\r\n\t\t\t\tshowToolBar = true;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tif (showToolBar) {\r\n\t\tshow(this._zoomButton, this._resetButton);\r\n\t} else {\r\n\t\thide(this._zoomButton, this._resetButton);\r\n\t}\r\n\r\n\r\n\tthis._processData();// Categorises the dataSeries and calculates min, max and other values\r\n\r\n\tif (this._options.title) {\r\n\t\tthis._title = new Title(this, this._options.title);\r\n\r\n\t\tif (!this._title.dockInsidePlotArea)\r\n\t\t\tthis._title.render();\r\n\t\telse\r\n\t\t\tplotAreaElements.push(this._title);\r\n\t}\r\n\r\n\tif (this._options.subtitles) {\r\n\t\tfor (var i = 0; i < this._options.subtitles.length; i++) {\r\n\r\n\t\t\tthis.subtitles = [];\r\n\r\n\t\t\tvar subtitle = new Subtitle(this, this._options.subtitles[i]);\r\n\t\t\tthis.subtitles.push(subtitle);\r\n\r\n\t\t\tif (!subtitle.dockInsidePlotArea)\r\n\t\t\t\tsubtitle.render();\r\n\t\t\telse\r\n\t\t\t\tplotAreaElements.push(subtitle);\r\n\t\t}\r\n\t}\r\n\r\n\tthis.legend = new Legend(this, this._options.legend, this.theme);\r\n\tfor (var i = 0; i < this.data.length; i++) {\r\n\t\tif (this.data[i].showInLegend || this.data[i].type === \"pie\" || this.data[i].type === \"doughnut\") {\r\n\t\t\tthis.legend.dataSeries.push(this.data[i]);\r\n\t\t}\r\n\t}\r\n\r\n\tif (!this.legend.dockInsidePlotArea)\r\n\t\tthis.legend.render();\r\n\telse\r\n\t\tplotAreaElements.push(this.legend);\r\n\r\n\t//TBI: Revisit and check if the functionality is enough.\r\n\tif (this.plotInfo.axisPlacement === \"normal\" || this.plotInfo.axisPlacement === \"xySwapped\") {\r\n\r\n\t\t//var freeSpace = this.layoutManager.getFreeSpace();\r\n\r\n\t\tAxis.setLayoutAndRender(this.axisX, this.axisY, this.axisY2, this.plotInfo.axisPlacement, this.layoutManager.getFreeSpace());\r\n\t} else if (this.plotInfo.axisPlacement === \"none\") {\r\n\t\t//In case of charts with axis this method is called inside setLayoutAndRender\r\n\t\tthis.preparePlotArea();\r\n\t}\r\n\telse {\r\n\t\treturn;\r\n\t}\r\n\r\n\tvar index = 0;\r\n\tfor (index in plotAreaElements) {\r\n\t\tif(plotAreaElements.hasOwnProperty(index))\r\n\t\tplotAreaElements[index].render();\r\n\t}\r\n\r\n\tvar animations = [];\r\n\tif (this.animatedRender) {\r\n\t\tvar initialState = createCanvas(this.width, this.height);\r\n\t\tvar initialStateCtx = initialState.getContext(\"2d\");\r\n\t\tinitialStateCtx.drawImage(this.canvas, 0, 0, this.width, this.height);\r\n\t}\r\n\r\n\tfor (var i = 0; i < this.plotInfo.plotTypes.length; i++) {\r\n\t\tvar plotType = this.plotInfo.plotTypes[i];\r\n\r\n\t\tfor (var j = 0; j < plotType.plotUnits.length; j++) {\r\n\r\n\t\t\tvar plotUnit = plotType.plotUnits[j];\r\n\t\t\tvar animationInfo = null;\r\n\r\n\t\t\tplotUnit.targetCanvas = null; //In case chart updates before the animation is complete, previous canvases need to be removed\r\n\r\n\t\t\tif (this.animatedRender) {\r\n\t\t\t\tplotUnit.targetCanvas = createCanvas(this.width, this.height);\r\n\t\t\t\tplotUnit.targetCanvasCtx = plotUnit.targetCanvas.getContext(\"2d\");\r\n\t\t\t}\r\n\r\n\t\t\tif (plotUnit.type === \"line\")\r\n\t\t\t\tanimationInfo = this.renderLine(plotUnit);\r\n\t\t\telse if (plotUnit.type === \"stepLine\")\r\n\t\t\t\tanimationInfo = this.renderStepLine(plotUnit);\r\n\t\t\telse if (plotUnit.type === \"spline\")\r\n\t\t\t\tanimationInfo = this.renderSpline(plotUnit);\r\n\t\t\telse if (plotUnit.type === \"column\")\r\n\t\t\t\tanimationInfo = this.renderColumn(plotUnit);\r\n\t\t\telse if (plotUnit.type === \"bar\")\r\n\t\t\t\tanimationInfo = this.renderBar(plotUnit);\r\n\t\t\telse if (plotUnit.type === \"area\")\r\n\t\t\t\tanimationInfo = this.renderArea(plotUnit);\r\n\t\t\telse if (plotUnit.type === \"stepArea\")\r\n\t\t\t\tanimationInfo = this.renderStepArea(plotUnit);\r\n\t\t\telse if (plotUnit.type === \"splineArea\")\r\n\t\t\t\tanimationInfo = this.renderSplineArea(plotUnit);\r\n\t\t\telse if (plotUnit.type === \"stackedColumn\")\r\n\t\t\t\tanimationInfo = this.renderStackedColumn(plotUnit);\r\n\t\t\telse if (plotUnit.type === \"stackedColumn100\")\r\n\t\t\t\tanimationInfo = this.renderStackedColumn100(plotUnit);\r\n\t\t\telse if (plotUnit.type === \"stackedBar\")\r\n\t\t\t\tanimationInfo = this.renderStackedBar(plotUnit);\r\n\t\t\telse if (plotUnit.type === \"stackedBar100\")\r\n\t\t\t\tanimationInfo = this.renderStackedBar100(plotUnit);\r\n\t\t\telse if (plotUnit.type === \"stackedArea\")\r\n\t\t\t\tanimationInfo = this.renderStackedArea(plotUnit);\r\n\t\t\telse if (plotUnit.type === \"stackedArea100\")\r\n\t\t\t\tanimationInfo = this.renderStackedArea100(plotUnit);\r\n\t\t\telse if (plotUnit.type === \"bubble\")\r\n\t\t\t\tanimationInfo = animationInfo = this.renderBubble(plotUnit);\r\n\t\t\telse if (plotUnit.type === \"scatter\")\r\n\t\t\t\tanimationInfo = this.renderScatter(plotUnit);\r\n\t\t\telse if (plotUnit.type === \"pie\")\r\n\t\t\t\tthis.renderPie(plotUnit);\r\n\t\t\telse if (plotUnit.type === \"doughnut\")\r\n\t\t\t\tthis.renderPie(plotUnit);\r\n\t\t\telse if (plotUnit.type === \"candlestick\")\r\n\t\t\t\tanimationInfo = this.renderCandlestick(plotUnit);\r\n\t\t\telse if (plotUnit.type === \"ohlc\")\r\n\t\t\t\tanimationInfo = this.renderCandlestick(plotUnit);\r\n\t\t\telse if (plotUnit.type === \"rangeColumn\")\r\n\t\t\t\tanimationInfo = this.renderRangeColumn(plotUnit);\r\n\t\t\telse if (plotUnit.type === \"rangeBar\")\r\n\t\t\t\tanimationInfo = this.renderRangeBar(plotUnit);\r\n\t\t\telse if (plotUnit.type === \"rangeArea\")\r\n\t\t\t\tanimationInfo = this.renderRangeArea(plotUnit);\r\n\t\t\telse if (plotUnit.type === \"rangeSplineArea\")\r\n\t\t\t\tanimationInfo = this.renderRangeSplineArea(plotUnit);\r\n\r\n\t\t\tfor (var k = 0; k < plotUnit.dataSeriesIndexes.length; k++) {\r\n\t\t\t\tthis._dataInRenderedOrder.push(this.data[plotUnit.dataSeriesIndexes[k]]);\r\n\t\t\t}\r\n\r\n\t\t\tif (this.animatedRender && animationInfo)\r\n\t\t\t\tanimations.push(animationInfo);\r\n\t\t}\r\n\t}\r\n\r\n\tif (this.animatedRender && this._indexLabels.length > 0) {\r\n\t\tvar indexLabelCanvas = createCanvas(this.width, this.height);\r\n\t\tvar indexLabelCanvasCtx = indexLabelCanvas.getContext(\"2d\");\r\n\t\tanimations.push(this.renderIndexLabels(indexLabelCanvasCtx));\r\n\t}\r\n\r\n\tvar _this = this;\r\n\r\n\tif (animations.length > 0) {\r\n\t\t//var animationCount = 0;\r\n\t\t_this.disableToolTip = true;\r\n\t\t_this._animator.animate(200, _this.animationDuration, function (fractionComplete) {\r\n\r\n\t\t\t//console.log(fractionComplete);\r\n\t\t\t//animationCount++;\r\n\r\n\t\t\t_this.ctx.clearRect(0, 0, _this.width, _this.height);\r\n\r\n\r\n\t\t\t//  _this.ctx.drawImage(initialState, 0, 0, _this.width * devicePixelBackingStoreRatio, _this.height * devicePixelBackingStoreRatio, 0, 0, _this.width, _this.height);\r\n\t\t\t_this.ctx.drawImage(initialState, 0, 0, Math.floor(_this.width * devicePixelBackingStoreRatio), Math.floor(_this.height * devicePixelBackingStoreRatio), 0, 0, _this.width, _this.height);\r\n\r\n\t\t\tfor (var l = 0; l < animations.length; l++) {\r\n\r\n\t\t\t\tanimationInfo = animations[l];\r\n\r\n\t\t\t\tif (fractionComplete < 1 && typeof (animationInfo.startTimePercent) !== \"undefined\") {\r\n\t\t\t\t\tif (fractionComplete >= animationInfo.startTimePercent) {\r\n\t\t\t\t\t\t//animationInfo.animationCallback(AnimationHelper.easing.linear(fractionComplete - animationInfo.startTimePercent, 0, 1, 1 - animationInfo.startTimePercent), animationInfo);\r\n\r\n\t\t\t\t\t\tanimationInfo.animationCallback(animationInfo.easingFunction(fractionComplete - animationInfo.startTimePercent, 0, 1, 1 - animationInfo.startTimePercent), animationInfo);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tanimationInfo.animationCallback(animationInfo.easingFunction(fractionComplete, 0, 1, 1), animationInfo);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t_this.dispatchEvent(\"dataAnimationIterationEnd\",\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tchart: _this\r\n\t\t\t\t\t\t\t\t});\r\n\r\n\t\t}, function () {\r\n\r\n\t\t\tanimations = [];\r\n\r\n\t\t\tvar count = 0;\r\n\r\n\t\t\t//Delete all render target canvases used for animation.\r\n\t\t\tfor (var i = 0; i < _this.plotInfo.plotTypes.length; i++) {\r\n\t\t\t\tvar plotType = _this.plotInfo.plotTypes[i];\r\n\r\n\t\t\t\tfor (var j = 0; j < plotType.plotUnits.length; j++) {\r\n\t\t\t\t\tvar plotUnit = plotType.plotUnits[j];\r\n\t\t\t\t\tplotUnit.targetCanvas = null;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tinitialState = null;\r\n\t\t\t_this.disableToolTip = false;\r\n\t\t\t//console.log(\"*********** Animation Complete - \" + animationCount + \" ***********\");\r\n\r\n\t\t});\r\n\t} else {\r\n\t\tif (_this._indexLabels.length > 0)\r\n\t\t\t_this.renderIndexLabels();\r\n\r\n\t\t_this.dispatchEvent(\"dataAnimationIterationEnd\",\r\n\t\t\t\t{\r\n\t\t\t\t\tchart: _this\r\n\t\t\t\t});\r\n\t}\r\n\r\n\tthis.attachPlotAreaEventHandlers();\r\n\r\n\tif (!this.zoomEnabled && !this.panEnabled && this._zoomButton && this._zoomButton.style.display !== \"none\") {\r\n\t\thide(this._zoomButton, this._resetButton);\r\n\t}\r\n\r\n\tthis._toolTip._updateToolTip();\r\n\r\n\tthis.renderCount++;\r\n\r\n\t//if (window.console) {\r\n\t//    window.console.log(new Date().getTime() - dt);\r\n\t//}\r\n\r\n\tif (isDebugMode) {\r\n\r\n\t\tvar _this = this;\r\n\t\tsetTimeout(function () {\r\n\t\t\tvar ghostCanvasCopy = document.getElementById(\"ghostCanvasCopy\");\r\n\r\n\t\t\tif (ghostCanvasCopy) {\r\n\t\t\t\t//console.log(ghostCanvasCopy.clientWidth);\r\n\t\t\t\tsetCanvasSize(ghostCanvasCopy, _this.width, _this.height);\r\n\t\t\t\tvar ghostCanvasCopyCtx = ghostCanvasCopy.getContext(\"2d\");\r\n\r\n\t\t\t\t//ghostCanvasCopyCtx.scale(1, 1);\r\n\t\t\t\t//var imageData = this._eventManager.ghostCtx.getImageData(0, 0, this._container.clientWidth, this._container.clientHeight);\r\n\t\t\t\t//this._eventManager.ghostCtx.drawImage(this._eventManager.ghostCanvas, 0, 0);\r\n\t\t\t\t//this.ctx.drawImage(this._eventManager.ghostCanvas, 0, 0);\r\n\r\n\t\t\t\tghostCanvasCopyCtx.drawImage(_this._eventManager.ghostCanvas, 0, 0);\r\n\t\t\t\t//_this._canvasJSContainer.appendChild(_this._eventManager.ghostCanvas);\r\n\t\t\t\t//_this.overlaidCanvasCtx.drawImage(_this._eventManager.ghostCanvas, 0, 0);\r\n\t\t\t}\r\n\t\t}, 2000);\r\n\t}\r\n}\r\n\r\nChart.prototype.attachPlotAreaEventHandlers = function () {\r\n\r\n\t//this._toolBar.style.display = \"inline\";\r\n\r\n\tthis.attachEvent({\r\n\t\tcontext: this,\r\n\t\tchart: this,\r\n\t\tmousedown: this._plotAreaMouseDown,\r\n\t\tmouseup: this._plotAreaMouseUp,\r\n\t\tmousemove: this._plotAreaMouseMove,\r\n\t\tcursor: this.zoomEnabled ? \"col-resize\" : \"move\",\r\n\t\tcursor: this.panEnabled ? \"move\" : \"default\",\r\n\t\tcapture: true,\r\n\t\tbounds: this.plotArea\r\n\t});\r\n\r\n}\r\n\r\nChart.prototype.categoriseDataSeries = function () {\r\n\tvar dataSeries = \"\";\r\n\r\n\tfor (var i = 0; i < this.data.length; i++) {\r\n\t\tdataSeries = this.data[i]\r\n\t\tif (!dataSeries.dataPoints || dataSeries.dataPoints.length === 0 || !dataSeries.visible)\r\n\t\t\tcontinue;\r\n\r\n\t\tif (Chart._supportedChartTypes.indexOf(dataSeries.type) >= 0) {\r\n\r\n\t\t\tvar plotType = null;\r\n\t\t\tvar plotTypeExists = false;\r\n\r\n\t\t\tvar plotUnit = null;\r\n\t\t\tvar plotUnitExists = false;\r\n\r\n\t\t\tfor (var j = 0; j < this.plotInfo.plotTypes.length; j++) {\r\n\t\t\t\tif (this.plotInfo.plotTypes[j].type === dataSeries.type) {\r\n\t\t\t\t\tplotTypeExists = true;\r\n\t\t\t\t\tvar plotType = this.plotInfo.plotTypes[j];\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (!plotTypeExists) {\r\n\t\t\t\tplotType = {\r\n\t\t\t\t\ttype: dataSeries.type,\r\n\t\t\t\t\ttotalDataSeries: 0,\r\n\t\t\t\t\tplotUnits: []\r\n\t\t\t\t};\r\n\t\t\t\tthis.plotInfo.plotTypes.push(plotType)\r\n\t\t\t}\r\n\r\n\t\t\tfor (var j = 0; j < plotType.plotUnits.length; j++) {\r\n\t\t\t\tif (plotType.plotUnits[j].axisYType === dataSeries.axisYType) {\r\n\t\t\t\t\tplotUnitExists = true;\r\n\t\t\t\t\tvar plotUnit = plotType.plotUnits[j];\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (!plotUnitExists) {\r\n\t\t\t\tplotUnit = {\r\n\t\t\t\t\ttype: dataSeries.type,\r\n\t\t\t\t\tpreviousDataSeriesCount: 0, //to be set next\r\n\t\t\t\t\tindex: plotType.plotUnits.length,\r\n\t\t\t\t\tplotType: plotType,\r\n\t\t\t\t\taxisYType: dataSeries.axisYType,\r\n\t\t\t\t\taxisY: dataSeries.axisYType === \"primary\" ? this.axisY : this.axisY2,\r\n\t\t\t\t\taxisX: this.axisX,\r\n\t\t\t\t\tdataSeriesIndexes: [], //index of dataSeries\r\n\t\t\t\t\tyTotals: []\r\n\t\t\t\t}\r\n\t\t\t\tplotType.plotUnits.push(plotUnit);\r\n\t\t\t}\r\n\r\n\t\t\tplotType.totalDataSeries++;\r\n\r\n\t\t\tplotUnit.dataSeriesIndexes.push(i);\r\n\r\n\t\t\tdataSeries.plotUnit = plotUnit;\r\n\t\t}\r\n\t}\r\n\r\n\tfor (var i = 0; i < this.plotInfo.plotTypes.length; i++) {\r\n\t\tvar plotType = this.plotInfo.plotTypes[i];\r\n\t\tvar previousDataSeriesCount = 0;\r\n\r\n\t\tfor (var j = 0; j < plotType.plotUnits.length; j++) {\r\n\r\n\t\t\tplotType.plotUnits[j].previousDataSeriesCount = previousDataSeriesCount;\r\n\r\n\t\t\tpreviousDataSeriesCount += plotType.plotUnits[j].dataSeriesIndexes.length;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nChart.prototype.assignIdToDataPoints = function () {\r\n\r\n\tfor (var i = 0; i < this.data.length; i++) {\r\n\t\tvar dataSeries = this.data[i];\r\n\r\n\t\tif (!dataSeries.dataPoints)\r\n\t\t\tcontinue;\r\n\r\n\t\tvar length = dataSeries.dataPoints.length;\r\n\r\n\t\tfor (var j = 0; j < length; j++) {\r\n\t\t\tdataSeries.dataPointIds[j] = ++this._eventManager.lastObjectId;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nChart.prototype._processData = function () {\r\n\tthis.assignIdToDataPoints();\r\n\tthis.categoriseDataSeries();\r\n\r\n\tfor (var i = 0; i < this.plotInfo.plotTypes.length; i++) {\r\n\t\tvar plotType = this.plotInfo.plotTypes[i];\r\n\r\n\t\tfor (var j = 0; j < plotType.plotUnits.length; j++) {\r\n\r\n\t\t\tvar plotUnit = plotType.plotUnits[j];\r\n\r\n\t\t\tif (plotUnit.type === \"line\" || plotUnit.type === \"stepLine\" || plotUnit.type === \"spline\" || plotUnit.type === \"column\" || plotUnit.type === \"area\" || plotUnit.type === \"stepArea\" || plotUnit.type === \"splineArea\" || plotUnit.type === \"bar\" || plotUnit.type === \"bubble\" || plotUnit.type === \"scatter\")\r\n\t\t\t\tthis._processMultiseriesPlotUnit(plotUnit);\r\n\t\t\telse if (plotUnit.type === \"stackedColumn\" || plotUnit.type === \"stackedBar\" || plotUnit.type === \"stackedArea\")\r\n\t\t\t\tthis._processStackedPlotUnit(plotUnit);\r\n\t\t\telse if (plotUnit.type === \"stackedColumn100\" || plotUnit.type === \"stackedBar100\" || plotUnit.type === \"stackedArea100\")\r\n\t\t\t\tthis._processStacked100PlotUnit(plotUnit);\r\n\t\t\telse if (plotUnit.type === \"candlestick\" || plotUnit.type === \"ohlc\" || plotUnit.type === \"rangeColumn\" || plotUnit.type === \"rangeBar\" || plotUnit.type === \"rangeArea\" || plotUnit.type === \"rangeSplineArea\")\r\n\t\t\t\tthis._processMultiYPlotUnit(plotUnit);\r\n\t\t}\r\n\t}\r\n\r\n}\r\n\r\nChart.prototype._processMultiseriesPlotUnit = function (plotUnit) {\r\n\tif (!plotUnit.dataSeriesIndexes || plotUnit.dataSeriesIndexes.length < 1)\r\n\t\treturn;\r\n\r\n\tvar axisYDataInfo = plotUnit.axisY.dataInfo;\r\n\tvar axisXDataInfo = plotUnit.axisX.dataInfo;\r\n\tvar dataPointX, dataPointY;\r\n\tvar isDateTime = false;\r\n\r\n\r\n\tfor (var j = 0; j < plotUnit.dataSeriesIndexes.length; j++) {\r\n\t\tvar dataSeries = this.data[plotUnit.dataSeriesIndexes[j]];\r\n\t\tvar i = 0;\r\n\t\tvar isFirstDPInViewPort = false;\r\n\t\tvar isLastDPInViewPort = false;\r\n\r\n\t\tif (dataSeries.axisPlacement === \"normal\" || dataSeries.axisPlacement === \"xySwapped\") {\r\n\r\n\t\t\tvar plotAreaXMin = this.sessionVariables.axisX.newViewportMinimum ? this.sessionVariables.axisX.newViewportMinimum : (this._options.axisX && this._options.axisX.viewportMinimum) ?\r\n\t\t\t\tthis._options.axisX.viewportMinimum : (this._options.axisX && this._options.axisX.minimum) ? this._options.axisX.minimum : -Infinity;\r\n\r\n\t\t\tvar plotAreaXMax = this.sessionVariables.axisX.newViewportMaximum ? this.sessionVariables.axisX.newViewportMaximum : (this._options.axisX && this._options.axisX.viewportMaximum) ?\r\n\t\t\t\tthis._options.axisX.viewportMaximum : (this._options.axisX && this._options.axisX.maximum) ? this._options.axisX.maximum : Infinity;\r\n\t\t}\r\n\r\n\r\n\t\tif (dataSeries.dataPoints[i].x && dataSeries.dataPoints[i].x.getTime || dataSeries.xValueType === \"dateTime\") {\r\n\t\t\tisDateTime = true;\r\n\t\t}\r\n\r\n\t\tfor (i = 0; i < dataSeries.dataPoints.length; i++) {\r\n\r\n\t\t\tif (typeof dataSeries.dataPoints[i].x === \"undefined\") {\r\n\t\t\t\tdataSeries.dataPoints[i].x = i;\r\n\t\t\t}\r\n\r\n\t\t\tif (dataSeries.dataPoints[i].x.getTime) {\r\n\t\t\t\tisDateTime = true;\r\n\t\t\t\tdataPointX = dataSeries.dataPoints[i].x.getTime();//dataPointX is used so that getTime is called only once in case of dateTime values\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t\tdataPointX = dataSeries.dataPoints[i].x;\r\n\r\n\t\t\tdataPointY = dataSeries.dataPoints[i].y;\r\n\r\n\r\n\t\t\tif (dataPointX < axisXDataInfo.min)\r\n\t\t\t\taxisXDataInfo.min = dataPointX;\r\n\t\t\tif (dataPointX > axisXDataInfo.max)\r\n\t\t\t\taxisXDataInfo.max = dataPointX;\r\n\r\n\t\t\tif (dataPointY < axisYDataInfo.min)\r\n\t\t\t\taxisYDataInfo.min = dataPointY;\r\n\r\n\t\t\tif (dataPointY > axisYDataInfo.max)\r\n\t\t\t\taxisYDataInfo.max = dataPointY;\r\n\r\n\r\n\t\t\tif (i > 0) {\r\n\t\t\t\tvar xDiff = dataPointX - dataSeries.dataPoints[i - 1].x;\r\n\t\t\t\txDiff < 0 && (xDiff = xDiff * -1); //If Condition shortcut\r\n\r\n\t\t\t\tif (axisXDataInfo.minDiff > xDiff && xDiff !== 0) {\r\n\t\t\t\t\taxisXDataInfo.minDiff = xDiff;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (dataPointY !== null && dataSeries.dataPoints[i - 1].y !== null) {\r\n\t\t\t\t\tvar yDiff = dataPointY - dataSeries.dataPoints[i - 1].y;\r\n\t\t\t\t\tyDiff < 0 && (yDiff = yDiff * -1); //If Condition shortcut\r\n\r\n\t\t\t\t\tif (axisYDataInfo.minDiff > yDiff && yDiff !== 0) {\r\n\t\t\t\t\t\taxisYDataInfo.minDiff = yDiff;\r\n\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// This section makes sure that partially visible dataPoints are included in the begining\r\n\t\t\tif (dataPointX < plotAreaXMin && !isFirstDPInViewPort) {\r\n\t\t\t\tcontinue;\r\n\t\t\t} else if (!isFirstDPInViewPort) {\r\n\t\t\t\tisFirstDPInViewPort = true;\r\n\r\n\t\t\t\tif (i > 0) {\r\n\t\t\t\t\ti -= 2;\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// This section makes sure that partially visible dataPoints are included at the end\r\n\t\t\tif (dataPointX > plotAreaXMax && !isLastDPInViewPort) {\r\n\t\t\t\tisLastDPInViewPort = true;\r\n\t\t\t} else if (dataPointX > plotAreaXMax && isLastDPInViewPort) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\tif (dataSeries.dataPoints[i].label)\r\n\t\t\t\tplotUnit.axisX.labels[dataPointX] = dataSeries.dataPoints[i].label;\r\n\r\n\r\n\t\t\tif (dataPointX < axisXDataInfo.viewPortMin)\r\n\t\t\t\taxisXDataInfo.viewPortMin = dataPointX;\r\n\t\t\tif (dataPointX > axisXDataInfo.viewPortMax)\r\n\t\t\t\taxisXDataInfo.viewPortMax = dataPointX;\r\n\r\n\t\t\tif (dataPointY === null)\r\n\t\t\t\tcontinue;\r\n\r\n\t\t\tif (dataPointY < axisYDataInfo.viewPortMin)\r\n\t\t\t\taxisYDataInfo.viewPortMin = dataPointY;\r\n\t\t\tif (dataPointY > axisYDataInfo.viewPortMax)\r\n\t\t\t\taxisYDataInfo.viewPortMax = dataPointY;\r\n\t\t}\r\n\r\n\t\tthis.plotInfo.axisXValueType = dataSeries.xValueType = isDateTime ? \"dateTime\" : \"number\";\r\n\t}\r\n\r\n\t//this.dataPoints.sort(compareDataPointX);\r\n\t//this.dataPoints.sort(function (dataPoint1, dataPoint2) { return dataPoint1.x - dataPoint2.x; });\r\n}\r\n\r\nChart.prototype._processStackedPlotUnit = function (plotUnit) {\r\n\r\n\tif (!plotUnit.dataSeriesIndexes || plotUnit.dataSeriesIndexes.length < 1)\r\n\t\treturn;\r\n\r\n\tvar axisYDataInfo = plotUnit.axisY.dataInfo;\r\n\tvar axisXDataInfo = plotUnit.axisX.dataInfo;\r\n\r\n\tvar dataPointX, dataPointY;\r\n\tvar isDateTime = false;\r\n\r\n\tvar dataPointYPositiveSums = [];\r\n\tvar dataPointYNegativeSums = [];\r\n\r\n\tfor (var j = 0; j < plotUnit.dataSeriesIndexes.length; j++) {\r\n\t\tvar dataSeries = this.data[plotUnit.dataSeriesIndexes[j]];\r\n\t\tvar i = 0;\r\n\t\tvar isFirstDPInViewPort = false;\r\n\t\tvar isLastDPInViewPort = false;\r\n\r\n\t\tif (dataSeries.axisPlacement === \"normal\" || dataSeries.axisPlacement === \"xySwapped\") {\r\n\r\n\t\t\tvar plotAreaXMin = this.sessionVariables.axisX.newViewportMinimum ? this.sessionVariables.axisX.newViewportMinimum : (this._options.axisX && this._options.axisX.viewportMinimum) ?\r\n\t\t\t\tthis._options.axisX.viewportMinimum : (this._options.axisX && this._options.axisX.minimum) ? this._options.axisX.minimum : -Infinity;\r\n\r\n\t\t\tvar plotAreaXMax = this.sessionVariables.axisX.newViewportMaximum ? this.sessionVariables.axisX.newViewportMaximum : (this._options.axisX && this._options.axisX.viewportMaximum) ?\r\n\t\t\t\tthis._options.axisX.viewportMaximum : (this._options.axisX && this._options.axisX.maximum) ? this._options.axisX.maximum : Infinity;\r\n\t\t}\r\n\r\n\r\n\t\tif (dataSeries.dataPoints[i].x && dataSeries.dataPoints[i].x.getTime || dataSeries.xValueType === \"dateTime\") {\r\n\t\t\tisDateTime = true;\r\n\t\t}\r\n\r\n\t\tfor (i = 0; i < dataSeries.dataPoints.length; i++) {\r\n\r\n\t\t\t// Requird when no x values are provided\r\n\t\t\tif (typeof dataSeries.dataPoints[i].x === \"undefined\") {\r\n\t\t\t\tdataSeries.dataPoints[i].x = i;\r\n\t\t\t}\r\n\r\n\t\t\tif (dataSeries.dataPoints[i].x.getTime) {\r\n\t\t\t\tisDateTime = true;\r\n\t\t\t\tdataPointX = dataSeries.dataPoints[i].x.getTime();//dataPointX is used so that getTime is called only once in case of dateTime values\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t\tdataPointX = dataSeries.dataPoints[i].x;\r\n\r\n\t\t\tdataPointY = dataSeries.dataPoints[i].y;\r\n\r\n\r\n\r\n\t\t\tif (dataPointX < axisXDataInfo.min)\r\n\t\t\t\taxisXDataInfo.min = dataPointX;\r\n\t\t\tif (dataPointX > axisXDataInfo.max)\r\n\t\t\t\taxisXDataInfo.max = dataPointX;\r\n\r\n\t\t\tif (i > 0) {\r\n\t\t\t\tvar xDiff = dataPointX - dataSeries.dataPoints[i - 1].x;\r\n\t\t\t\txDiff < 0 && (xDiff = xDiff * -1); //If Condition shortcut\r\n\r\n\t\t\t\tif (axisXDataInfo.minDiff > xDiff && xDiff !== 0) {\r\n\t\t\t\t\taxisXDataInfo.minDiff = xDiff;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (dataPointY !== null && dataSeries.dataPoints[i - 1].y !== null) {\r\n\t\t\t\t\tvar yDiff = dataPointY - dataSeries.dataPoints[i - 1].y;\r\n\t\t\t\t\tyDiff < 0 && (yDiff = yDiff * -1); //If Condition shortcut\r\n\r\n\t\t\t\t\tif (axisYDataInfo.minDiff > yDiff && yDiff !== 0) {\r\n\t\t\t\t\t\taxisYDataInfo.minDiff = yDiff;\r\n\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// This section makes sure that partially visible dataPoints are included in the begining\r\n\t\t\tif (dataPointX < plotAreaXMin && !isFirstDPInViewPort) {\r\n\t\t\t\tcontinue;\r\n\t\t\t} else if (!isFirstDPInViewPort) {\r\n\t\t\t\tisFirstDPInViewPort = true;\r\n\r\n\t\t\t\tif (i > 0) {\r\n\t\t\t\t\ti -= 2;\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// This section makes sure that partially visible dataPoints are included at the end\r\n\t\t\tif (dataPointX > plotAreaXMax && !isLastDPInViewPort) {\r\n\t\t\t\tisLastDPInViewPort = true;\r\n\t\t\t} else if (dataPointX > plotAreaXMax && isLastDPInViewPort) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\r\n\t\t\tif (dataSeries.dataPoints[i].label)\r\n\t\t\t\tplotUnit.axisX.labels[dataPointX] = dataSeries.dataPoints[i].label;\r\n\r\n\t\t\tif (dataPointX < axisXDataInfo.viewPortMin)\r\n\t\t\t\taxisXDataInfo.viewPortMin = dataPointX;\r\n\t\t\tif (dataPointX > axisXDataInfo.viewPortMax)\r\n\t\t\t\taxisXDataInfo.viewPortMax = dataPointX;\r\n\r\n\t\t\tif (dataPointY === null)\r\n\t\t\t\tcontinue;\r\n\r\n\t\t\tplotUnit.yTotals[dataPointX] = (!plotUnit.yTotals[dataPointX] ? 0 : plotUnit.yTotals[dataPointX]) + Math.abs(dataPointY);\r\n\r\n\t\t\tif (dataPointY >= 0) {\r\n\t\t\t\tif (dataPointYPositiveSums[dataPointX])\r\n\t\t\t\t\tdataPointYPositiveSums[dataPointX] += dataPointY;\r\n\t\t\t\telse\r\n\t\t\t\t\tdataPointYPositiveSums[dataPointX] = dataPointY;\r\n\t\t\t} else {\r\n\t\t\t\tif (dataPointYNegativeSums[dataPointX])\r\n\t\t\t\t\tdataPointYNegativeSums[dataPointX] += dataPointY;\r\n\t\t\t\telse\r\n\t\t\t\t\tdataPointYNegativeSums[dataPointX] = dataPointY;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.plotInfo.axisXValueType = dataSeries.xValueType = isDateTime ? \"dateTime\" : \"number\";\r\n\t}\r\n\r\n\tfor (i in dataPointYPositiveSums) {\r\n\t\tif (dataPointYPositiveSums.hasOwnProperty(i)) {\r\n\t\tif (isNaN(i)) {\r\n\t\t\tcontinue;\r\n\t\t}\r\n\t\tvar ySum = dataPointYPositiveSums[i];\r\n\r\n\t\tif (ySum < axisYDataInfo.min)\r\n\t\t\taxisYDataInfo.min = ySum;\r\n\r\n\t\tif (ySum > axisYDataInfo.max)\r\n\t\t\taxisYDataInfo.max = ySum;\r\n\r\n\t\tif (i < axisXDataInfo.viewPortMin || i > axisXDataInfo.viewPortMax)\r\n\t\t\tcontinue;\r\n\r\n\t\tif (ySum < axisYDataInfo.viewPortMin)\r\n\t\t\taxisYDataInfo.viewPortMin = ySum;\r\n\t\tif (ySum > axisYDataInfo.viewPortMax)\r\n\t\t\taxisYDataInfo.viewPortMax = ySum;\r\n\t}\r\n\r\n\t}\r\n\r\n\tfor (i in dataPointYNegativeSums) {\r\n\r\n\t\tif (dataPointYNegativeSums.hasOwnProperty(i)) {\r\n\t\tif (isNaN(i)) {\r\n\t\t\tcontinue;\r\n\t\t}\r\n\r\n\t\tvar ySum = dataPointYNegativeSums[i];\r\n\r\n\t\tif (ySum < axisYDataInfo.min)\r\n\t\t\taxisYDataInfo.min = ySum;\r\n\r\n\t\tif (ySum > axisYDataInfo.max)\r\n\t\t\taxisYDataInfo.max = ySum;\r\n\r\n\t\tif (i < axisXDataInfo.viewPortMin || i > axisXDataInfo.viewPortMax)\r\n\t\t\tcontinue;\r\n\r\n\t\tif (ySum < axisYDataInfo.viewPortMin)\r\n\t\t\taxisYDataInfo.viewPortMin = ySum;\r\n\t\tif (ySum > axisYDataInfo.viewPortMax)\r\n\t\t\taxisYDataInfo.viewPortMax = ySum;\r\n\t}\r\n\r\n\t}\r\n\r\n\r\n\t//this.dataPoints.sort(compareDataPointX);\r\n\t//this.dataPoints.sort(function (dataPoint1, dataPoint2) { return dataPoint1.x - dataPoint2.x; });\r\n\r\n\t//window.console.log(\"viewPortYMin: \" + plotInfo.viewPortYMin + \"; viewPortYMax: \" + plotInfo.viewPortYMax);\r\n}\r\n\r\nChart.prototype._processStacked100PlotUnit = function (plotUnit) {\r\n\tif (!plotUnit.dataSeriesIndexes || plotUnit.dataSeriesIndexes.length < 1)\r\n\t\treturn;\r\n\r\n\tvar axisYDataInfo = plotUnit.axisY.dataInfo;\r\n\tvar axisXDataInfo = plotUnit.axisX.dataInfo;\r\n\r\n\tvar dataPointX, dataPointY;\r\n\tvar isDateTime = false;\r\n\tvar containsPositiveY = false;\r\n\tvar containsNegativeY = false;\r\n\r\n\tvar dataPointYSums = [];\r\n\r\n\tfor (var j = 0; j < plotUnit.dataSeriesIndexes.length; j++) {\r\n\t\tvar dataSeries = this.data[plotUnit.dataSeriesIndexes[j]];\r\n\t\tvar i = 0;\r\n\t\tvar isFirstDPInViewPort = false;\r\n\t\tvar isLastDPInViewPort = false;\r\n\r\n\t\tif (dataSeries.axisPlacement === \"normal\" || dataSeries.axisPlacement === \"xySwapped\") {\r\n\r\n\t\t\tvar plotAreaXMin = this.sessionVariables.axisX.newViewportMinimum ? this.sessionVariables.axisX.newViewportMinimum : (this._options.axisX && this._options.axisX.viewportMinimum) ?\r\n\t\t\t\tthis._options.axisX.viewportMinimum : (this._options.axisX && this._options.axisX.minimum) ? this._options.axisX.minimum : -Infinity;\r\n\r\n\t\t\tvar plotAreaXMax = this.sessionVariables.axisX.newViewportMaximum ? this.sessionVariables.axisX.newViewportMaximum : (this._options.axisX && this._options.axisX.viewportMaximum) ?\r\n\t\t\t\tthis._options.axisX.viewportMaximum : (this._options.axisX && this._options.axisX.maximum) ? this._options.axisX.maximum : Infinity;\r\n\t\t}\r\n\r\n\r\n\t\tif (dataSeries.dataPoints[i].x && dataSeries.dataPoints[i].x.getTime || dataSeries.xValueType === \"dateTime\") {\r\n\t\t\tisDateTime = true;\r\n\t\t}\r\n\r\n\t\tfor (i = 0; i < dataSeries.dataPoints.length; i++) {\r\n\r\n\t\t\t// Requird when no x values are provided\r\n\t\t\tif (typeof dataSeries.dataPoints[i].x === \"undefined\") {\r\n\t\t\t\tdataSeries.dataPoints[i].x = i;\r\n\t\t\t}\r\n\r\n\t\t\tif (dataSeries.dataPoints[i].x.getTime) {\r\n\t\t\t\tisDateTime = true;\r\n\t\t\t\tdataPointX = dataSeries.dataPoints[i].x.getTime();//dataPointX is used so that getTime is called only once in case of dateTime values\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t\tdataPointX = dataSeries.dataPoints[i].x;\r\n\r\n\t\t\tdataPointY = dataSeries.dataPoints[i].y;\r\n\r\n\r\n\r\n\t\t\tif (dataPointX < axisXDataInfo.min)\r\n\t\t\t\taxisXDataInfo.min = dataPointX;\r\n\t\t\tif (dataPointX > axisXDataInfo.max)\r\n\t\t\t\taxisXDataInfo.max = dataPointX;\r\n\r\n\t\t\tif (i > 0) {\r\n\t\t\t\tvar xDiff = dataPointX - dataSeries.dataPoints[i - 1].x;\r\n\t\t\t\txDiff < 0 && (xDiff = xDiff * -1); //If Condition shortcut\r\n\r\n\t\t\t\tif (axisXDataInfo.minDiff > xDiff && xDiff !== 0) {\r\n\t\t\t\t\taxisXDataInfo.minDiff = xDiff;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (dataPointY !== null && dataSeries.dataPoints[i - 1].y !== null) {\r\n\t\t\t\t\tvar yDiff = dataPointY - dataSeries.dataPoints[i - 1].y;\r\n\t\t\t\t\tyDiff < 0 && (yDiff = yDiff * -1); //If Condition shortcut\r\n\r\n\t\t\t\t\tif (axisYDataInfo.minDiff > yDiff && yDiff !== 0) {\r\n\t\t\t\t\t\taxisYDataInfo.minDiff = yDiff;\r\n\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// This section makes sure that partially visible dataPoints are included in the begining\r\n\t\t\tif (dataPointX < plotAreaXMin && !isFirstDPInViewPort) {\r\n\t\t\t\tcontinue;\r\n\t\t\t} else if (!isFirstDPInViewPort) {\r\n\t\t\t\tisFirstDPInViewPort = true;\r\n\r\n\t\t\t\tif (i > 0) {\r\n\t\t\t\t\ti -= 2;\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// This section makes sure that partially visible dataPoints are included at the end\r\n\t\t\tif (dataPointX > plotAreaXMax && !isLastDPInViewPort) {\r\n\t\t\t\tisLastDPInViewPort = true;\r\n\t\t\t} else if (dataPointX > plotAreaXMax && isLastDPInViewPort) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\tif (dataSeries.dataPoints[i].label)\r\n\t\t\t\tplotUnit.axisX.labels[dataPointX] = dataSeries.dataPoints[i].label;\r\n\r\n\t\t\tif (dataPointX < axisXDataInfo.viewPortMin)\r\n\t\t\t\taxisXDataInfo.viewPortMin = dataPointX;\r\n\t\t\tif (dataPointX > axisXDataInfo.viewPortMax)\r\n\t\t\t\taxisXDataInfo.viewPortMax = dataPointX;\r\n\r\n\t\t\tif (dataPointY === null)\r\n\t\t\t\tcontinue;\r\n\r\n\t\t\tplotUnit.yTotals[dataPointX] = (!plotUnit.yTotals[dataPointX] ? 0 : plotUnit.yTotals[dataPointX]) + Math.abs(dataPointY);\r\n\r\n\t\t\tif (dataPointY >= 0) {\r\n\t\t\t\tcontainsPositiveY = true;\r\n\t\t\t} else {\r\n\t\t\t\tcontainsNegativeY = true;\r\n\t\t\t}\r\n\r\n\t\t\tif (dataPointYSums[dataPointX])\r\n\t\t\t\tdataPointYSums[dataPointX] += Math.abs(dataPointY);\r\n\t\t\telse\r\n\t\t\t\tdataPointYSums[dataPointX] = Math.abs(dataPointY);\r\n\t\t}\r\n\r\n\t\tthis.plotInfo.axisXValueType = dataSeries.xValueType = isDateTime ? \"dateTime\" : \"number\";\r\n\t}\r\n\r\n\r\n\tif (containsPositiveY && !containsNegativeY) {\r\n\t\taxisYDataInfo.max = 99;\r\n\t\taxisYDataInfo.min = 1;\r\n\t} else if (containsPositiveY && containsNegativeY) {\r\n\t\taxisYDataInfo.max = 99;\r\n\t\taxisYDataInfo.min = -99;\r\n\t} else if (!containsPositiveY && containsNegativeY) {\r\n\t\taxisYDataInfo.max = -1;\r\n\t\taxisYDataInfo.min = -99;\r\n\t}\r\n\r\n\taxisYDataInfo.viewPortMin = axisYDataInfo.min;\r\n\taxisYDataInfo.viewPortMax = axisYDataInfo.max;\r\n\r\n\tplotUnit.dataPointYSums = dataPointYSums;\r\n\r\n\t//this.dataPoints.sort(compareDataPointX);\r\n\t//this.dataPoints.sort(function (dataPoint1, dataPoint2) { return dataPoint1.x - dataPoint2.x; });\r\n\r\n\t//window.console.log(\"viewPortYMin: \" + plotInfo.viewPortYMin + \"; viewPortYMax: \" + plotInfo.viewPortYMax);\r\n}\r\n\r\nChart.prototype._processMultiYPlotUnit = function (plotUnit) {\r\n\tif (!plotUnit.dataSeriesIndexes || plotUnit.dataSeriesIndexes.length < 1)\r\n\t\treturn;\r\n\r\n\tvar axisYDataInfo = plotUnit.axisY.dataInfo;\r\n\tvar axisXDataInfo = plotUnit.axisX.dataInfo;\r\n\tvar dataPointX, dataPointY, dataPointYMin, dataPointYMax;\r\n\tvar isDateTime = false;\r\n\r\n\r\n\tfor (var j = 0; j < plotUnit.dataSeriesIndexes.length; j++) {\r\n\t\tvar dataSeries = this.data[plotUnit.dataSeriesIndexes[j]];\r\n\t\tvar i = 0;\r\n\t\tvar isFirstDPInViewPort = false;\r\n\t\tvar isLastDPInViewPort = false;\r\n\r\n\t\tif (dataSeries.axisPlacement === \"normal\" || dataSeries.axisPlacement === \"xySwapped\") {\r\n\r\n\t\t\tvar plotAreaXMin = this.sessionVariables.axisX.newViewportMinimum ? this.sessionVariables.axisX.newViewportMinimum : (this._options.axisX && this._options.axisX.viewportMinimum) ?\r\n\t\t\t\tthis._options.axisX.viewportMinimum : (this._options.axisX && this._options.axisX.minimum) ? this._options.axisX.minimum : -Infinity;\r\n\r\n\t\t\tvar plotAreaXMax = this.sessionVariables.axisX.newViewportMaximum ? this.sessionVariables.axisX.newViewportMaximum : (this._options.axisX && this._options.axisX.viewportMaximum) ?\r\n\t\t\t\tthis._options.axisX.viewportMaximum : (this._options.axisX && this._options.axisX.maximum) ? this._options.axisX.maximum : Infinity;\r\n\t\t}\r\n\r\n\r\n\t\tif (dataSeries.dataPoints[i].x && dataSeries.dataPoints[i].x.getTime || dataSeries.xValueType === \"dateTime\") {\r\n\t\t\tisDateTime = true;\r\n\t\t}\r\n\r\n\t\tfor (i = 0; i < dataSeries.dataPoints.length; i++) {\r\n\r\n\t\t\tif (typeof dataSeries.dataPoints[i].x === \"undefined\") {\r\n\t\t\t\tdataSeries.dataPoints[i].x = i;\r\n\t\t\t}\r\n\r\n\t\t\tif (dataSeries.dataPoints[i].x.getTime) {\r\n\t\t\t\tisDateTime = true;\r\n\t\t\t\tdataPointX = dataSeries.dataPoints[i].x.getTime();//dataPointX is used so that getTime is called only once in case of dateTime values\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t\tdataPointX = dataSeries.dataPoints[i].x;\r\n\r\n\t\t\tdataPointY = dataSeries.dataPoints[i].y;\r\n\r\n\t\t\tif (dataPointY && dataPointY.length) {\r\n\t\t\t\tdataPointYMin = Math.min.apply(null, dataPointY);\r\n\t\t\t\tdataPointYMax = Math.max.apply(null, dataPointY);\r\n\t\t\t}\r\n\r\n\r\n\t\t\tif (dataPointX < axisXDataInfo.min)\r\n\t\t\t\taxisXDataInfo.min = dataPointX;\r\n\t\t\tif (dataPointX > axisXDataInfo.max)\r\n\t\t\t\taxisXDataInfo.max = dataPointX;\r\n\r\n\t\t\tif (dataPointYMin < axisYDataInfo.min)\r\n\t\t\t\taxisYDataInfo.min = dataPointYMin;\r\n\r\n\t\t\tif (dataPointYMax > axisYDataInfo.max)\r\n\t\t\t\taxisYDataInfo.max = dataPointYMax;\r\n\r\n\r\n\t\t\tif (i > 0) {\r\n\t\t\t\tvar xDiff = dataPointX - dataSeries.dataPoints[i - 1].x;\r\n\t\t\t\txDiff < 0 && (xDiff = xDiff * -1); //If Condition shortcut\r\n\r\n\t\t\t\tif (axisXDataInfo.minDiff > xDiff && xDiff !== 0) {\r\n\t\t\t\t\taxisXDataInfo.minDiff = xDiff;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (dataPointY[0] !== null && dataSeries.dataPoints[i - 1].y[0] !== null) {\r\n\t\t\t\t\tvar yDiff = dataPointY[0] - dataSeries.dataPoints[i - 1].y[0];\r\n\t\t\t\t\tyDiff < 0 && (yDiff = yDiff * -1); //If Condition shortcut\r\n\r\n\t\t\t\t\tif (axisYDataInfo.minDiff > yDiff && yDiff !== 0) {\r\n\t\t\t\t\t\taxisYDataInfo.minDiff = yDiff;\r\n\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// This section makes sure that partially visible dataPoints are included in the begining\r\n\t\t\tif (dataPointX < plotAreaXMin && !isFirstDPInViewPort) {\r\n\t\t\t\tcontinue;\r\n\t\t\t} else if (!isFirstDPInViewPort) {\r\n\t\t\t\tisFirstDPInViewPort = true;\r\n\r\n\t\t\t\tif (i > 0) {\r\n\t\t\t\t\ti -= 2;\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// This section makes sure that partially visible dataPoints are included at the end\r\n\t\t\tif (dataPointX > plotAreaXMax && !isLastDPInViewPort) {\r\n\t\t\t\tisLastDPInViewPort = true;\r\n\t\t\t} else if (dataPointX > plotAreaXMax && isLastDPInViewPort) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\tif (dataSeries.dataPoints[i].label)\r\n\t\t\t\tplotUnit.axisX.labels[dataPointX] = dataSeries.dataPoints[i].label;\r\n\r\n\r\n\t\t\tif (dataPointX < axisXDataInfo.viewPortMin)\r\n\t\t\t\taxisXDataInfo.viewPortMin = dataPointX;\r\n\t\t\tif (dataPointX > axisXDataInfo.viewPortMax)\r\n\t\t\t\taxisXDataInfo.viewPortMax = dataPointX;\r\n\r\n\t\t\tif (dataPointY === null)\r\n\t\t\t\tcontinue;\r\n\r\n\t\t\tif (dataPointYMin < axisYDataInfo.viewPortMin)\r\n\t\t\t\taxisYDataInfo.viewPortMin = dataPointYMin;\r\n\t\t\tif (dataPointYMax > axisYDataInfo.viewPortMax)\r\n\t\t\t\taxisYDataInfo.viewPortMax = dataPointYMax;\r\n\t\t}\r\n\r\n\t\tthis.plotInfo.axisXValueType = dataSeries.xValueType = isDateTime ? \"dateTime\" : \"number\";\r\n\t}\r\n\r\n\t//this.dataPoints.sort(compareDataPointX);\r\n\t//this.dataPoints.sort(function (dataPoint1, dataPoint2) { return dataPoint1.x - dataPoint2.x; });\r\n}\r\n\r\n//getClosest returns objects nearby and hence shouldn't be used for events like click, mouseover, mousemove, etc which require object that is exactly under the mouse.\r\nChart.prototype.getDataPointAtXY = function (mouseX, mouseY, getClosest) {\r\n\r\n\tgetClosest = getClosest || false;\r\n\tvar results = [];\r\n\r\n\tfor (var i = this._dataInRenderedOrder.length - 1; i >= 0; i--) {\r\n\t\tvar dataSeries = this._dataInRenderedOrder[i];\r\n\r\n\t\tvar result = null;\r\n\r\n\t\tresult = dataSeries.getDataPointAtXY(mouseX, mouseY, getClosest);\r\n\t\tif (result)\r\n\t\t\tresults.push(result);\r\n\t}\r\n\r\n\tvar closestResult = null;\r\n\tvar onlyLineAreaTypes = false;\r\n\r\n\tfor (var m = 0; m < results.length; m++) {\r\n\r\n\t\tif (results[m].dataSeries.type === \"line\" || results[m].dataSeries.type === \"stepLine\" || results[m].dataSeries.type === \"area\" || results[m].dataSeries.type === \"stepArea\") {\r\n\t\t\tvar markerSize = getProperty(\"markerSize\", results[m].dataPoint, results[m].dataSeries) || 8;\r\n\t\t\tif (results[m].distance <= markerSize / 2) {\r\n\t\t\t\tonlyLineAreaTypes = true;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tfor (m = 0; m < results.length; m++) {\r\n\r\n\t\tif (onlyLineAreaTypes && results[m].dataSeries.type !== \"line\" && results[m].dataSeries.type !== \"stepLine\" && results[m].dataSeries.type !== \"area\" && results[m].dataSeries.type !== \"stepArea\")\r\n\t\t\tcontinue;\r\n\r\n\t\tif (!closestResult) {\r\n\t\t\tclosestResult = results[m];\r\n\t\t} else if (results[m].distance <= closestResult.distance) {\r\n\t\t\tclosestResult = results[m];\r\n\t\t}\r\n\t}\r\n\r\n\treturn closestResult;\r\n}\r\n\r\nChart.prototype.getObjectAtXY = function (mouseX, mouseY, getClosest) {\r\n\tgetClosest = getClosest || false;\r\n\r\n\tvar id = null;\r\n\r\n\tvar dataPointInfo = this.getDataPointAtXY(mouseX, mouseY, getClosest);\r\n\r\n\tif (dataPointInfo) {\r\n\t\tid = dataPointInfo.dataSeries.dataPointIds[dataPointInfo.dataPointIndex];\r\n\t} else if (isCanvasSupported) {//IE9+\r\n\t\tid = getObjectId(mouseX, mouseY, this._eventManager.ghostCtx);\r\n\t}\r\n\telse {\r\n\t\tfor (var i = 0; i < this.legend.items.length; i++) {\r\n\t\t\tvar item = this.legend.items[i];\r\n\r\n\t\t\tif (mouseX >= item.x1 && mouseX <= item.x2 && mouseY >= item.y1 && mouseY <= item.y2) {\r\n\t\t\t\tid = item.id;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\treturn id;\r\n}\r\n\r\n/// <summary>Calculates Font Size based on standardSize and Chart Size</summary>\r\n/// <param name=\"standardSize\" type=\"Number\">Standard font size for a Chart with min(width,height) = 400px</param>\r\n/// <returns type=\"Number\">The area.</returns>\r\nChart.prototype.getAutoFontSize = function (standardSize, width, height) {\r\n\r\n\twidth = width || this.width;\r\n\theight = height || this.height;\r\n\r\n\tvar fontSizeScaleFactor = standardSize / 400;\r\n\r\n\treturn Math.round(Math.min(this.width, this.height) * fontSizeScaleFactor);\r\n}\r\n\r\n//#region Events\r\n\r\nChart.prototype.resetOverlayedCanvas = function () {\r\n\t//var width = this.overlaidCanvas.width;\r\n\t//this.overlaidCanvas.width = 0;\r\n\t//this.overlaidCanvas.width = width;\r\n\tthis.overlaidCanvasCtx.clearRect(0, 0, this.width, this.height);\r\n}\r\n\r\nChart.prototype.clearCanvas = function () {\r\n\tthis.ctx.clearRect(0, 0, this.width, this.height);\r\n\r\n\tif (this.backgroundColor) {\r\n\t\tthis.ctx.fillStyle = this.backgroundColor;\r\n\t\tthis.ctx.fillRect(0, 0, this.width, this.height);\r\n\t}\r\n}\r\n\r\nChart.prototype.attachEvent = function (param) {\r\n\tthis._events.push(param);\r\n}\r\n\r\nChart.prototype._touchEventHandler = function (ev) {\r\n\tif (!ev.changedTouches || !this.interactivityEnabled)\r\n\t\treturn;\r\n\r\n\tvar mouseEvents = [];\r\n\tvar touches = ev.changedTouches;\r\n\tvar first = touches ? touches[0] : ev;\r\n\tvar touchCurrentCoordinates = null;\r\n\r\n\t//window.console.log(touches.length);\r\n\r\n\tswitch (ev.type) {\r\n\t\tcase \"touchstart\": case \"MSPointerDown\":\r\n\t\t\tmouseEvents = [\"mousemove\", \"mousedown\"];\r\n\t\t\tthis._lastTouchData = getMouseCoordinates(first);\r\n\t\t\tthis._lastTouchData.time = new Date();\r\n\t\t\tbreak;\r\n\t\tcase \"touchmove\": case \"MSPointerMove\": mouseEvents = [\"mousemove\"]; break;\r\n\t\tcase \"touchend\": case \"MSPointerUp\": mouseEvents = (this._lastTouchEventType === \"touchstart\" || this._lastTouchEventType === \"MSPointerDown\") ? [\"mouseup\", \"click\"] : [\"mouseup\"];\r\n\t\t\tbreak;\r\n\t\tdefault: return;\r\n\t}\r\n\r\n\tif (touches && touches.length > 1) return;\r\n\r\n\r\n\ttouchCurrentCoordinates = getMouseCoordinates(first);\r\n\ttouchCurrentCoordinates.time = new Date();\r\n\ttry {\r\n\t\tvar dy = touchCurrentCoordinates.y - this._lastTouchData.y;\r\n\t\tvar dx = touchCurrentCoordinates.x - this._lastTouchData.x;\r\n\t\tvar dt = touchCurrentCoordinates.time - this._lastTouchData.time;\r\n\r\n\t\tif (Math.abs(dy) > 15 && (!!this._lastTouchData.scroll || dt < 200)) {\r\n\t\t\t//this._lastTouchData.y = touchCurrentCoordinates.y;\r\n\t\t\tthis._lastTouchData.scroll = true;\r\n\r\n\t\t\tvar win = window.parent || window;\r\n\t\t\tif (win && win.scrollBy)\r\n\t\t\t\twin.scrollBy(0, -dy);\r\n\t\t}\r\n\t} catch (e) { };\r\n\r\n\tthis._lastTouchEventType = ev.type;\r\n\r\n\tif (!!this._lastTouchData.scroll && this.zoomEnabled) {\r\n\t\tif (this.isDrag)\r\n\t\t\tthis.resetOverlayedCanvas();\r\n\r\n\t\tthis.isDrag = false;\r\n\t\treturn;\r\n\t}\r\n\r\n\tfor (var i = 0; i < mouseEvents.length; i++) {\r\n\r\n\t\tvar type = mouseEvents[i];\r\n\t\tvar simulatedEvent = document.createEvent(\"MouseEvent\");\r\n\t\tsimulatedEvent.initMouseEvent(type, true, true, window, 1,\r\n\t\t\t\t\t\t\t\t  first.screenX, first.screenY,\r\n\t\t\t\t\t\t\t\t  first.clientX, first.clientY, false,\r\n\t\t\t\t\t\t\t\t  false, false, false, 0, null);\r\n\r\n\t\tfirst.target.dispatchEvent(simulatedEvent);\r\n\r\n\t\tif (ev.preventManipulation) {\r\n\t\t\t//alert(\"preventManipulation\");\r\n\t\t\tev.preventManipulation();\r\n\t\t}\r\n\r\n\t\tif (ev.preventDefault) {\r\n\t\t\t//alert(\"preventDefault\");\r\n\t\t\tev.preventDefault();\r\n\t\t}\r\n\t}\r\n}\r\n\r\nChart.prototype._dispatchRangeEvent = function (eventName, triggerSource) {\r\n\tvar eventParameter = {};\r\n\r\n\teventParameter.chart = this._publicChartReference;\r\n\teventParameter.type = eventName;\r\n\teventParameter.trigger = triggerSource;\r\n\r\n\tvar axes = [];\r\n\r\n\tif (this.axisX)\r\n\t\taxes.push(\"axisX\");\r\n\tif (this.axisY)\r\n\t\taxes.push(\"axisY\");\r\n\tif (this.axisY2)\r\n\t\taxes.push(\"axisY2\");\r\n\r\n\tfor (var i = 0; i < axes.length; i++) {\r\n\t\teventParameter[axes[i]] = {\r\n\t\t\tviewportMinimum: this[axes[i]].sessionVariables.newViewportMinimum,\r\n\t\t\tviewportMaximum: this[axes[i]].sessionVariables.newViewportMaximum\r\n\t\t}\r\n\t}\r\n\r\n\tthis.dispatchEvent(eventName, eventParameter, this._publicChartReference);\r\n}\r\n\r\nChart.prototype._mouseEventHandler = function (ev) {\r\n\r\n\tif (!this.interactivityEnabled)\r\n\t\treturn;\r\n\r\n\tif (this._ignoreNextEvent) {\r\n\t\tthis._ignoreNextEvent = false;\r\n\t\treturn;\r\n\t}\r\n\r\n\t// stop panning and zooming so we can draw\r\n\tif (ev.preventManipulation) {\r\n\t\t//alert(\"preventManipulation\");\r\n\t\tev.preventManipulation();\r\n\t}\r\n\r\n\t// we are handling this event\r\n\tif (ev.preventDefault) {\r\n\t\t//alert(\"preventDefault\");\r\n\t\tev.preventDefault();\r\n\t}\r\n\r\n\t//IE8- uses srcElement instead of target. So instead of checking this condition everytime, its better to create a reference called target.\r\n\tif (typeof (ev.target) === \"undefined\" && ev.srcElement)\r\n\t\tev.target = ev.srcElement;\r\n\r\n\t//console.log(ev.type);\r\n\r\n\tvar xy = getMouseCoordinates(ev);\r\n\tvar type = ev.type;\r\n\tvar eventParam;\r\n\tvar rightclick;\r\n\r\n\tif (!ev) var e = window.event;\r\n\tif (ev.which) rightclick = (ev.which == 3);\r\n\telse if (ev.button) rightclick = (ev.button == 2);\r\n\r\n\t//window.console.log(type + \" --> x: \" + xy.x + \"; y:\" + xy.y);\r\n\r\n\t//if (type === \"mouseout\") {\r\n\t//    this._toolTip.hide();\r\n\t//}\r\n\r\n\tif (isDebugMode && window.console) {\r\n\t\twindow.console.log(type + \" --> x: \" + xy.x + \"; y:\" + xy.y);\r\n\t\tif (rightclick)\r\n\t\t\twindow.console.log(ev.which);\r\n\r\n\t\tif (type === \"mouseup\")\r\n\t\t\twindow.console.log(\"mouseup\");\r\n\t}\r\n\r\n\tif (rightclick)\r\n\t\treturn;\r\n\r\n\t//if (this.plotInfo.axisPlacement === \"xySwapped\") {\r\n\t//    //var temp = xy.x;\r\n\t//    //xy.x = xy.y;\r\n\t//    //xy.y = temp;\r\n\t//    xy = {x: xy.y, y: xy.x};\r\n\t//}\r\n\r\n\tif (Chart.capturedEventParam) {\r\n\t\teventParam = Chart.capturedEventParam;\r\n\r\n\t\tif (type === \"mouseup\") {\r\n\t\t\tChart.capturedEventParam = null;\r\n\r\n\t\t\tif (eventParam.chart.overlaidCanvas.releaseCapture)\r\n\t\t\t\teventParam.chart.overlaidCanvas.releaseCapture();\r\n\t\t\telse\r\n\t\t\t\tdocument.body.removeEventListener(\"mouseup\", eventParam.chart._mouseEventHandler, false);\r\n\r\n\t\t}\r\n\r\n\t\tif (eventParam.hasOwnProperty(type))\r\n\t\t\teventParam[type].call(eventParam.context, xy.x, xy.y);\r\n\r\n\r\n\r\n\t}\r\n\telse if (this._events) {\r\n\r\n\t\tfor (var i = 0; i < this._events.length; i++) {\r\n\t\t\tif (!this._events[i].hasOwnProperty(type))\r\n\t\t\t\tcontinue;\r\n\r\n\t\t\teventParam = this._events[i];\r\n\t\t\tvar bounds = eventParam.bounds;\r\n\r\n\t\t\tif (xy.x >= bounds.x1 && xy.x <= bounds.x2 && xy.y >= bounds.y1 && xy.y <= bounds.y2) {\r\n\t\t\t\teventParam[type].call(eventParam.context, xy.x, xy.y);\r\n\r\n\t\t\t\tif (type === \"mousedown\" && eventParam.capture === true) {\r\n\t\t\t\t\tChart.capturedEventParam = eventParam;\r\n\r\n\t\t\t\t\tif (this.overlaidCanvas.setCapture)\r\n\t\t\t\t\t\tthis.overlaidCanvas.setCapture();\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tdocument.body.addEventListener(\"mouseup\", this._mouseEventHandler, false);\r\n\t\t\t\t\t\t//addEvent(document.body, \"mouseup\", this._mouseEventHandler);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (type === \"mouseup\") {\r\n\t\t\t\t\tif (eventParam.chart.overlaidCanvas.releaseCapture)\r\n\t\t\t\t\t\teventParam.chart.overlaidCanvas.releaseCapture();\r\n\t\t\t\t\telse\r\n\t\t\t\t\t\tdocument.body.removeEventListener(\"mouseup\", this._mouseEventHandler, false);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t\teventParam = null;\r\n\t\t}\r\n\r\n\t\tif (eventParam && eventParam.cursor) {\r\n\t\t\tev.target.style.cursor = eventParam.cursor;\r\n\t\t}\r\n\t\telse\r\n\t\t\tev.target.style.cursor = this._defaultCursor;\r\n\r\n\t\t//eventParam =\r\n\t}\r\n\r\n\tif (this._toolTip && this._toolTip.enabled) {\r\n\r\n\t\tvar plotArea = this.plotArea;\r\n\r\n\t\tif (xy.x < plotArea.x1 || xy.x > plotArea.x2 || xy.y < plotArea.y1 || xy.y > plotArea.y2)\r\n\t\t\tthis._toolTip.hide();\r\n\t}\r\n\r\n\r\n\tif ((!this.isDrag || !this.zoomEnabled) && this._eventManager) {\r\n\r\n\t\tthis._eventManager.mouseEventHandler(ev);\r\n\t\t//this._updateToolTip(ev.x, ev.y);\r\n\t}\r\n\r\n\t//if (this._toolTip.enabled)\r\n\t//    this._toolTip.mouseMoveHandler(ev.x, ev.y);\r\n}\r\n\r\nChart.prototype._plotAreaMouseDown = function (x, y) {\r\n\tthis.isDrag = true;\r\n\r\n\tif (this.plotInfo.axisPlacement !== \"none\") {\r\n\t\tthis.dragStartPoint = { x: x, y: y };\r\n\t} else {\r\n\t\tthis.dragStartPoint = { x: x, y: y };\r\n\t}\r\n}\r\n\r\nChart.prototype._plotAreaMouseUp = function (x, y) {\r\n\r\n\tif (this.plotInfo.axisPlacement === \"normal\" || this.plotInfo.axisPlacement === \"xySwapped\") {\r\n\t\tif (this.isDrag) {\r\n\t\t\tvar dragDelta = 0,\r\n\t\t\t\tdragDeltaPY = y - this.dragStartPoint.y,\r\n\t\t\t\tdragDeltaPX = x - this.dragStartPoint.x,\r\n\t\t\t\tzoomPX = this.zoomType.indexOf(\"x\") >= 0, //Whether to zoom horizontally\r\n\t\t\t\tzoomPY = this.zoomType.indexOf(\"y\") >= 0, //Whether to zoom vertically\r\n\t\t\t\treRender = false;\r\n\r\n\t\t\tthis.resetOverlayedCanvas();\r\n\r\n\t\t\tif (this.plotInfo.axisPlacement === \"xySwapped\") {\r\n\t\t\t\tvar temp = zoomPY;\r\n\t\t\t\tzoomPY = zoomPX;\r\n\t\t\t\tzoomPX = temp;\r\n\t\t\t}\r\n\r\n\t\t\tif (this.panEnabled || this.zoomEnabled) {\r\n\t\t\t\tif (this.panEnabled) {\r\n\r\n\t\t\t\t\tvar overflow = 0;\r\n\r\n\t\t\t\t\tfor (var i = 0; i < this._axes.length; i++) {\r\n\t\t\t\t\t\tvar axis = this._axes[i];\r\n\r\n\t\t\t\t\t\tif (axis.viewportMinimum < axis.minimum) {\r\n\r\n\t\t\t\t\t\t\toverflow = axis.minimum - axis.viewportMinimum;\r\n\r\n\t\t\t\t\t\t\taxis.sessionVariables.newViewportMinimum = axis.viewportMinimum + overflow;\r\n\t\t\t\t\t\t\taxis.sessionVariables.newViewportMaximum = axis.viewportMaximum + overflow;\r\n\r\n\t\t\t\t\t\treRender = true;\r\n\t\t\t\t\t\t} else if (axis.viewportMaximum > axis.maximum) {\r\n\r\n\t\t\t\t\t\t\toverflow = axis.viewportMaximum - axis.maximum;\r\n\t\t\t\t\t\t\taxis.sessionVariables.newViewportMinimum = axis.viewportMinimum - overflow;\r\n\t\t\t\t\t\t\taxis.sessionVariables.newViewportMaximum = axis.viewportMaximum - overflow;\r\n\r\n\t\t\t\t\t\treRender = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\t\t\t\telse if (((!zoomPX || Math.abs(dragDeltaPX) > 2) && (!zoomPY || Math.abs(dragDeltaPY) > 2)) && this.zoomEnabled) {\r\n\r\n\t\t\t\t\tif (!this.dragStartPoint)\r\n\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\tvar selectedRegion = {\r\n\t\t\t\t\t\tx1: zoomPX ? this.dragStartPoint.x : this.plotArea.x1,\r\n\t\t\t\t\t\ty1: zoomPY ? this.dragStartPoint.y : this.plotArea.y1,\r\n\t\t\t\t\t\tx2: zoomPX ? x : this.plotArea.x2,\r\n\t\t\t\t\t\ty2: zoomPY ? y : this.plotArea.y2\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\tif (Math.abs(selectedRegion.x1 - selectedRegion.x2) > 2 && Math.abs(selectedRegion.y1 - selectedRegion.y2) > 2) {\r\n\r\n\t\t\t\t\t\tif (this._zoomPanToSelectedRegion(selectedRegion.x1, selectedRegion.y1, selectedRegion.x2, selectedRegion.y2)) {\r\n\r\n\t\t\t\t\t\t\treRender = true;\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\tif (reRender) {\r\n\t\t\t\t\tthis._ignoreNextEvent = true;//Required so that click event doesn't fire after zooming into a section of the chart.\r\n\r\n\t\t\t\t\tthis._dispatchRangeEvent(\"rangeChanging\", \"zoom\");\r\n\t\t\t\t\t\t\t\tthis.render();\r\n\t\t\t\t\tthis._dispatchRangeEvent(\"rangeChanged\", \"zoom\");\r\n\r\n\t\t\t\t\tif (reRender && this.zoomEnabled && this._zoomButton.style.display === \"none\") {\r\n\t\t\t\t\tshow(this._zoomButton, this._resetButton);\r\n\t\t\t\t\tsetButtonState(this, this._zoomButton, \"pan\");\r\n\t\t\t\t\tsetButtonState(this, this._resetButton, \"reset\");\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tthis.isDrag = false;\r\n}\r\n\r\nChart.prototype._plotAreaMouseMove = function (x, y) {\r\n\tif (this.isDrag && this.plotInfo.axisPlacement !== \"none\") {\r\n\r\n\t\tvar dragDeltaPX = 0,\r\n\t\t\tdragDeltaPY = 0,\r\n\t\t\talpha = null,\r\n\t\t\tselectedRegion = null,\r\n\t\t\tzoomPX = this.zoomType.indexOf(\"x\") >= 0, //Whether to zoom horizontally\r\n\t\t\tzoomPY = this.zoomType.indexOf(\"y\") >= 0, //Whether to zoom vertically\r\n\t\t\t_this = this;\r\n\r\n\t\tif (this.plotInfo.axisPlacement === \"xySwapped\") {\r\n\t\t\tvar temp = zoomPY;\r\n\t\t\tzoomPY = zoomPX;\r\n\t\t\tzoomPX = temp;\r\n\t\t}\r\n\r\n\t\tdragDeltaPX = this.dragStartPoint.x - x;\r\n\t\tdragDeltaPY = this.dragStartPoint.y - y;\r\n\r\n\t\tif (Math.abs(dragDeltaPX) > 2 && Math.abs(dragDeltaPX) < 8 && (this.panEnabled || this.zoomEnabled)) {\r\n\t\t\tthis._toolTip.hide();\r\n\t\t} else if (!this.panEnabled && !this.zoomEnabled) {\r\n\t\t\tthis._toolTip.mouseMoveHandler(x, y);\r\n\t\t}\r\n\r\n\t\tif (((!zoomPX || Math.abs(dragDeltaPX) > 2) || (!zoomPY || Math.abs(dragDeltaPY) > 2)) && (this.panEnabled || this.zoomEnabled)) {\r\n\t\t\tif (this.panEnabled) {\r\n\r\n\t\t\t\tselectedRegion =\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tx1: zoomPX ? this.plotArea.x1 + dragDeltaPX : this.plotArea.x1,\r\n\t\t\t\t\t\ty1: zoomPY ? this.plotArea.y1 + dragDeltaPY : this.plotArea.y1,\r\n\t\t\t\t\t\tx2: zoomPX ? this.plotArea.x2 + dragDeltaPX : this.plotArea.x2,\r\n\t\t\t\t\t\ty2: zoomPY ? this.plotArea.y2 + dragDeltaPY : this.plotArea.y2\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\tif (this._zoomPanToSelectedRegion(selectedRegion.x1, selectedRegion.y1, selectedRegion.x2, selectedRegion.y2, true)) {\r\n\t\t\t\t\tthis._dispatchRangeEvent(\"rangeChanging\", \"pan\");\r\n\t\t\t\t\tthis.render();\r\n\t\t\t\t\tthis._dispatchRangeEvent(\"rangeChanged\", \"pan\");\r\n\r\n\t\t\t\t\tthis.dragStartPoint.x = x;\r\n\t\t\t\t\tthis.dragStartPoint.y = y;\r\n\r\n\t\t\t\t\t//clearTimeout(this._panTimerId);\r\n\t\t\t\t\t//this._panTimerId = setTimeout(function () {\r\n\t\t\t\t\t//\t_this._dispatchRangeEvent(\"rangeChanging\", \"pan\");\r\n\t\t\t\t\t//\t_this.render();\r\n\t\t\t\t\t//\t_this._dispatchRangeEvent(\"rangeChanged\", \"pan\");\r\n\t\t\t\t\t//}, 0);\r\n\t\t\t\t}\r\n\r\n\t\t\t} else if (this.zoomEnabled) {\r\n\r\n\t\t\t\tthis.resetOverlayedCanvas();\r\n\r\n\t\t\t\talpha = this.overlaidCanvasCtx.globalAlpha;\r\n\r\n\t\t\t\tthis.overlaidCanvasCtx.globalAlpha = .7;\r\n\t\t\t\tthis.overlaidCanvasCtx.fillStyle = \"#A0ABB8\";\r\n\r\n\t\t\t\tvar rect = {\r\n\t\t\t\t\tx1: zoomPX ? this.dragStartPoint.x : this.plotArea.x1,\r\n\t\t\t\t\ty1: zoomPY ? this.dragStartPoint.y : this.plotArea.y1,\r\n\t\t\t\t\tx2: zoomPX ? x - this.dragStartPoint.x : this.plotArea.x2 - this.plotArea.x1,\r\n\t\t\t\t\ty2: zoomPY ? y - this.dragStartPoint.y : this.plotArea.y2 - this.plotArea.y1\r\n\t\t\t\t};\r\n\r\n\t\t\t\tthis.overlaidCanvasCtx.fillRect(rect.x1, rect.y1, rect.x2, rect.y2);\r\n\r\n\t\t\t\tthis.overlaidCanvasCtx.globalAlpha = alpha;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t} else\r\n\t\tthis._toolTip.mouseMoveHandler(x, y);\r\n}\r\n\r\n//#endregion Events\r\n\r\n//Sets the viewport range of Axis based on the given rect bounds (pixels). Also limits the zooming/panning based on axis bounds. Returns a boolean to indicate whether it was succesful or not based on the selected region.\r\nChart.prototype._zoomPanToSelectedRegion = function (px1, py1, px2, py2, keepAxisIndependent) {\r\n\r\n\tkeepAxisIndependent = keepAxisIndependent || false;\r\n\r\n\tvar zoomPX = this.zoomType.indexOf(\"x\") >= 0, //Whether to zoom horizontally\r\n\t\tzoomPY = this.zoomType.indexOf(\"y\") >= 0, //Whether to zoom vertically\r\n\t\tvalidRegion = false;\r\n\r\n\tvar axes = [], axesWithValidRange = [];\r\n\tif (this.axisX && zoomPX)\r\n\t\taxes.push(this.axisX);\r\n\tif (this.axisY && zoomPY)\r\n\t\taxes.push(this.axisY);\r\n\tif (this.axisY2 && zoomPY)\r\n\t\taxes.push(this.axisY2);\r\n\r\n\tvar params = [];\r\n\r\n\tfor (var i = 0; i < axes.length; i++) {\r\n\t\tvar axis = axes[i];\r\n\t\t//var range = Math.abs(axis.viewportMaximum - axis.viewportMinimum);\r\n\r\n\t\tvar val1 = axis.convertPixelToValue({ x: px1, y: py1 });\r\n\t\tvar val2 = axis.convertPixelToValue({ x: px2, y: py2 });\r\n\r\n\t\tif (val1 > val2) {\r\n\t\t\tvar temp = val2;\r\n\t\t\tval2 = val1;\r\n\t\t\tval1 = temp;\r\n\t\t}\r\n\r\n\t\tif (isFinite(axis.dataInfo.minDiff)) {\r\n\t\t\tif (!(Math.abs(val2 - val1) < 3 * Math.abs(axis.dataInfo.minDiff)\r\n\t\t\t|| (val1 < axis.minimum) || (val2 > axis.maximum))) {\r\n\t\t\t\taxesWithValidRange.push(axis);\r\n\t\t\t\tparams.push({ val1: val1, val2: val2 });\r\n\r\n\t\t\t\tvalidRegion = true;\r\n\t\t\t} else if (!keepAxisIndependent) {\r\n\t\t\t\tvalidRegion = false;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tif (validRegion) {\r\n\t\tfor (var i = 0; i < axesWithValidRange.length; i++) {\r\n\t\t\tvar axis = axesWithValidRange[i];\r\n\t\t\tvar param = params[i];\r\n\r\n\t\t\taxis.setViewPortRange(param.val1, param.val2);\r\n\t\t}\r\n\t}\r\n\r\n\treturn validRegion;\r\n}\r\n\r\nChart.prototype.preparePlotArea = function () {\r\n\r\n\tvar plotArea = this.plotArea;\r\n\r\n\tvar yAxis = this.axisY ? this.axisY : this.axisY2;\r\n\r\n\tif (!isCanvasSupported && (plotArea.x1 > 0 || plotArea.y1 > 0)) {\r\n\t\tplotArea.ctx.translate(plotArea.x1, plotArea.y1);\r\n\t}\r\n\r\n\tif (this.axisX && yAxis) {\r\n\t\tplotArea.x1 = this.axisX.lineCoordinates.x1 < this.axisX.lineCoordinates.x2 ? this.axisX.lineCoordinates.x1 : yAxis.lineCoordinates.x1;\r\n\t\tplotArea.y1 = (this.axisX.lineCoordinates.y1 < yAxis.lineCoordinates.y1 ? this.axisX.lineCoordinates.y1 : yAxis.lineCoordinates.y1);\r\n\r\n\t\tplotArea.x2 = (this.axisX.lineCoordinates.x2 > yAxis.lineCoordinates.x2 ? this.axisX.lineCoordinates.x2 : yAxis.lineCoordinates.x2);\r\n\t\tplotArea.y2 = this.axisX.lineCoordinates.y2 > this.axisX.lineCoordinates.y1 ? this.axisX.lineCoordinates.y2 : yAxis.lineCoordinates.y2;\r\n\r\n\t\tplotArea.width = plotArea.x2 - plotArea.x1;\r\n\t\tplotArea.height = plotArea.y2 - plotArea.y1;\r\n\t\t//plotArea = { x1: x1, y1: y1, x2: x2, y2: y2, width: x2 - x1, height: y2 - y1 };\r\n\t} else {\r\n\t\t//ToDo: @sunil\r\n\t\tvar freeSpace = this.layoutManager.getFreeSpace();\r\n\t\tplotArea.x1 = freeSpace.x1;\r\n\t\tplotArea.x2 = freeSpace.x2;\r\n\t\tplotArea.y1 = freeSpace.y1;\r\n\t\tplotArea.y2 = freeSpace.y2;\r\n\r\n\t\tplotArea.width = freeSpace.width;\r\n\t\tplotArea.height = freeSpace.height;\r\n\t}\r\n\r\n\tif (!isCanvasSupported) {\r\n\r\n\t\tplotArea.canvas.width = plotArea.width;\r\n\t\tplotArea.canvas.height = plotArea.height;\r\n\r\n\t\tplotArea.canvas.style.left = plotArea.x1 + \"px\";\r\n\t\tplotArea.canvas.style.top = plotArea.y1 + \"px\";\r\n\r\n\t\tif (plotArea.x1 > 0 || plotArea.y1 > 0) {\r\n\t\t\tplotArea.ctx.translate(-plotArea.x1, -plotArea.y1);\r\n\t\t}\r\n\t}\r\n\r\n\tplotArea.layoutManager = new LayoutManager(plotArea.x1, plotArea.y1, plotArea.x2, plotArea.y2, 2);\r\n}\r\n\r\nChart.prototype.getPixelCoordinatesOnPlotArea = function (x, y) {\r\n\treturn {\r\n\t\tx: this.axisX.getPixelCoordinatesOnAxis(x).x, y: this.axisY.getPixelCoordinatesOnAxis(y).y\r\n\t}\r\n\t//return { x: 5, y: 10 };\r\n}\r\n\r\n//#region Render Methods\r\n\r\nChart.prototype.renderIndexLabels = function (targetCtx) {\r\n\tvar ctx = targetCtx || this.plotArea.ctx;\r\n\r\n\tvar plotArea = this.plotArea;\r\n\r\n\tvar mid = 0;\r\n\tvar yMinLimit = 0;\r\n\tvar yMaxLimit = 0;\r\n\tvar xMinLimit = 0;\r\n\tvar xMaxLimit = 0;\r\n\tvar marginX = 0, marginY = 0; // Margin between label and dataPoint / PlotArea\r\n\tvar offSetX = 0, offSetY = 0; // Distance to offSet textBlock (top) from dataPoint inorder to position it\r\n\tvar visibleWidth = 0;\r\n\tvar visibleHeight = 0;\r\n\r\n\tfor (var i = 0; i < this._indexLabels.length; i++) {\r\n\r\n\t\tvar indexLabel = this._indexLabels[i];\r\n\t\tvar chartTypeLower = indexLabel.chartType.toLowerCase();\r\n\r\n\t\tvar x, y, angle;\r\n\r\n\t\tvar fontColor = getProperty(\"indexLabelFontColor\", indexLabel.dataPoint, indexLabel.dataSeries);\r\n\t\tvar fontSize = getProperty(\"indexLabelFontSize\", indexLabel.dataPoint, indexLabel.dataSeries);\r\n\t\tvar fontFamily = getProperty(\"indexLabelFontFamily\", indexLabel.dataPoint, indexLabel.dataSeries);\r\n\t\tvar fontStyle = getProperty(\"indexLabelFontStyle\", indexLabel.dataPoint, indexLabel.dataSeries);\r\n\t\tvar fontWeight = getProperty(\"indexLabelFontWeight\", indexLabel.dataPoint, indexLabel.dataSeries);\r\n\t\tvar backgroundColor = getProperty(\"indexLabelBackgroundColor\", indexLabel.dataPoint, indexLabel.dataSeries);\r\n\t\tvar maxWidth = getProperty(\"indexLabelMaxWidth\", indexLabel.dataPoint, indexLabel.dataSeries);\r\n\t\tvar indexLabelWrap = getProperty(\"indexLabelWrap\", indexLabel.dataPoint, indexLabel.dataSeries);\r\n\r\n\t\tvar percentAndTotal = {\r\n\t\t\tpercent: null, total: null\r\n\t\t};\r\n\t\tvar formatterParameter = null;\r\n\r\n\t\tif (indexLabel.dataSeries.type.indexOf(\"stacked\") >= 0 || indexLabel.dataSeries.type === \"pie\" || indexLabel.dataSeries.type === \"doughnut\")\r\n\t\t\tpercentAndTotal = this.getPercentAndTotal(indexLabel.dataSeries, indexLabel.dataPoint);\r\n\r\n\t\tif (indexLabel.dataSeries.indexLabelFormatter || indexLabel.dataPoint.indexLabelFormatter)\r\n\t\t\tformatterParameter = {\r\n\t\t\t\tchart: this._options, dataSeries: indexLabel.dataSeries, dataPoint: indexLabel.dataPoint, index: indexLabel.indexKeyword, total: percentAndTotal.total, percent: percentAndTotal.percent\r\n\t\t\t};\r\n\r\n\r\n\t\tvar indexLabelText = indexLabel.dataPoint.indexLabelFormatter ? indexLabel.dataPoint.indexLabelFormatter(formatterParameter)\r\n\t\t\t: indexLabel.dataPoint.indexLabel ? this.replaceKeywordsWithValue(indexLabel.dataPoint.indexLabel, indexLabel.dataPoint, indexLabel.dataSeries, null, indexLabel.indexKeyword)\r\n\t\t\t: indexLabel.dataSeries.indexLabelFormatter ? indexLabel.dataSeries.indexLabelFormatter(formatterParameter)\r\n\t\t\t: indexLabel.dataSeries.indexLabel ? this.replaceKeywordsWithValue(indexLabel.dataSeries.indexLabel, indexLabel.dataPoint, indexLabel.dataSeries, null, indexLabel.indexKeyword) : null;\r\n\r\n\t\tif (indexLabelText === null || indexLabelText === \"\")\r\n\t\t\tcontinue;\r\n\r\n\t\tvar placement = getProperty(\"indexLabelPlacement\", indexLabel.dataPoint, indexLabel.dataSeries);\r\n\t\tvar orientation = getProperty(\"indexLabelOrientation\", indexLabel.dataPoint, indexLabel.dataSeries);\r\n\t\tvar angle = 0;\r\n\r\n\t\tvar direction = indexLabel.direction; // +1 for above the point and -1 for below the point\r\n\r\n\t\tvar axisX = indexLabel.dataSeries.axisX;\r\n\t\tvar axisY = indexLabel.dataSeries.axisY;\r\n\r\n\r\n\t\tvar textBlock = new TextBlock(ctx, {\r\n\t\t\tx: 0,\r\n\t\t\ty: 0,\r\n\t\t\tmaxWidth: maxWidth ? maxWidth : this.width * .5,\r\n\t\t\tmaxHeight: indexLabelWrap ? fontSize * 5 : fontSize * 1.5,\r\n\t\t\tangle: orientation === \"horizontal\" ? 0 : -90,\r\n\t\t\ttext: indexLabelText,\r\n\t\t\tpadding: 0,\r\n\t\t\tbackgroundColor: backgroundColor,\r\n\t\t\thorizontalAlign: \"left\",//left, center, right\r\n\t\t\tfontSize: fontSize,//in pixels\r\n\t\t\tfontFamily: fontFamily,\r\n\t\t\tfontWeight: fontWeight, //normal, bold, bolder, lighter,\r\n\t\t\tfontColor: fontColor,\r\n\t\t\tfontStyle: fontStyle, // normal, italic, oblique\r\n\t\t\ttextBaseline: \"top\"\r\n\t\t});\r\n\r\n\t\tvar textSize = textBlock.measureText();\r\n\r\n\t\t//if (indexLabel.dataPoint.x < axisX.viewportMinimum || indexLabel.dataPoint.x > axisX.viewportMaximum || indexLabel.dataPoint.y < axisY.viewportMinimum || indexLabel.dataPoint.y > axisY.viewportMaximum)\r\n\t\t//\tcontinue;\r\n\r\n\t\tif (chartTypeLower.indexOf(\"line\") >= 0 || chartTypeLower.indexOf(\"area\") >= 0\r\n\t\t\t\t|| chartTypeLower.indexOf(\"bubble\") >= 0 || chartTypeLower.indexOf(\"scatter\") >= 0) {\r\n\r\n\t\t\tif (indexLabel.dataPoint.x < axisX.viewportMinimum || indexLabel.dataPoint.x > axisX.viewportMaximum || indexLabel.dataPoint.y < axisY.viewportMinimum || indexLabel.dataPoint.y > axisY.viewportMaximum)\r\n\t\t\t\tcontinue;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tif (indexLabel.dataPoint.x < axisX.viewportMinimum || indexLabel.dataPoint.x > axisX.viewportMaximum)\r\n\t\t\t\tcontinue;\r\n\t\t}\r\n\r\n\t\tmarginY = 2;\r\n\t\tmarginX = 2;\r\n\r\n\t\tif (orientation === \"horizontal\") {\r\n\t\t\tvisibleWidth = textBlock.width;\r\n\t\t\tvisibleHeight = textBlock.height;\r\n\t\t} else {\r\n\t\t\tvisibleHeight = textBlock.width;\r\n\t\t\tvisibleWidth = textBlock.height;\r\n\t\t}\r\n\r\n\t\tif (this.plotInfo.axisPlacement === \"normal\") {\r\n\r\n\t\t\tif (chartTypeLower.indexOf(\"line\") >= 0 || chartTypeLower.indexOf(\"area\") >= 0) {\r\n\r\n\t\t\t\tplacement = \"auto\";\r\n\t\t\t\tmarginY = 4;\r\n\r\n\t\t\t} else if (chartTypeLower.indexOf(\"stacked\") >= 0) {\r\n\r\n\t\t\t\tif (placement === \"auto\")\r\n\t\t\t\t\tplacement = \"inside\";\r\n\r\n\t\t\t} else if (chartTypeLower === \"bubble\" || chartTypeLower === \"scatter\") {\r\n\r\n\t\t\t\tplacement = \"inside\";\r\n\r\n\t\t\t}\r\n\r\n\t\t\tx = indexLabel.point.x - visibleWidth / 2;\r\n\r\n\t\t\tif (placement !== \"inside\") {\t//outside or auto\r\n\r\n\t\t\t\tyMinLimit = plotArea.y1;\r\n\t\t\t\tyMaxLimit = plotArea.y2;\r\n\r\n\t\t\t\tif (direction > 0) {\r\n\t\t\t\t\ty = indexLabel.point.y - visibleHeight - marginY;\r\n\r\n\t\t\t\t\tif (y < yMinLimit) {\r\n\t\t\t\t\t\tif (placement === \"auto\") {\r\n\t\t\t\t\t\t\ty = Math.max(indexLabel.point.y, yMinLimit) + marginY;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\ty = yMinLimit + marginY;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\ty = indexLabel.point.y + marginY;\r\n\r\n\t\t\t\t\tif (y > yMaxLimit - visibleHeight - marginY) {\r\n\t\t\t\t\t\tif (placement === \"auto\") {\r\n\t\t\t\t\t\t\ty = Math.min(indexLabel.point.y, yMaxLimit) - visibleHeight - marginY;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\ty = yMaxLimit - visibleHeight - marginY;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\r\n\t\t\t\tyMinLimit = Math.max(indexLabel.bounds.y1, plotArea.y1);\r\n\t\t\t\tyMaxLimit = Math.min(indexLabel.bounds.y2, plotArea.y2);\r\n\r\n\r\n\t\t\t\tif (chartTypeLower.indexOf(\"range\") >= 0) {\r\n\t\t\t\t\tif (direction > 0)\r\n\t\t\t\t\t\tmid = Math.max(indexLabel.bounds.y1, plotArea.y1) + visibleHeight / 2 + marginY;\r\n\t\t\t\t\telse\r\n\t\t\t\t\t\tmid = Math.min(indexLabel.bounds.y2, plotArea.y2) - visibleHeight / 2 - marginY;\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t\tmid = (Math.max(indexLabel.bounds.y1, plotArea.y1) + Math.min(indexLabel.bounds.y2, plotArea.y2)) / 2\r\n\r\n\t\t\t\tif (direction > 0) {\r\n\t\t\t\t\ty = Math.max(indexLabel.point.y, mid) - visibleHeight / 2;\r\n\r\n\t\t\t\t\tif (y < yMinLimit && (chartTypeLower === \"bubble\" || chartTypeLower === \"scatter\")) {\r\n\t\t\t\t\t\ty = Math.max(indexLabel.point.y - visibleHeight - marginY, plotArea.y1 + marginY);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\ty = Math.min(indexLabel.point.y, mid) - visibleHeight / 2;\r\n\r\n\t\t\t\t\tif (y > yMaxLimit - visibleHeight - marginY && (chartTypeLower === \"bubble\" || chartTypeLower === \"scatter\")) {\r\n\t\t\t\t\t\ty = Math.min(indexLabel.point.y + marginY, plotArea.y2 - visibleHeight - marginY);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n                  // Make Sure that it does not overlap the axis line\r\n\t\t\t\ty = Math.min(y, yMaxLimit - visibleHeight);\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\r\n\t\t\tif (chartTypeLower.indexOf(\"line\") >= 0 || chartTypeLower.indexOf(\"area\") >= 0\r\n\t\t\t\t|| chartTypeLower.indexOf(\"scatter\") >= 0) {\r\n\r\n\t\t\t\tplacement = \"auto\";\r\n\t\t\t\tmarginX = 4;\r\n\r\n\t\t\t} else if (chartTypeLower.indexOf(\"stacked\") >= 0) {\r\n\r\n\t\t\t\tif (placement === \"auto\")\r\n\t\t\t\t\tplacement = \"inside\";\r\n\r\n\t\t\t} else if (chartTypeLower === \"bubble\") {\r\n\r\n\t\t\t\tplacement = \"inside\";\r\n\r\n\t\t\t}\r\n\r\n\t\t\ty = indexLabel.point.y - visibleHeight / 2;\r\n\r\n\t\t\tif (placement !== \"inside\") {\t//outside or auto\r\n\r\n\t\t\t\txMinLimit = plotArea.x1;\r\n\t\t\t\txMaxLimit = plotArea.x2;\r\n\r\n\t\t\t\tif (direction < 0) {\r\n\t\t\t\t\tx = indexLabel.point.x - visibleWidth - marginX;\r\n\r\n\t\t\t\t\tif (x < xMinLimit) {\r\n\t\t\t\t\t\tif (placement === \"auto\") {\r\n\t\t\t\t\t\t\tx = Math.max(indexLabel.point.x, xMinLimit) + marginX;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\tx = xMinLimit + marginX;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tx = indexLabel.point.x + marginX;\r\n\r\n\t\t\t\t\tif (x > xMaxLimit - visibleWidth - marginX) {\r\n\t\t\t\t\t\tif (placement === \"auto\") {\r\n\t\t\t\t\t\t\tx = Math.min(indexLabel.point.x, xMaxLimit) - visibleWidth - marginX;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\tx = xMaxLimit - visibleWidth - marginX;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\txMinLimit = Math.max(indexLabel.bounds.x1, plotArea.x1);\r\n\t\t\t\txMaxLimit = Math.min(indexLabel.bounds.x2, plotArea.x2);\r\n\r\n\t\t\t\tif (chartTypeLower.indexOf(\"range\") >= 0) {\r\n\t\t\t\t\tif (direction < 0)\r\n\t\t\t\t\t\tmid = Math.max(indexLabel.bounds.x1, plotArea.x1) + visibleWidth / 2 + marginX;\r\n\t\t\t\t\telse\r\n\t\t\t\t\t\tmid = Math.min(indexLabel.bounds.x2, plotArea.x2) - visibleWidth / 2 - marginX;\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t\tvar mid = (Math.max(indexLabel.bounds.x1, plotArea.x1) + Math.min(indexLabel.bounds.x2, plotArea.x2)) / 2;\r\n\r\n\t\t\t\tif (direction < 0) {\r\n\t\t\t\t\tx = Math.max(indexLabel.point.x, mid) - visibleWidth / 2;\r\n\r\n\t\t\t\t\t//if (y < xMinLimit) {\r\n\t\t\t\t\t//\ty = Math.max(indexLabel.point.y - visibleHeight - marginY, plotArea.y1 + marginY);\r\n\t\t\t\t\t//}\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tx = Math.min(indexLabel.point.x, mid) - visibleWidth / 2;\r\n\r\n\t\t\t\t\t//if (y > xMaxLimit - visibleHeight - marginY) {\r\n\t\t\t\t\t//\ty = Math.min(indexLabel.point.y + marginY, plotArea.y2 - visibleHeight - marginY);\r\n\t\t\t\t\t//}\r\n\t\t\t\t}\r\n\r\n\t\t\t    // Make Sure that it does not overlap the axis line\r\n\t\t\t    x = Math.max(x, xMinLimit);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\r\n\t\tif (orientation === \"vertical\") {\r\n\t\t\ty += visibleHeight;\r\n\t\t}\r\n\r\n\t\ttextBlock.x = x;\r\n\t\ttextBlock.y = y;\r\n\r\n\t\t//console.log(textBlock.text + \": \" + textBlock.x + \"; \" + textBlock.y);\r\n\r\n\t\ttextBlock.render(true);\r\n\t}\r\n\r\n\t//source and dest would be same when animation is not enabled\r\n\tvar animationInfo = {\r\n\t\tsource: ctx, dest: this.plotArea.ctx, animationCallback: AnimationHelper.fadeInAnimation, easingFunction: AnimationHelper.easing.easeInQuad, animationBase: 0, startTimePercent: .7\r\n\t};\r\n\treturn animationInfo;\r\n}\r\n\r\nChart.prototype.renderLine = function (plotUnit) {\r\n\r\n\tvar ctx = plotUnit.targetCanvasCtx || this.plotArea.ctx;\r\n\r\n\tvar totalDataSeries = plotUnit.dataSeriesIndexes.length;\r\n\tif (totalDataSeries <= 0)\r\n\t\treturn;\r\n\r\n\tvar ghostCtx = this._eventManager.ghostCtx;\r\n\t//var ghostCtx = this.overlaidCanvasCtx;\r\n\r\n\tctx.save();\r\n\r\n\tvar plotArea = this.plotArea;\r\n\r\n\tctx.beginPath();\r\n\tctx.rect(plotArea.x1, plotArea.y1, plotArea.width, plotArea.height);\r\n\tctx.clip();\r\n\r\n\tvar markers = [];\r\n\r\n\tfor (var j = 0; j < plotUnit.dataSeriesIndexes.length; j++) {\r\n\r\n\t\tvar dataSeriesIndex = plotUnit.dataSeriesIndexes[j];\r\n\r\n\t\tvar dataSeries = this.data[dataSeriesIndex];\r\n\t\tctx.lineWidth = dataSeries.lineThickness;\r\n\t\tvar dataPoints = dataSeries.dataPoints;\r\n\r\n\r\n\t\tif (ctx.setLineDash) {\r\n\t\t\tctx.setLineDash(getLineDashArray(dataSeries.lineDashType, dataSeries.lineThickness));\r\n\t\t}\r\n\r\n\t\tvar seriesId = dataSeries.id;\r\n\t\tthis._eventManager.objectMap[seriesId] = {\r\n\t\t\tobjectType: \"dataSeries\", dataSeriesIndex: dataSeriesIndex\r\n\t\t};\r\n\t\tvar hexColor = intToHexColorString(seriesId);\r\n\t\tghostCtx.strokeStyle = hexColor;\r\n\t\t//ghostCtx.lineWidth = dataSeries.lineThickness;\r\n\t\tghostCtx.lineWidth = dataSeries.lineThickness > 0 ? Math.max(dataSeries.lineThickness, 4) : 0;\r\n\r\n\t\tvar colorSet = dataSeries._colorSet;\r\n\t\tvar color = colorSet[0];\r\n\t\tctx.strokeStyle = color;\r\n\r\n\t\tvar isFirstDataPointInPlotArea = true;\r\n\t\tvar i = 0, x, y;\r\n\t\tvar dataPointX; //Used so that when dataPoint.x is a DateTime value, it doesn't get converted to number back and forth.\r\n\r\n\t\t//if (!dataSeries._options.markerSize && dataSeries.dataPoints.length < 1000)\r\n\t\t//    dataSeries.markerSize = 8;\r\n\t\tctx.beginPath();\r\n\t\tif (dataPoints.length > 0) {\r\n\t\t\t//var xy = this.getPixelCoordinatesOnPlotArea(dataPoints[0].x, dataPoints[0].y);\r\n\r\n\t\t\t//dataSeries.noDataPointsInPlotArea = 0\r\n\t\t\tvar prevDataNull = false;\r\n\t\t\tfor (i = 0; i < dataPoints.length; i++) {\r\n\r\n\t\t\t\tdataPointX = dataPoints[i].x.getTime ? dataPoints[i].x.getTime() : dataPoints[i].x;\r\n\r\n\t\t\t\tif (dataPointX < plotUnit.axisX.dataInfo.viewPortMin || dataPointX > plotUnit.axisX.dataInfo.viewPortMax)\r\n\t\t\t\t\tcontinue;\r\n\r\n\t\t\t\t//if (!isFinite(dataPoints[i].y))\r\n\t\t\t\t//    continue;\r\n\r\n\t\t\t\tif (typeof (dataPoints[i].y) !== \"number\") {\r\n\t\t\t\t\tif (i > 0) {// if first dataPoint is null then no need to call stroke method\r\n\t\t\t\t\t\tctx.stroke();\r\n\r\n\t\t\t\t\t\tif (isCanvasSupported) {\r\n\t\t\t\t\t\t\tghostCtx.stroke();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\r\n\t\t\t\t\tprevDataNull = true;\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tx = (plotUnit.axisX.conversionParameters.reference + plotUnit.axisX.conversionParameters.pixelPerUnit * (dataPointX - plotUnit.axisX.conversionParameters.minimum) + .5) << 0;\r\n\t\t\t\ty = (plotUnit.axisY.conversionParameters.reference + plotUnit.axisY.conversionParameters.pixelPerUnit * (dataPoints[i].y - plotUnit.axisY.conversionParameters.minimum) + .5) << 0;\r\n\r\n\t\t\t\tvar id = dataSeries.dataPointIds[i];\r\n\t\t\t\tthis._eventManager.objectMap[id] = {\r\n\t\t\t\t\tid: id, objectType: \"dataPoint\", dataSeriesIndex: dataSeriesIndex, dataPointIndex: i, x1: x, y1: y\r\n\t\t\t\t};\r\n\r\n\r\n\t\t\t\t//dataSeries.noDataPointsInPlotArea++;\r\n\r\n\t\t\t\tif (isFirstDataPointInPlotArea || prevDataNull) {\r\n\t\t\t\t\tctx.beginPath();\r\n\t\t\t\t\tctx.moveTo(x, y);\r\n\r\n\r\n\t\t\t\t\tif (isCanvasSupported) {\r\n\t\t\t\t\t\tghostCtx.beginPath();\r\n\t\t\t\t\t\tghostCtx.moveTo(x, y);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tisFirstDataPointInPlotArea = false;\r\n\t\t\t\t\tprevDataNull = false;\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tctx.lineTo(x, y);\r\n\r\n\t\t\t\t\tif (isCanvasSupported)\r\n\t\t\t\t\t\tghostCtx.lineTo(x, y);\r\n\r\n\t\t\t\t\tif (i % 500 == 0) {\r\n\t\t\t\t\t\tctx.stroke();\r\n\t\t\t\t\t\tctx.beginPath();\r\n\t\t\t\t\t\tctx.moveTo(x, y);\r\n\r\n\t\t\t\t\t\tif (isCanvasSupported) {\r\n\t\t\t\t\t\t\tghostCtx.stroke();\r\n\t\t\t\t\t\t\tghostCtx.beginPath();\r\n\t\t\t\t\t\t\tghostCtx.moveTo(x, y);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t//Render Marker\r\n\t\t\t\tif (dataPoints[i].markerSize > 0 || dataSeries.markerSize > 0) {\r\n\r\n\t\t\t\t\tvar markerProps = dataSeries.getMarkerProperties(i, x, y, ctx);\r\n\t\t\t\t\tmarkers.push(markerProps);\r\n\r\n\t\t\t\t\t//if (!dataSeries.maxWidthInX || markerProps.size > dataSeries.maxWidthInX) {\r\n\t\t\t\t\t//\tdataSeries.maxWidthInX = markerProps.size / (plotUnit.axisX.conversionParameters.pixelPerUnit > 1 ? plotUnit.axisX.conversionParameters.pixelPerUnit - 1 : plotUnit.axisX.conversionParameters.pixelPerUnit);\r\n\t\t\t\t\t//}\r\n\r\n\t\t\t\t\tvar markerColor = intToHexColorString(id);\r\n\r\n\t\t\t\t\t//window.console.log(\"index: \" + i + \"; id: \" + id + \"; hex: \" + markerColor);\r\n\r\n\t\t\t\t\tif (isCanvasSupported) {\r\n\t\t\t\t\t\tmarkers.push({\r\n\t\t\t\t\t\t\tx: x, y: y, ctx: ghostCtx,\r\n\t\t\t\t\t\t\ttype: markerProps.type,\r\n\t\t\t\t\t\t\tsize: markerProps.size,\r\n\t\t\t\t\t\t\tcolor: markerColor,\r\n\t\t\t\t\t\t\tborderColor: markerColor,\r\n\t\t\t\t\t\t\tborderThickness: markerProps.borderThickness\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (dataPoints[i].indexLabel || dataSeries.indexLabel || dataPoints[i].indexLabelFormatter || dataSeries.indexLabelFormatter) {\r\n\r\n\t\t\t\t\tthis._indexLabels.push({\r\n\t\t\t\t\t\tchartType: \"line\",\r\n\t\t\t\t\t\tdataPoint: dataPoints[i],\r\n\t\t\t\t\t\tdataSeries: dataSeries,\r\n\t\t\t\t\t\tpoint: {\r\n\t\t\t\t\t\t\tx: x, y: y\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tdirection: dataPoints[i].y >= 0 ? 1 : -1,\r\n\t\t\t\t\t\tcolor: color\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tctx.stroke();\r\n\r\n\t\t\tif (isCanvasSupported)\r\n\t\t\t\tghostCtx.stroke();\r\n\t\t}\r\n\r\n\t}\r\n\r\n\r\n\tRenderHelper.drawMarkers(markers);\r\n\tctx.restore();\r\n\r\n\tctx.beginPath();\r\n\r\n\tif (isCanvasSupported)\r\n\t\tghostCtx.beginPath();\r\n\r\n\t//source and dest would be same when animation is not enabled\r\n\tvar animationInfo = {\r\n\t\tsource: ctx, dest: this.plotArea.ctx, animationCallback: AnimationHelper.xClipAnimation, easingFunction: AnimationHelper.easing.linear, animationBase: 0\r\n\t};\r\n\treturn animationInfo;\r\n}\r\n\r\nChart.prototype.renderStepLine = function (plotUnit) {\r\n\tvar ctx = plotUnit.targetCanvasCtx || this.plotArea.ctx;\r\n\r\n\tvar totalDataSeries = plotUnit.dataSeriesIndexes.length;\r\n\tif (totalDataSeries <= 0)\r\n\t\treturn;\r\n\r\n\tvar ghostCtx = this._eventManager.ghostCtx;\r\n\t//var ghostCtx = this.overlaidCanvasCtx;\r\n\r\n\tctx.save();\r\n\r\n\tvar plotArea = this.plotArea;\r\n\r\n\tctx.beginPath();\r\n\tctx.rect(plotArea.x1, plotArea.y1, plotArea.width, plotArea.height);\r\n\tctx.clip();\r\n\r\n\tvar markers = [];\r\n\r\n\tfor (var j = 0; j < plotUnit.dataSeriesIndexes.length; j++) {\r\n\r\n\t\tvar dataSeriesIndex = plotUnit.dataSeriesIndexes[j];\r\n\r\n\t\tvar dataSeries = this.data[dataSeriesIndex];\r\n\t\tctx.lineWidth = dataSeries.lineThickness;\r\n\t\tvar dataPoints = dataSeries.dataPoints;\r\n\r\n\t\tif (ctx.setLineDash) {\r\n\t\t\tctx.setLineDash(getLineDashArray(dataSeries.lineDashType, dataSeries.lineThickness));\r\n\t\t}\r\n\r\n\t\tvar seriesId = dataSeries.id;\r\n\t\tthis._eventManager.objectMap[seriesId] = {\r\n\t\t\tobjectType: \"dataSeries\", dataSeriesIndex: dataSeriesIndex\r\n\t\t};\r\n\t\tvar hexColor = intToHexColorString(seriesId);\r\n\t\tghostCtx.strokeStyle = hexColor;\r\n\t\t//ghostCtx.lineWidth = dataSeries.lineThickness;\r\n\t\tghostCtx.lineWidth = dataSeries.lineThickness > 0 ? Math.max(dataSeries.lineThickness, 4) : 0;\r\n\r\n\t\tvar colorSet = dataSeries._colorSet;\r\n\t\tvar color = colorSet[0];\r\n\t\tctx.strokeStyle = color;\r\n\r\n\t\tvar isFirstDataPointInPlotArea = true;\r\n\t\tvar i = 0, x, y;\r\n\t\tvar dataPointX; //Used so that when dataPoint.x is a DateTime value, it doesn't get converted to number back and forth.\r\n\r\n\t\t//if (!dataSeries._options.markerSize && dataSeries.dataPoints.length < 1000)\r\n\t\t//    dataSeries.markerSize = 8;\r\n\t\tctx.beginPath();\r\n\t\tif (dataPoints.length > 0) {\r\n\t\t\t//var xy = this.getPixelCoordinatesOnPlotArea(dataPoints[0].x, dataPoints[0].y);\r\n\r\n\t\t\t//dataSeries.noDataPointsInPlotArea = 0\r\n\t\t\tvar prevDataNull = false;\r\n\t\t\tfor (i = 0; i < dataPoints.length; i++) {\r\n\r\n\t\t\t\tdataPointX = dataPoints[i].getTime ? dataPoints[i].x.getTime() : dataPoints[i].x;\r\n\r\n\t\t\t\tif (dataPointX < plotUnit.axisX.dataInfo.viewPortMin || dataPointX > plotUnit.axisX.dataInfo.viewPortMax)\r\n\t\t\t\t\tcontinue;\r\n\r\n\t\t\t\t//if (!isFinite(dataPoints[i].y))\r\n\t\t\t\t//    continue;\r\n\r\n\t\t\t\tif (typeof (dataPoints[i].y) !== \"number\") {\r\n\t\t\t\t\tif (i > 0) {// if first dataPoint is null then no need to call stroke method\r\n\t\t\t\t\t\tctx.stroke();\r\n\r\n\t\t\t\t\t\tif (isCanvasSupported) {\r\n\t\t\t\t\t\t\tghostCtx.stroke();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tprevDataNull = true;\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar prevY = y;\r\n\r\n\t\t\t\tx = (plotUnit.axisX.conversionParameters.reference + plotUnit.axisX.conversionParameters.pixelPerUnit * (dataPointX - plotUnit.axisX.conversionParameters.minimum) + .5) << 0;\r\n\t\t\t\ty = (plotUnit.axisY.conversionParameters.reference + plotUnit.axisY.conversionParameters.pixelPerUnit * (dataPoints[i].y - plotUnit.axisY.conversionParameters.minimum) + .5) << 0;\r\n\r\n\t\t\t\tvar id = dataSeries.dataPointIds[i];\r\n\t\t\t\tthis._eventManager.objectMap[id] = {\r\n\t\t\t\t\tid: id, objectType: \"dataPoint\", dataSeriesIndex: dataSeriesIndex, dataPointIndex: i, x1: x, y1: y\r\n\t\t\t\t};\r\n\r\n\r\n\t\t\t\t//dataSeries.noDataPointsInPlotArea++;\r\n\r\n\t\t\t\tif (isFirstDataPointInPlotArea || prevDataNull) {\r\n\t\t\t\t\tctx.beginPath();\r\n\t\t\t\t\tctx.moveTo(x, y);\r\n\r\n\t\t\t\t\tif (isCanvasSupported) {\r\n\t\t\t\t\t\tghostCtx.beginPath();\r\n\t\t\t\t\t\tghostCtx.moveTo(x, y);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tisFirstDataPointInPlotArea = false;\r\n\t\t\t\t\tprevDataNull = false;\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tctx.lineTo(x, prevY);\r\n\t\t\t\t\tif (isCanvasSupported)\r\n\t\t\t\t\t\tghostCtx.lineTo(x, prevY);\r\n\r\n\t\t\t\t\tctx.lineTo(x, y);\r\n\t\t\t\t\tif (isCanvasSupported)\r\n\t\t\t\t\t\tghostCtx.lineTo(x, y);\r\n\r\n\t\t\t\t\tif (i % 500 == 0) {\r\n\t\t\t\t\t\tctx.stroke();\r\n\t\t\t\t\t\tctx.beginPath();\r\n\t\t\t\t\t\tctx.moveTo(x, y);\r\n\r\n\t\t\t\t\t\tif (isCanvasSupported) {\r\n\t\t\t\t\t\t\tghostCtx.stroke();\r\n\t\t\t\t\t\t\tghostCtx.beginPath();\r\n\t\t\t\t\t\t\tghostCtx.moveTo(x, y);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t//Render Marker\r\n\t\t\t\tif (dataPoints[i].markerSize > 0 || dataSeries.markerSize > 0) {\r\n\r\n\t\t\t\t\tvar markerProps = dataSeries.getMarkerProperties(i, x, y, ctx);\r\n\t\t\t\t\tmarkers.push(markerProps);\r\n\r\n\t\t\t\t\t//if (!dataSeries.maxWidthInX || markerProps.size > dataSeries.maxWidthInX) {\r\n\t\t\t\t\t//\tdataSeries.maxWidthInX = markerProps.size / (plotUnit.axisX.conversionParameters.pixelPerUnit > 1 ? plotUnit.axisX.conversionParameters.pixelPerUnit - 1 : plotUnit.axisX.conversionParameters.pixelPerUnit);\r\n\t\t\t\t\t//}\r\n\r\n\t\t\t\t\tvar markerColor = intToHexColorString(id);\r\n\r\n\t\t\t\t\t//window.console.log(\"index: \" + i + \"; id: \" + id + \"; hex: \" + markerColor);\r\n\t\t\t\t\tif (isCanvasSupported) {\r\n\t\t\t\t\t\tmarkers.push({\r\n\t\t\t\t\t\t\tx: x, y: y, ctx: ghostCtx,\r\n\t\t\t\t\t\t\ttype: markerProps.type,\r\n\t\t\t\t\t\t\tsize: markerProps.size,\r\n\t\t\t\t\t\t\tcolor: markerColor,\r\n\t\t\t\t\t\t\tborderColor: markerColor,\r\n\t\t\t\t\t\t\tborderThickness: markerProps.borderThickness\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (dataPoints[i].indexLabel || dataSeries.indexLabel || dataPoints[i].indexLabelFormatter || dataSeries.indexLabelFormatter) {\r\n\r\n\t\t\t\t\tthis._indexLabels.push({\r\n\t\t\t\t\t\tchartType: \"stepLine\",\r\n\t\t\t\t\t\tdataPoint: dataPoints[i],\r\n\t\t\t\t\t\tdataSeries: dataSeries,\r\n\t\t\t\t\t\tpoint: {\r\n\t\t\t\t\t\t\tx: x, y: y\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tdirection: dataPoints[i].y >= 0 ? 1 : -1,\r\n\t\t\t\t\t\tcolor: color\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tctx.stroke();\r\n\t\t\tif (isCanvasSupported)\r\n\t\t\t\tghostCtx.stroke();\r\n\t\t}\r\n\t}\r\n\r\n\r\n\tRenderHelper.drawMarkers(markers);\r\n\tctx.restore();\r\n\r\n\tctx.beginPath();\r\n\r\n\tif (isCanvasSupported)\r\n\t\tghostCtx.beginPath();\r\n\r\n\t//source and dest would be same when animation is not enabled\r\n\tvar animationInfo = {\r\n\t\tsource: ctx, dest: this.plotArea.ctx, animationCallback: AnimationHelper.xClipAnimation, easingFunction: AnimationHelper.easing.linear, animationBase: 0\r\n\t};\r\n\treturn animationInfo;\r\n}\r\n\r\nChart.prototype.animationRequestId = null;\r\n\r\nChart.prototype.requestAnimFrame = (function () {\r\n\treturn window.requestAnimationFrame ||\r\n\t\t\twindow.webkitRequestAnimationFrame ||\r\n\t\t\twindow.mozRequestAnimationFrame ||\r\n\t\t\twindow.oRequestAnimationFrame ||\r\n\t\t\twindow.msRequestAnimationFrame ||\r\n\t\t\tfunction (callback) {\r\n\t\t\t\twindow.setTimeout(callback, 1000 / 60);\r\n\t\t\t};\r\n})();\r\n\r\nChart.prototype.cancelRequestAnimFrame = (function () {\r\n\treturn window.cancelAnimationFrame ||\r\n\t\twindow.webkitCancelRequestAnimationFrame ||\r\n\t\twindow.mozCancelRequestAnimationFrame ||\r\n\t\twindow.oCancelRequestAnimationFrame ||\r\n\t\twindow.msCancelRequestAnimationFrame ||\r\n\t\tclearTimeout\r\n})();\r\n\r\nChart.prototype.getPercentAndTotal = function (ds, dp) {\r\n\r\n\tvar dpX = null;\r\n\tvar total = null;\r\n\tvar percent = null;\r\n\r\n\tif (ds.type.indexOf(\"stacked\") >= 0) {\r\n\t\ttotal = 0;\r\n\t\tdpX = dp.x.getTime ? dp.x.getTime() : dp.x;\r\n\t\tif (dpX in ds.plotUnit.yTotals) {\r\n\t\t\ttotal = ds.plotUnit.yTotals[dpX];\r\n\r\n\t\t\tif (!isNaN(dp.y)) {\r\n\t\t\t    if (total === 0)\r\n\t\t\t        percent = 0;\r\n                  else\r\n\t\t\t        percent = (dp.y / total) * 100;\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t    percent = 0;\r\n\t\t}\r\n\t} else if (ds.type === \"pie\" || ds.type === \"doughnut\") {\r\n\t\ttotal = 0;\r\n\t\tfor (var i = 0; i < ds.dataPoints.length; i++) {\r\n\r\n\t\t\tif (!isNaN(ds.dataPoints[i].y))\r\n\t\t\t\ttotal += ds.dataPoints[i].y;\r\n\t\t}\r\n\r\n\t\tif (!isNaN(dp.y))\r\n\t\t\tpercent = (dp.y / total) * 100;\r\n\t\telse\r\n\t\t\tpercent = 0;\r\n\t}\r\n\r\n\treturn {\r\n\t\tpercent: percent, total: total\r\n\t};\r\n}\r\n\r\nChart.prototype.replaceKeywordsWithValue = function (str, dp, ds, dpIndex, indexKeywordValue) {\r\n\t//var regex = /\\{\\s*[a-zA-Z]+\\s*\\}|\"[^\"]*\"|'[^']*'/g;\r\n\tvar regex = /\\{.*?\\}|\"[^\"]*\"|'[^']*'/g;\r\n\tvar chart = this;\r\n\tindexKeywordValue = typeof (indexKeywordValue) === \"undefined\" ? 0 : indexKeywordValue;\r\n\r\n\tif ((ds.type.indexOf(\"stacked\") >= 0 || (ds.type === \"pie\" || ds.type === \"doughnut\")) && (str.indexOf(\"#percent\") >= 0 || str.indexOf(\"#total\") >= 0)) {\r\n\t\tvar percent = \"#percent\";\r\n\t\tvar total = \"#total\";\r\n\t\tvar dpX = null;\r\n\r\n\t\tvar percentAndTotal = this.getPercentAndTotal(ds, dp);\r\n\r\n\t\ttotal = isNaN(percentAndTotal.total) ? total : percentAndTotal.total;\r\n\t\tpercent = isNaN(percentAndTotal.percent) ? percent : percentAndTotal.percent;\r\n\r\n\t\tdo {\r\n\t\t\tvar percentFormatString = \"\";\r\n\t\t\tif (ds.percentFormatString)\r\n\t\t\t\tpercentFormatString = ds.percentFormatString;\r\n\t\t\telse {\r\n\t\t\t\tpercentFormatString = \"#,##0.\";\r\n\t\t\t\tvar numberOfDecimals = Math.max(Math.ceil(Math.log(1 / Math.abs(percent)) / Math.LN10), 2);\r\n\r\n\t\t\t\tif (isNaN(numberOfDecimals) || !isFinite(numberOfDecimals))\r\n\t\t\t\t\tnumberOfDecimals = 2;\r\n\r\n\t\t\t\tfor (var n = 0; n < numberOfDecimals; n++) {\r\n\t\t\t\t\tpercentFormatString += \"#\";\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tstr = str.replace(\"#percent\", numberFormat(percent, percentFormatString, chart._cultureInfo));\r\n\t\t\tstr = str.replace(\"#total\", numberFormat(total, ds.yValueFormatString ? ds.yValueFormatString : \"#,##0.########\"));\r\n\t\t} while (str.indexOf(\"#percent\") >= 0 || str.indexOf(\"#total\") >= 0);\r\n\t}\r\n\r\n\r\n\tvar fcn = function ($0) {\r\n\t\tif (($0[0] === \"\\\"\" && $0[$0.length - 1] === \"\\\"\") || ($0[0] === \"\\'\" && $0[$0.length - 1] === \"\\'\"))\r\n\t\t\treturn $0.slice(1, $0.length - 1);\r\n\r\n\t\tvar key = trimString($0.slice(1, $0.length - 1));\r\n\t\tkey = key.replace(\"#index\", indexKeywordValue);\r\n\r\n\t\tvar index = null;\r\n\r\n\t\ttry {\r\n\t\t\tvar match = key.match(/(.*?)\\s*\\[\\s*(.*?)\\s*\\]/);\r\n\t\t\tif (match && match.length > 0) {\r\n\t\t\t\tindex = trimString(match[2]);\r\n\t\t\t\tkey = trimString(match[1]);\r\n\t\t\t}\r\n\t\t} catch (e) {\r\n\t\t};\r\n\r\n\r\n\t\tvar obj = null;\r\n\r\n\t\tif (key === \"color\") {\r\n\t\t\treturn dp.color ? dp.color : ds.color ? ds.color : ds._colorSet[dpIndex % ds._colorSet.length];\r\n\t\t}\r\n\r\n\t\tif (dp.hasOwnProperty(key))\r\n\t\t\tobj = dp;\r\n\t\telse if (ds.hasOwnProperty(key))\r\n\t\t\tobj = ds;\r\n\t\telse return \"\";\r\n\r\n\t\tvar value = obj[key];\r\n\t\tif (index !== null)\r\n\t\t\tvalue = value[index];\r\n\r\n\t\tif (key === \"x\") {\r\n\t\t\tif (chart.axisX && chart.plotInfo.axisXValueType === \"dateTime\")\r\n\t\t\t\treturn dateFormat(value, dp.xValueFormatString ? dp.xValueFormatString : ds.xValueFormatString ? ds.xValueFormatString : chart.axisX && chart.axisX.valueFormatString ? chart.axisX.valueFormatString : \"DD MMM YY\", chart._cultureInfo);\r\n\t\t\telse\r\n\t\t\t\treturn numberFormat(value, dp.xValueFormatString ? dp.xValueFormatString : ds.xValueFormatString ? ds.xValueFormatString : \"#,##0.########\", chart._cultureInfo);\r\n\t\t} else if (key === \"y\")\r\n\t\t\treturn numberFormat(value, dp.yValueFormatString ? dp.yValueFormatString : ds.yValueFormatString ? ds.yValueFormatString : \"#,##0.########\", chart._cultureInfo);\r\n\t\telse if (key === \"z\")\r\n\t\t\treturn numberFormat(value, dp.zValueFormatString ? dp.zValueFormatString : ds.zValueFormatString ? ds.zValueFormatString : \"#,##0.########\", chart._cultureInfo);\r\n\t\telse\r\n\t\t\treturn value;\r\n\t}\r\n\r\n\treturn str.replace(regex, fcn);\r\n}\r\n\r\n\r\nChart.prototype.renderSpline = SplineChart;\r\n\r\nChart.prototype.renderColumn = ColumnChart\r\n\r\nChart.prototype.renderStackedColumn = StackedColumnChart;\r\n\r\nChart.prototype.renderStackedColumn100 = StackedColumn100Chart;\r\n\r\nChart.prototype.renderBar = BarChart;\r\n\r\nChart.prototype.renderStackedBar = StackedBarChart;\r\n\r\nChart.prototype.renderStackedBar100 = StackedBar100Chart;\r\n\r\nChart.prototype.renderArea = AreaChart;\r\n\r\nChart.prototype.renderSplineArea = SplineAreaChart;\r\n\r\nChart.prototype.renderStepArea = StepAreaChart;\r\n\r\nChart.prototype.renderStackedArea = StackedAreaChart;\r\n\r\nChart.prototype.renderStackedArea100 = StackedArea100Chart;\r\n\r\nChart.prototype.renderBubble = BubbleChart;\r\n\r\nChart.prototype.renderScatter = ScatterChart;\r\n\r\nChart.prototype.renderCandlestick = CandlestickChart;\r\n\r\nChart.prototype.renderRangeColumn = RangeColumnChart;\r\n\r\nChart.prototype.renderRangeBar = RangeBarChart;\r\n\r\nChart.prototype.renderRangeArea = RangeAreaChart;\r\n\r\nChart.prototype.renderRangeSplineArea = RangeSplineAreaChart;\r\n\r\nChart.prototype.renderPie = PieChart;\r\n\r\nexport default Chart;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}